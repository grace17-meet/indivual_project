try { window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.adsbar.js'] = (new Date()).getTime();
Type.registerNamespace("_ab");function AdsbarComponent(){}AdsbarComponent.$$cctor=function(){_a.t.a().a(AdsbarComponent)};AdsbarComponent.prototype={b:function(n,t,i){var r=this;n.b(_ab.c,function(){return new _ab.c(n.a(_g.a),n.a(_j.ba),n.a(_a.cE),n.a(_j.j),n.a(_g.L),n.a(IInferenceTracker),n.a(_a.y).c(),n.a(_y.k),n.a(_db.C),n.a(_a.q),n.a(_a.y),n.a(_j.o))}).b(IAdsbarViewModel).a()},a:function(){return null}};_ab.d=function(){_ab.d.initializeBase(this)};_ab.d.prototype={K:function(n){var t=new _dg.cE(this.L);n.ez(t,this.H,this.G)},cT:function(n,t,i){t()}};_ab.c=function(n,t,i,r,u,f,e,o,s,h,c,l){this.C=Function.createDelegate(this,this.bg);this.A=Function.createDelegate(this,this.be);this.B=Function.createDelegate(this,this.bf);this.E=Function.createDelegate(this,this.bh);_ab.c.initializeBase(this);this.b=i;this.c=f;this.d=n;this.a=this.T();this.w=this.U();this.O=this.a.split("-")[0];this.N=this.a.split("-")[1];this.M=u;this.f=o;this.y=e;this.F=String.format(_nbs.a.HP,String.format("http://windows.microsoft.com/{0}/outlook/ad-free-outlook",this.a));this.c.bv(this.a);this.n=h;this.G=c;this.e=r;this.z=l;this.h=[];this.L=t;if(this.y.b("overrideadssdkbaseurl")){this.j=e.a.overrideadssdkbaseurl;this.o=this.j+"adbar.js"}else{this.o=i.a().d().OwaAdBarScript?i.a().d().OwaAdBarScript:"https://r1.res.office365.com/adbar/v2.0/adbar.js";this.j=i.a().d().OwaAdBarBaseUrl?i.a().d().OwaAdBarBaseUrl:"https://r1.res.office365.com/adbar/v2.0/"}this.q=this.y.b("overrideastsdkurl")?e.a.overrideastsdkurl:i.a().d().AstScriptUrl?i.a().d().AstScriptUrl:"https://acdn.adnxs.com/ast/ast.js";this.v=this.b.a().hz().Enabled;this.v&&(this.H=this.S());var a=this;s.d(function(n){a.g=n;a.m=a.bd()&&!a.Z(n)&&a.ba()&&!a.X()&&a.bc()&&!a.Y();a.s=a.m&&!a.bb();if(a.s){a.e.b(_a.bd,a.E);a.e.b(_a.cv,a.B);a.e.b(_a.df,a.A);a.e.b(_y.X,a.C);a.i(!0)}else a.i(!1);a.bj();a.R()})};_ab.c.prototype={z:null,d:null,e:null,b:null,c:null,M:null,n:null,G:null,f:null,a:null,w:null,O:null,N:null,y:null,v:!1,H:null,o:null,j:null,q:null,s:!1,m:!1,x:!1,u:!1,L:null,k:null,l:null,p:null,g:null,I:!1,K:!1,h:null,i:function(n){n&&(!this.s||this.h.length)||this.f.j===n||this.f.bi(n)},Q:function(n){if(this.x!==n){this.x=n;this.ez("ShowAdBlockMessage")}return n},F:null,P:function(n,t,i,r){if(n<=990){var f=String.format("NotLoadedByNotInitMinWidth&w={0}&h={1}",n,t);this.t(f);return}if(this.f&&this.f.a()&&this.f.a().a){this.t("NotLoadedByNotInitializeInMailModule");return}if(this.I){this.e.a(_a.bd,new _a.bd("Mail"));return}this.Q(!0);var u=this;this.L.a(this.o,function(){u.Q(!1);if(window.wLive&&window.wLive.adbar){var e=u.V(i,r);window.wLive.adbar.init(e);window.wLive.adbar.show();u.e.a(_a.bd,new _a.bd("Mail"));var f=n.toString()+"x"+t.toString();u.c.bw(f,u.a);u.I=!0}else u.c.c("NotLoadedBySdkFail",u.a)})},V:function(n,t){var i={};i.BaseUrl=this.j;i.Height=t;i.Width=n;i.Market=this.a;i.ContainerID="owaadbar";i.Environment="Prod";i.AstUrl=this.q;i.CallbackEventName="AdCallbackOwa";var f=this;i.Visibility=function(){return f.f.j&&f.u};var u={};var h=this;u.adErrorEventHandler=function(){};var s=this;u.hide=function(){};i.PublisherObject=u;var r={};var e=this;r.addEventListener=function(n,t){n==="contextChange"&&(e.p=t)};var o=this;r.removeEventListener=function(){};i.EventManager=r;return i},t:function(n){this.c.c(n,this.a);this.i(!1)},eC:function(){this.e.c(_a.bd,this.E);this.e.c(_a.cv,this.B);this.e.c(_a.df,this.A);this.e.c(_y.X,this.C);_a.fM.prototype.eC.call(this)},bf:function(n){this.bi(n);this.f.j&&!n.b&&this.c.c(n.a,this.a);this.i(n.b)},be:function(n){n.a&&this.c.bu();this.u=n.a},bh:function(n){if(this.f.j&&!this.u&&this.p){var t=this;_j.m.a().d(_a.a.A,"AdsRefresh",function(){t.c.bt(t.a,n.a);var i=t.v&&n.a==="MCompose"?t.H:null;t.p(n.a,null,i)})}},bd:function(){return this.b.a().d().Enabled},bc:function(){if(this.b.a().d()&&this.b.a().d().SupportedMarkets){var t=this.b.a().d().SupportedMarkets;var i=this.a.toUpperCase();var n=Array.contains(t,i);n||this.c.c("NotLoadedByUnSupportedMarket",this.a);return n}return!0},T:function(){var n=this.d.bB.AdMarket;if(!n)return this.d.s()?this.d.s().toLowerCase():"en-us";if(n&&this.b.a().d()&&this.b.a().d().SupportedMarkets&&Array.contains(this.b.a().d().SupportedMarkets,n.toUpperCase()))return n.toLowerCase();this.l={};var t=n.split("-")[1].toUpperCase();t==="\x00\x00"&&(t="US");var u=this.b.a().d().CountryDefaultMapMarkets;if(u&&u.length>0){for(var e=u,s=e.length,r=0;r<s;++r){var i=e[r];if(!_j.h.a(i)){var f=i.split(":")[0];var o=i.split(":")[1];_j.h.a(f)||_j.h.a(o)||(this.l[f]=o)}}return t in this.l?this.l[t].toLowerCase():n.toLowerCase()}else return n.toLowerCase()},U:function(){var t=this.d.bB.AdMarket;if(t)return t.toLowerCase();else{var n=this.d.s();return n?n.toLowerCase():"en-us"}},S:function(){this.k={};var i=this.b.a().d().ComposeAdsSpecialMapping;if(i&&i.length>0){for(var f=i,o=f.length,n=0;n<o;++n){var t=f[n];if(!_j.h.a(t)){var r=t.split(":")[0];var u=t.split(":")[1];_j.h.a(r)||_j.h.a(u)||(this.k[r]=u)}}var e=this.a.toUpperCase();return e in this.k?("WAB4"+this.k[e]).toUpperCase():("WAB4"+this.N+this.O).toUpperCase()}else return null},bi:function(n){n.b?Array.remove(this.h,n.a):Array.contains(this.h,n.a)||Array.add(this.h,n.a)},ba:function(){var n=this.d.z&&!this.M.bB.IsPremiumConsumerMailbox;n||(this.K?this.c.c("NotLoadedByAdPaidUserO365",this.a):this.c.c("NotLoadedByAdPaidUser",this.a));return n},Z:function(n){if(n&&n.ConsumerSubscriptions)for(var t=0;t<n.ConsumerSubscriptions.length;t++){var i=n.ConsumerSubscriptions[t];if(i==="GA-O365HOMEPREM-XX-SUB"){this.K=!0;this.c.c("NotLoadedByUseHasO365SubscriptionTest",this.a);return!1}}return!1},X:function(){var n=this.d.z&&this.d.bB.IsConsumerChild;n&&this.c.c("NotLoadedByKidAccount",this.a);return n},Y:function(){var n=this.b.a().v().Enabled&&!!this.b.a().v().SupportedMarkets&&Array.contains(this.b.a().v().SupportedMarkets,this.w.toUpperCase())&&this.b.a().hy().Enabled;n&&this.c.c("NotLoadedByNativeAdHide",this.w);return n},bb:function(){var n=this.b.a().eu().Enabled;if(n)if(this.z.h()){this.c.c("NotLoadedByEdgeOffer",this.a);this.e.d(_db.bJ,new _db.bJ);return!0}else this.z.z()&&this.e.d(_db.bK,new _db.bK);return!1},bg:function(n){n.a&&!n.a.a?this.i(!0):this.t("NotLoadedBySwitchingOutFromMailModule")},R:function(){if(this.W()){var n=new _ab.d;var i=this;n.c(function(t){var r=n.N;var i="";r.Subscriptions&&(i=r.Subscriptions.join(","));_j.e.a(_a.a.A,"fetchUserSubscriptionAction success subscription offerid are: {0}",i)});var t=this;n.d(function(n){_j.e.c(_a.a.A,"fetchUserSubscriptionAction failed for user: {0}",t.d.c().bB.UserPuid)});this.n.a(n)}},W:function(){if(!this.b.a().ez().Enabled||!this.G.e().b("15.01.0452.000")||!this.g)return!1;if(this.g.ConsumerSubscriptions)for(var n=0;n<this.g.ConsumerSubscriptions.length;n++){var u=this.g.ConsumerSubscriptions[n];if(u==="GA-O365HOMEPREM-XX-SUB"){var r=_a.d.b(this.g.ConsumerSubscriptionExpireDates[n]);if(r.b(_a.d.a())>0)return!1}}var i=this.b.a().ez().DaysBeforeNextFetch;var t=null;this.g.ConsumerSubscriptionLastFetchDate&&(t=_a.d.b(this.g.ConsumerSubscriptionLastFetchDate));return!i||!t||t.c(i).b(_a.d.get_utcNow())<0?!0:!1},bj:function(){var i=(32768&this.d.a().w())!=32768;if(this.m!==i){if(this.m){var t;(t=this.d.a()).x(t.w()&-32769)}else{var n;(n=this.d.a()).x(n.w()|32768)}_h.f.a(this.d.a().u,this.n)}}};_ab.b=function(n,t,i){this.h=Function.createDelegate(this,this.m);this.e=Function.createDelegate(this,this.k);this.i=Function.createDelegate(this,this.n);this.f=Function.createDelegate(this,this.o);_ab.b.initializeBase(this,[n]);this.c=t;this.d=i;this.g=_g.a.a().s()?_g.a.a().s().toLowerCase():"en-us"};_ab.b.prototype={c:null,d:null,g:null,a:null,b:null,G:function(){_j.c.prototype.G.call(this);this.l()},P:function(){_j.c.prototype.P.call(this);this.c.h(this.f);_j.k.b(this.z,"AdCallbackOwa",this.i)},H:function(){_j.c.prototype.H.call(this);this.b=this.C.a("AdBlockHtmlLabel");this.b&&this.b.fy(this.e)},bC:function(){this.c&&this.c.j(this.f);this.z&&_j.k.c(this.z,"AdCallbackOwa");this.b&&this.b.kJ(this.e);_j.c.prototype.bC.call(this)},k:function(n){for(var i=_j.A.d(n.z.childNodes,"a[target]"),t=0;t<i.length;t++)_j.k.b(i[t],"click",this.h)},m:function(n){this.d.h("AdBlockPage",this.g)},l:function(){var n=this.j();this.a=this.W();this.a.P(window.innerWidth,window.innerHeight,160,n)},o:function(){var n=window.innerWidth;var i=window.innerHeight;if(n>990){var t=this.j();if(this.a){this.a.i(!0);window.wLive&&window.wLive.adbar&&window.wLive.adbar.resize(160,t)}else this.a.P(n,i,160,t)}else{var r=String.format("NotLoadedByNotResizeMinWidth&w={0}&h={1}",n,i);this.a.t(r)}},j:function(){var t=window.innerHeight;var n=t-50;n<=0&&(n=660);return n},n:function(n){var t=n.s;this.d.bs(t.UserMarket,t.ContextRefreshName,t.Provider)}};_ab.a=function(){};_ab.a.$$cctor=function(){_ab.a._I()};_ab.a.e=function(){var n=window.document.createElement("DIV");n.innerHTML="<div> <div class='__Microsoft_Owa_Adsbar_templates_cs_5'> <span class='__Microsoft_Owa_Adsbar_templates_cs_3 ms-fcl-nsa'> </span> <br/> <span class='__Microsoft_Owa_Adsbar_templates_cs_4 ms-fwt-r ms-font-color-black'></span> </div> </div><div> <div class='__Microsoft_Owa_Adsbar_templates_cs_2'></div> </div>";_j.i.a().appendChild(n);return n};_ab.a.h=function(n){return n.x};_ab.a.g=function(n){return n.F};_ab.a.f=function(n,t){n.a(t)};_ab.a.i=function(n,t){n.a(t)};_ab.a.d=function(){_ab.a.b||(_ab.a.b=new _fc.k);return _ab.a.b};_ab.a._I=function(){var t="AdsbarPanelView._tid1";new _j.d(t,function(){_ab.a.a[t]===undefined&&(_ab.a.a[t]=[[[-1,5,["ShowAdBlockMessage"],[_ab.a.h],null,"__Microsoft_Owa_Adsbar_templates_cs_6",null,null,0,_ab.a.d(),null,null]],[[-1,4,null,null,null,"Id",null,_ab.a.f,0,null,null,null,_fm.a.bn]],[[-1,0,["AdBlockUseAdFreeMessage"],[_ab.a.g],null,"Html",null,_ab.a.i,1,null,null,null]]]);var n=_ab.a.c.childNodes[0].cloneNode(!0);var i=new _b.p(_j.a.a(n,[0,2]),_j.b.Instance.a(_a.f));var u=new _fc.d(_j.a.a(n,[0,0]),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));var r=new _j.i(n.children[0]);return new _j.a(n,[r,u,i]).l({AdBlockHtmlLabel:i})},"",_ab.c,_ab.b,function(n){return new _ab.b(n,_j.b.Instance.a(_y.a),_j.b.Instance.a(IInferenceTracker))},!1,!0,!1,0,_ab.a.a);var n="AdsbarPanelView";new _j.d(n,function(){_ab.a.a[n]===undefined&&(_ab.a.a[n]=[null]);var i=_ab.a.c.childNodes[1].cloneNode(!0);var t=new _ab.b(i.children[0],_j.b.Instance.a(_y.a),_j.b.Instance.a(IInferenceTracker));t.O("owaadbar");t.y("AdsbarPanelView._tid1");return new _j.a(i,[t])},"",_ab.c,_ab.b,function(n){return new _ab.b(n,_j.b.Instance.a(_y.a),_j.b.Instance.a(IInferenceTracker))},!1,!1,!1,0,_ab.a.a)};AdsbarComponent.registerClass("AdsbarComponent",null,_a.ii,_j.cd);_ab.d.registerClass("_ab.d",_h.fa);_ab.c.registerClass("_ab.c",_a.bs,IAdsbarViewModel,_j.bq,Sys.IDisposable);_ab.b.registerClass("_ab.b",_j.c);AdsbarComponent.$$cctor();_ab.a.c=_ab.a.e();_ab.a.b=null;_ab.a.a={};_ab.a.$$cctor();
window.scriptsLoaded['microsoft.owa.adsbar.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.adsbar.js'] = (new Date()).getTime(); } catch(e) { window.owaLastErrorReported = e; throw e; }
