try { window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.mail.compose.js'] = (new Date()).getTime();
Type.registerNamespace("_mcp");_mcp.M=function(n,t,i,r){_mcp.M.initializeBase(this,[2]);_a.b.a(n,"approvalMessage");this.u=r;this.bs=!0;this.bf="CreateApprovalResponse";this.l=n;this.k=t;this.s=i};_mcp.M.prototype={l:null,k:null,s:!1,R:function(){_a.da.prototype.R.call(this);this.u===1&&_h.c.j(this.l.bB.ItemId,this.l.bB.ConversationId.Id)},bk:function(){var n;n=this.s?new _gg.Z:new _gg.bW;this.bi=this.u?_g.b.a.nameToId("outbox"):_g.b.a.nameToId("drafts");n.ReferenceItemId=_g.e.a(this.l.bB.ItemId);this.t(n);return[n]},cI:function(n){!this.u&&n.Items&&n.Items[0]?this.F=n.Items[0].ItemId:this.u===1&&_h.c.f(this.l.bB.ItemId,this.l.bB.ConversationId.Id)},T:function(){_a.da.prototype.T.call(this);this.u===1&&_h.c.f(this.l.bB.ItemId,this.l.bB.ConversationId.Id)},t:function(n){if(!this.k){var u=this.s?_nbs.a.qL:_nbs.a.Oc;var r=String.format(_nbs.a.lN,u,this.l.db());n.Subject=r;if(this.l.bB.Sender){var t=new _a.k;t.c(this.l.bB.Sender.Mailbox);n.ToRecipients=_db.e.a(t)}return}var i;_db.e.d(this.k.O(),i={val:this.bA},this.br),this.bA=i.val;n.Importance=this.k.bd();this.k.m()&&this.k.m().b()>0&&(n.ToRecipients=_db.e.a(this.k.m()));this.k.p()&&this.k.p().b()>0&&(n.CcRecipients=_db.e.a(this.k.p()));this.k.x()&&this.k.x().b()>0&&(n.BccRecipients=_db.e.a(this.k.x()));n.Sensitivity=this.k.cg();n.IsDeliveryReceiptRequested=this.k.bB.IsDeliveryReceiptRequested;n.IsReadReceiptRequested=this.k.bB.IsReadReceiptRequested;this.k.O()&&(n.Body=new _g.s(this.k.O().a()==="HTML"?"HTML":"Text",this.k.O().bB.Value));n.Subject=this.k.bB.Subject}};_mcp.bs=function(n,t){_mcp.bs.initializeBase(this);this.f=n;this.e=t};_mcp.bs.prototype={f:null,e:null,i:null,K:function(n){var t=new _gg.po(this.L);n.bl(this.f,this.e,t,this.H,this.G)},cT:function(n,t,i){this.i=n;t()}};_mcp.S=function(){this.f=Function.createDelegate(this,this.j);_mcp.S.initializeBase(this);if(!model)throw Error.argumentNull("model");this.e=model};_mcp.S.a=function(n){_a.b.b(n,"UserAgent shouldn't be null.");return n.q()?_nbs.a.Wd:n.r()?_nbs.a.HN:n.e()?_nbs.a.tP:_nbs.a.bM};_mcp.S.prototype={e:null,b:null,ba:function(){try{var n=_a.bm.a();var t=n.b("MOWA.IsSignatureChanged")==="true"?!0:!1;this.e.a(t?Boolean.parse(n.b("MOWA.AutoAddSignature")):!0);this.e.c(t?n.b("MOWA.SignatureText"):_mcp.S.a(_a.o.a()));this.e.e(t?Boolean.parse(n.b("MOWA.UseDesktopSignature")):!1);this.b=new _h.cc;this.b.c(this.f);_a.g.a.a(this.b)}catch(i){this.i(i)}return 1},k:function(){this.X(null)},i:function(n){this.X(n)},j:function(n){this.e.b(this.b.e.UserOptions.SignatureText);this.k()}};_mcp.bd=function(n,t){_mcp.bd.initializeBase(this);this.e=n;this.f=t};_mcp.bd.prototype={e:null,i:null,f:"EwsLegacyId",j:function(){return this.i},K:function(n){var i=new _gg.dG(this.f);i.DestinationFormat=this.f;i.SourceIds=new Array(this.e.length);for(var t=0;t<this.e.length;t++){var f=new _gg.Y(this.e[t].Format,this.e[t].Id,this.e[t].Mailbox);i.SourceIds[t]=f}var u=new _gg.dF(this.M(),i);var r=new _gg.lP(this.L);n.bb(u,r,this.H,this.G)},cI:function(n){this.i=n.AlternateId}};function MailComposeComponent(){}MailComposeComponent.$$cctor=function(){_a.t.a().a(MailComposeComponent)};MailComposeComponent.a=function(n,t,i){var o=n==="Mouse";var s=!(t.b()&&t.d().b()<9);var r=i.c().bB.UserCulture;var e=!!r&&r.startsWith("en");var f=!!i.l()&&i.l().bB.CheckForForgottenAttachmentsEnabled;var u=!!i.a()&&i.a().bB.CheckForForgottenAttachments;return o&&f&&u&&s&&e};MailComposeComponent.prototype={b:function(n,t,i){var g=this;n.b(_mcp.H,function(){return new _mcp.H(n.d(IMailComposeContextFactory),n.a(_y.W),n.a(_a.E))}).b(IMailComposeControllerExecutor).a();var p=this;n.b(_mcp.G,function(){return new _mcp.G(n.a(_a.x),n.c(ICancelCalendarItemActionFactory),n.a(_j.j))}).b(IMailComposeActionFactory).a();var w=this;n.b(_mcp.bo,function(){return new _mcp.bo(n.a(IInferenceTracker),n.a(_g.a),n.a(IMailComposeContextFactory),n.a(_mcp.G),n.c(ISmimeCommandFactory),n.c(IGetCalendarItemActionFactory),n.c(ICalendarTimeConverterFactory),n.a(_a.x))}).b(IMailResponseViewModelFactory).a();var b=this;n.b(_mcp.bi,function(){return new _mcp.bi(n.a(_y.ec),n.a(_a.x))}).b(IMailComposeContextFactory).a();var e=n.a(_j.o);var o=n.a(_g.h);var u=MailComposeComponent.a(i.a(),e,o);var f=n.a(_a.f);var r=i.a()==="Mouse"&&_g.a.a().bB.AsyncSendEnabled;var d=this;n.b(_mcp.x,function(){return new _mcp.x(n.a(_a.q),n.a(_j.j),n.a(_g.h))}).a();var k=this;n.b(_mcp.bl,function(){return new _mcp.bl(n.c(IExtensibilityViewModelFactory),n.a(_rw.i),u?n.c(IForgottenAttachmentDetectorFactory):null,n.c(IRichPeoplePickerViewModelFactory),n.a(IMailComposeContextFactory),n.a(_mcp.G),n.a(_pe.g),n.a(_y.a),n.c(IOfflineHelpProvider),n.a(_mcp.C),n.a(_y.I),n.a(_j.j),n.c(IAttachmentWellViewModelFactory),f,n.a(_a.x),n.d(IAttachmentsFilePickerPanelViewModel),n.a(IInferenceTracker),n.a(_g.cb),n.a(_a.B),n.c(IMailTipsHandlerFactory),n.c(IPeopleRecommendationsHandlerFactory),n.c(IPolicyTipsHandlerFactory),i.a()==="Mouse"?n.a(_cmc.F):null,r?n.c(_y.cW):null,r?n.c(_y.cE):null,n.c(IFindRecipientMailComposeViewModelFactory),n.d(IComponentOverrideFactory),n.a(_g.a).bB.AttachmentPolicy,n.c(IIntroductionControllerFactory),n.d(ILinkPreviewBuilderFactory),n.c(IToPeoplePickerViewModelFactory),n.c(IGetCalendarItemActionFactory),n.c(ICalendarTimeConverterFactory),n.c(ILocationViewModelFactory),n.c(IExtensibilityEntryPointCollection),n.c(IEntitySuggestionManager),n.c(IModernGroupCardViewModelFactory),n.c(IEntityFeedbackManagerFactory),n.a(_g.a).a(),n.a(_j.o),i,n.a(_y.q),n.a(_h.bf),n.a(_mcp.x),i.a()==="TouchNarrow"?n.a(_y.s):null,n.c(IAtMentionsHandler),n.c(IConsensusSchedulingViewModelFactory),n.c(_db.R),n.c(IInfoBarNotificationsManager),n.c(IDecisionCollabFactory),n.c(IAccessibilityCheckerFactory))}).b(IMailComposeViewModelFactory).a();var y=this;n.b(_mcp.bm,function(){return new _mcp.bm(n.c(IExtensibilityViewModelFactory),n.a(_rw.i),u?n.c(IForgottenAttachmentDetectorFactory):null,n.c(IRichPeoplePickerViewModelFactory),n.a(IMailComposeContextFactory),n.a(_mcp.G),n.a(_pe.g),n.a(_y.a),n.c(IOfflineHelpProvider),n.a(_mcp.C),n.a(_y.I),n.a(_j.j),n.c(IAttachmentWellViewModelFactory),f,n.a(_a.x),n.d(IAttachmentsFilePickerPanelViewModel),n.a(IInferenceTracker),n.a(_g.cb),n.a(_a.B),n.c(IMailTipsHandlerFactory),n.c(IPeopleRecommendationsHandlerFactory),n.c(IPolicyTipsHandlerFactory),i.a()==="Mouse"?n.a(_cmc.F):null,r?n.c(_y.cW):null,r?n.c(_y.cE):null,n.c(IFindRecipientMailComposeViewModelFactory),n.d(IComponentOverrideFactory),n.a(_g.a).bB.AttachmentPolicy,n.c(IIntroductionControllerFactory),n.d(ILinkPreviewBuilderFactory),n.c(IToPeoplePickerViewModelFactory),n.c(IGetCalendarItemActionFactory),n.c(ICalendarTimeConverterFactory),n.c(ILocationViewModelFactory),n.c(IExtensibilityEntryPointCollection),n.c(IEntitySuggestionManager),n.c(IModernGroupCardViewModelFactory),n.c(IEntityFeedbackManagerFactory),n.a(_g.a).a(),n.a(_j.o),i,n.a(_y.q),n.a(_h.bf),n.a(_mcp.x),i.a()==="TouchNarrow"?n.a(_y.s):null,n.c(IAtMentionsHandler),n.c(IConsensusSchedulingViewModelFactory),n.c(_db.R),n.c(IInfoBarNotificationsManager),n.c(IDecisionCollabFactory),n.c(IAccessibilityCheckerFactory))}).b(IMailInlineComposeViewModelFactory).a();var c=this;n.b(_mcp.C,function(){return new _mcp.C(n.a(IMailComposeActionFactory))}).b(IMailComposeDiscardManager).a();var h=this;n.b(_mcp.T,function(){return new _mcp.T(n.a(_y.a),n.a(_j.v),n.a(_g.h),n.a(_j.j),n.a(IMailComposeViewModelFactory))}).a();var s=this;n.b(_mcp.i,function(){return new _mcp.i(window.document.createElement("div"),i.a(),n.a(_j.o),n.a(_a.x),n.a(_a.f),n.a(_j.j),n.a(_a.B),n.a(_b.c))});var v=this;n.b(_mcp.n,function(){return new _mcp.n(window.document.createElement("div"),n.a(_j.o),n.a(_a.x),n.a(_a.f),n.a(_j.j),n.a(_a.B),n.a(_b.c),n.a(_g.a))});var a=this;n.b(_mcp.R,function(){return new _mcp.R(window.document.createElement("div"),n.a(_j.o))});var l=this;n.b(_mcp.U,function(){return new _mcp.U(n.d(_y.bv),i.a())}).a();_a.c.m("MailComposeNew");_a.n.a(_a.bz.f)},a:function(){return[new _j.x(_mcp.U,1,1),new _j.x(_mcp.x,1,73),new _j.x(_mcp.T,4,1)]}};_mcp.T=function(n,t,i,r,u){this.h=Function.createDelegate(this,this.p);this.g=Function.createDelegate(this,this.n);this.j=n;this.f=t;this.l=i;this.c=r;this.d=u;this.c.b(IDelayedSendEvent,this.g);this.c.b(_cmc.bo,this.h)};_mcp.T.prototype={j:null,f:null,l:null,c:null,d:null,a:null,b:null,n:function(n){_j.s.a(n.a(),"SendEvent.DelayedSendCallback is null.");_j.s.a(n.b(),"SendEvent.MailComposeContext is null.");var u=n.c()*1e3;var t=n.b();var f=n.a();var i=this,o=this;var r=new _mcp.bx(this.c,u,function(){_j.e.a(_a.a.a,"UndoDelayedSendAction.undoDelegate - cancelling the queued delayed-send task.");_g.i.isInstanceOfType(t.P())&&_h.c.A(t.P(),!1);i.k()||_j.e.b(_a.a.a,"TryCancelQueuedTask failed on undo delayed send. Continuing to navigate to the draft.");_j.e.a(_a.a.a,"UndoDelayedSendAction.undoDelegate - popping the cancelled undo action from the undo stack.");i.e();i.o(t)},function(){_j.e.a(_a.a.a,"UndoDelayedSendAction.flushDelegate - cancelling the queued delayed-send task.");if(o.k()){_j.e.a(_a.a.a,"Flushing the delayed-send task by firing the send callback.");f()}});_j.e.a(_a.a.a,"HandleDelayedSendEvent - pushing the undo action to the undo stack.");this.q(r);_j.e.a(_a.a.a,"HandleDelayedSendEvent - queueing the delayed-send task.");var e=this;this.a=_j.m.a().a(_a.a.a,"SubmitDelayedComposeAction",function(){e.m(f,r)},u)},m:function(n,t){_j.e.a(_a.a.a,"DelayedSendTaskDelegate - executing the delayed-send task callback.");t.a();this.a=null;if(t===this.b){_j.e.a(_a.a.a,"DelayedSendTaskDelegate - action flushed; now popping the action from the undo stack.");this.e()}},k:function(){_j.e.a(_a.a.a,"TryCancelQueuedTask - attempting to cancel the queued delayed-send task...");var n=!1;if(this.a){this.a=this.f.b(this.a);_j.e.a(_a.a.a,"TryCancelQueuedTask - delayed-send task has been cancelled.");n=!this.a}else _j.e.b(_a.a.a,"TryCancelQueuedTask- queuedTaskHandle is null on flush, skipping...");return n},o:function(n){_j.e.a(_a.a.a,"NavigateToDelayedMessage - navigating to the cancelled draft message.");n.e(!1);var t=this.d.a(n,null,null);t.cl=!1;t.cn=!1;t.bl().d(new _y.bm);var i=this;t.k(function(){t.dispose()});t.bl().b().a()},p:function(n){this.i()},q:function(n){this.i();this.b=n},i:function(){var n=this.e();n&&n.a()},e:function(){var n=this.b;this.b=null;return n}};_mcp.U=function(n,t){if(t==="Mouse"){var i=this;n.c(function(n){n.a(_mcp.b,"MailComposeContext")},!1)}};_mcp.x=function(n,t,i){this.e=Function.createDelegate(this,this.i);this.f=Function.createDelegate(this,this.j);_mcp.x.initializeBase(this);this.d=n;this.h=t;this.c=i.a();this.a=0;var r=this.c.bB.SignatureHtml;r===""||r||this.k()};_mcp.x.prototype={d:null,h:null,c:null,a:0,b:null,k:function(){this.b=new _cmc.g(_a.a.a,"MailComposeSigPreload",!1);this.a=1;var n=new _mcp.bu;n.c(this.f);n.d(this.e);this.d.a(n)},j:function(n){this.c.bi(n.e.bB.AutoAddSignature);this.c.bx(n.e.bB.SignatureHtml);this.c.by(n.e.bB.SignatureText);this.a=2;this.ez("CurrentStatus");this.g(n,!1)},i:function(n){this.a=3;_j.e.b(_a.a.a,"SignaturePreloadService.OnPreloadFailed - error: '{0}'",n.I?n.I.message:"");this.ez("CurrentStatus");this.g(n,!0)},g:function(n,t){if(this.b)if(t){this.b.k(n.O());this.b.d(n.P(),null)}else this.b.b()}};_mcp.bw=function(){};_mcp.bv=function(n){_mcp.bv.initializeBase(this);this.f=n;this.k=_a.a.bk;this.i="GetSuggestedGroupsFromRecipientsAction"};_mcp.bv.prototype={e:null,n:0,j:!1,f:null,i:null,k:null,K:function(n){var i=new _gg.ia(this.M());var t=new _gg.uy(this.L);t.actionName="GetSuggestedGroupsFromRecipientsAction";i.Body.Recipients=this.f;_a.n.b(this.k,this.i,!0);n.gh(i,t,this.H,this.G)},cT:function(n,t,i){try{if(n.Body.ResponseCode==="NoError"){this.e=n.Body.SuggestedUnifiedGroups;this.n=n.Body.SuggestedUnifiedGroupCount;this.j=n.Body.ShouldCreateNewGroup;this.l(null);t()}else{var r=Error.create("GetSuggestedGroupsFromRecipientsAction: group suggestions could not be retrieved.ResponseCode: "+n.Body.ResponseCode+"."+"MessageText: "+n.Body.MessageText+".");this.l(r);i(r)}}catch(u){this.l(u);i(u)}},l:function(n){var i=null;n&&(i=n.message?n.message:n.name?n.name.toString():"UnknownError");var r=_a.n.c(this.i);if(r){var t=new _a.l;this.f&&t.a("rc",this.f.length);if(this.e){t.a("sgc",this.e.length);if(this.e[0].TopRelevantMembers){t.a("sgmc",this.e[0].TopRelevantMembers.length);t.a("mrp",this.e[0].TopRelevantMembers.length*100/this.f.length)}}this.j?t.c("scng",!0):t.c("scng",!1);r.j=t.toString();r.k=i;r.l=this.O();_a.n.a(this.i)}}};_mcp.bx=function(n,t,i,r){this.p=Function.createDelegate(this,this.a);this.l=n;this.o=i;this.n=r;var u=this;this.l.a(_a.bl,new _a.bl(11,_u.P.d,_u.P.v,_u.P.M,this.p,function(){u.g()},null))};_mcp.bx.prototype={l:null,o:null,n:null,m:!1,toString:function(){return _u.n.Mc},g:function(){this.m=!0;this.o();this.m=!1;this.k();return!0},a:function(){this.n();this.l.a(_a.bl,new _a.bl(13,"","","",null,null,null))},j:function(){this.l.a(_a.bl,new _a.bl(4,"","","",null,null,null))},k:function(){this.l.a(_a.bl,new _a.bl(12,"","","",null,null,null))},f:function(){return this.m},c:function(){return null},e:function(n){return!1},d:function(n){return!1},b:function(n){return!0},i:function(n){},h:function(){}};_mcp.w=function(n){_mcp.w.initializeBase(this);this.e=n};_mcp.w.prototype={e:null,K:function(n){var i=this.f();var t=new _gg.pp(this.L);t.explicitLogonUser=this.e.E();this.e.e()&&!t.actionName&&(t.actionName=this.e.e());n.dS(i,t,this.H,this.G)},f:function(){var t=this.e.l();var i=new _gg.gs(this.M());var n=new _gg.dL;n.Items=t.Items;n.ItemShape=t.ItemShape;n.ShapeName=t.ShapeName;n.SubjectPrefix=t.SubjectPrefix;n.ClientSupportsIrm=t.ClientSupportsIrm;n.ComplianceId=t.ComplianceId;n.ComposeOperation=t.ComposeOperation;n.IsNonDraft=t.IsNonDraft;n.MessageDisposition=t.MessageDisposition;n.OutboundCharset=t.OutboundCharset;n.SavedItemFolderId=t.SavedItemFolderId;n.SendOnNotFoundError=t.SendOnNotFoundError;n.ShouldSuppressReadReceipt=t.ShouldSuppressReadReceipt;n.UseGB18030=t.UseGB18030;n.UseISO885915=t.UseISO885915;n.TimeFormat=t.TimeFormat;i.Body=n;return i},Z:function(n){_h.fa.prototype.Z.call(this,n)},cI:function(n){this.e.s(n)}};_mcp.bt=function(){_mcp.bt.initializeBase(this)};_mcp.bt.prototype={e:null,f:null,i:null,K:function(n){var i=new _gg.ef(this.M());var t=new _gg.mb(200);n.z(i,t,this.H,this.G)},cT:function(n,t,i){if(n.Options){this.e=n.Options.EmailAddresses;this.f=n.Options.NotManagedEmailAddresses;this.i=n.Options.SendEnabledConnectedAccounts;t&&t()}else!_j.h.a(n.ErrorMessage)&&i&&i(Error.create(n.ErrorMessage))}};_mcp.bu=function(){_mcp.bu.initializeBase(this)};_mcp.bu.prototype={e:null,K:function(n){var t=new _gg.mh(this.L);n.B(t,this.H,this.G)},cT:function(n,t,i){this.e=new _gg.c(n.Options);t()}};var IMailComposeOverridable=function(){};IMailComposeOverridable.registerInterface("IMailComposeOverridable");_mcp.bj=function(){};_mcp.bj.a=function(n){var t=null;_db.e.isInstanceOfType(n)?t=n.F:_mco.c.isInstanceOfType(n)?t=n.bn:_mcp.w.isInstanceOfType(n)&&(t=n.e.i());return t};_mcp.N=function(n,t,i,r){_mcp.N.initializeBase(this,["AddOriginalAttachmentInfoBarView"]);this.a=n;this.d=t;this.b=new _j.g(i,_a.a.a);this.c=new _j.g(r,_a.a.a)};_mcp.N.prototype={d:0,a:null,f:function(){return this.a.length===1?String.format(_u.R.Lh,this.a[0].Name):String.format(_u.n.Pr,this.a.length)},e:function(){return this.d>1?_u.n.CV:_u.n.Ch},b:null,c:null};_mcp.bU=function(n,t,i){this.e=n;this.f=t;this.d=i};_mcp.bU.prototype={e:0,c:function(){return this.e},f:null,b:function(){return this.f},d:null,a:function(){return this.d}};_mcp.bV=function(){};_mcp.bX=function(n,t){this.c=n;this.d=t};_mcp.bX.prototype={c:null,d:null,a:function(){return this.c},b:function(){return this.d}};_mcp.bq=function(n){this.a=n};_mcp.bq.prototype={a:null};_mcp.ca=function(n){this.b=n};_mcp.ca.prototype={b:null,a:function(){return this.b}};_mcp.Q=function(n,t,i,r){this.g=n;this.e=t;this.h=i;this.f=r};_mcp.Q.prototype={g:!1,e:null,h:!1,f:null,c:function(){return this.g},a:function(){return this.e},d:function(){return this.h},b:function(){return this.f}};_mcp.br=function(n){this.b=n};_mcp.br.prototype={b:!1,a:function(){return this.b}};_mcp.cb=function(n){this.b=n};_mcp.cb.prototype={b:null,a:function(){return this.b}};_mcp.G=function(n,t,i){this.f=n;this.j=t;this.g=i};_mcp.G.prototype={f:null,j:null,g:null,h:function(n,t){var i=n.Z;var u=i.a();var s=3===u||2===u||1===u;var e=this.f.b()&&i.m();(n.bK().j()||i.dy()&&(i.dn()||n.bg().m()>0))&&(e=!!(e&i.bl()));var f=null;if(s&&!e||14===u||n.bE)f=this.l(i,t);else if(i.bs()){_j.e.a(_a.a.a,"Creating UpdateMessageForComposeAction; disposition={0}",t);var h=this.m(t,i);f=h}else if(8===i.a()){_j.e.a(_a.a.a,"Creating CancelCalendarItemAction; disposition={0}",t);f=this.o(i,t)}else if(u!==5&&u!==6&&u!==7)if(u===9||u===10){_j.e.a(_a.a.a,"CreateComposeAction: ApprovalRequestAction");f=this.n(i,t)}else{_j.e.a(_a.a.a,"Creating CreateMessageForComposeAction; disposition={0}",t);var r=null;if(u===11||u===12){r=new _mco.a(i.by(!1),i.bM(),this.f,this.g);r.u=0}else{var o=this.k(i);r=new _mco.a(o,null,this.f,this.g);r.u=t}r.br=!this.f.b();i.w()&&(r.bB=i.w());r.ci=i.bT(100);r.cj=_y.m.toString(i.a());r.bT=i.S();r.bU=i.T();f=r}f.Y=i.d();return f},i:function(n,t,i){var r=new _h.cx(200,n);r.i=t||_h.b.b();r.q=_j.t.a(i)?"MailCompose":i;return r},b:function(n,t){var r=t?"HardDelete":"MoveToDeletedItems";return new _db.cw([n],r,2)},a:function(n,t){var r=null;r=n.R()?n.by(!0):n.E(!0);var i=this.d(n,r);i.bp=t;i.bD=!this.f.b()&&n.j()==="HTML"?"MailComposeNormalizedBody":"MailCompose";i.ce=_g.a.a().a().bB.TimeFormat;return i},o:function(n,t){var i=null;var r=this;this.j.b(function(t){i=t.a(n.A(),1,n.dj());i.l(n.E(!1));n.w()&&i.k(n.w())});return i},d:function(n,t){var r=n.cv()?new _db.p(n.A()):n.A();var i=null;i=new _mco.f(this.q(n.a()),r,this.f,this.g);i.bH(t);i.bx=n.dt();i.br=!this.f.b();n.w()&&(i.bB=n.w());i.bn=n.bi();i.bu=n.du();i.Y=n.d();n.g()&&_g.i.isInstanceOfType(n.g())&&n.g().bB.IsReadReceiptRequested&&(i.bQ=!0);switch(n.a()){case 1:case 2:i.bV=_u.n.NL;break;case 3:i.bV=_nbs.a.ar;break}return i},e:function(n,t,i){return new _mco.c(n,t,i)},c:function(n,t,i){var r;r=_g.bv.isInstanceOfType(n)?this.p(n,this.f):new _mco.a(n,null,this.f,this.g);return r},l:function(n,t){var r;_j.e.a(_a.a.a,"Creating CreateResponseAction; layout={0}; disposition={1}",_y.c.a.a(),t);var f=n.E(!1);var i=this.d(n,f);i.u=t;i.ci=n.bT(100);i.cj=_y.m.toString(n.a());i.bT=n.S();i.bU=n.T();if(n.bG()){var u=new _mcp.w(i);r=u}else r=i;return r},k:function(n){return n.E(!1)},m:function(n,t){var i=null;if(t.R()){i=new _mco.c(t.by(!1),this.f,this.g);i.bm=_g.m.b(t.bM());i.u=0}else{i=new _mco.c(t.E(!1),this.f,this.g);i.u=n}i.bW=!this.f.b();i.bt=t.S();i.bu=t.T();t.w()&&(i.bf=t.w());i.bU=t.bT(100);i.bo="AlwaysOverwrite";i.bx=_y.m.toString(t.a());return i},q:function(n){switch(n){case 1:return new _g.bO;case 2:return new _g.bs;case 3:return new _g.bK;case 12:return new _g.eE;case 14:return new _g.dD;case 16:return new _g.bs;default:throw Error.invalidOperation("Unable to get SmartResponseType from MailComposeOperation "+_y.m.toString(n));}},n:function(n,t){var r=n.g();var i=new _mcp.M(r,n.E(!1),n.a()===9,t);i.br=!this.f.b();return i},p:function(n,t){var r=_mco.f.a(n);var i=new _mco.f(r,n.bB.ReferenceItemId,this.f,this.g);i.br=!t.b();i.bH(n);i.bx=n.n();i.bQ=!0;return i}};_mcp.bi=function(n,t){this.e=n;this.d=t};_mcp.bi.prototype={d:null,e:null,a:function(n,t){var i=new _mcp.b;if(this.d){i.ek(this.d.b());i.ek(this.d.b())}i.p(n?0:this.e.a());return i},b:function(n,t,i,r){var u=this.a(!1,!1);u.p(this.e.a());u.c(4);u.e(!1);u.H(n);u.cL(t);r&&!r.a()?u.i(r.g()):u.i(i===1?"Text":"HTML");return u},c:function(n,t,i,r,u,f){var e=this.a(!1,!1);e.p(this.e.a());e.c(16);e.e(!1);e.H(n.bB.ItemId);e.cL(!1);i&&!i.a()?e.i(i.g()):e.i(t===1?"Text":"HTML");e.cC(n);e.dD(r,u,f);return e}};_mcp.bl=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,lt,at,vt,yt,pt,wt,bt,kt,dt,gt,ni,ti,ii,ri,ui,fi,ei,oi,si){_a.b.b(k,"nativeBridge");this.B=n;this.P=t;this.F=i;this.Q=r;this.bc=u;this.i=f;this.N=e;this.d=o;this.L=s;this.y=h;this.O=c;this.z=l;this.E=v;this.c=y;this.C=p;this.s=a;this.H=w;this.u=b;this.K=k;this.n=d;this.o=g;this.p=nt;this.w=tt;this.S=it;this.R=rt;this.D=ut;this.U=ft;this.r=et;this.I=ot;this.J=st;this.V=ht;this.l=ct;this.k=lt;this.m=at;this.A=vt;this.e=yt;this.f=pt;this.h=bt;this.g=wt;this.W=kt;this.t=dt;this.G=gt;this.M=ni;this.T=ti;this.j=ii;this.q=ri;this.x=oi;this.v=ui;this.Y=fi;this.Z=ei;this.ba=si};_mcp.bl.prototype={A:null,B:null,P:null,F:null,Q:null,bc:null,i:null,z:null,N:null,d:null,L:null,y:null,O:null,E:null,c:null,C:null,V:null,s:null,u:null,H:null,w:null,K:null,n:null,o:null,p:null,S:null,R:null,D:null,U:null,r:null,I:null,J:null,l:null,k:null,m:null,x:null,W:null,t:null,G:null,M:null,T:null,j:null,q:null,v:null,Y:null,Z:null,ba:null,e:null,f:null,h:null,g:null,b:function(n,t,i){return this.bd(n,null,t,i)},a:function(n,t,i){return this.X(n,null,t,i)},bd:function(n,t,i,r){var u=this.bc.a(!1,!1);u.hc(n);return this.X(u,t,i,r)},X:function(n,t,i,r){var u=null;u=this.d.a()==="Mouse"?new _mcp.bk(n,t,this.B,this.P,this.F,this.Q,this.N,this.d,this.L,this.y,this.O,this.z,this.s,this.E,this.c,this.C,this.H,this.u,this.K,this.i,i,r,this.n,this.o,this.p,this.w,this.S,this.R,this.D,this.U,this.r,this.I,this.J,this.V,this.l,this.k,this.m,this.A,this.e,this.f,this.g,this.h,this.W,this.t,this.G,this.M,this.T,this.j,this.q,this.v,this.Y,this.Z,this.x,this.ba):new _mcp.d(n,t,this.B,this.P,this.F,this.Q,this.N,this.d,this.L,this.y,this.O,this.z,this.s,this.E,this.c,this.C,this.H,this.u,this.K,this.i,i,r,this.n,this.o,this.p,this.w,this.S,this.R,this.D,this.U,this.r,this.I,this.J,this.V,this.l,this.k,this.m,this.A,this.e,this.f,this.g,this.h,this.W,this.t,this.G,this.M,this.T,this.j,this.q,this.v,this.Y,this.Z,this.x,this.ba);u.ch();return u}};_mcp.bm=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,lt,at,vt,yt,pt,wt,bt,kt,dt,gt,ni,ti,ii,ri,ui,fi,ei,oi,si){_mcp.bm.initializeBase(this,[n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,lt,at,vt,yt,pt,wt,bt,kt,dt,gt,ni,ti,ii,ri,ui,fi,ei,oi,si])};_mcp.bm.prototype={X:function(n,t,i,r){var u=new _mcp.D(n,t,this.B,this.P,this.F,this.Q,this.N,this.d,this.L,this.y,this.O,this.z,this.s,this.E,this.c,this.C,this.H,this.u,this.K,this.i,i,r,this.n,this.o,this.p,this.w,this.S,this.R,this.D,this.U,this.r,this.I,this.J,this.V,this.l,this.k,this.m,this.A,this.e,this.f,this.g,this.h,this.W,this.t,this.G,this.M,this.T,this.j,this.q,this.v,this.Y,this.Z,this.x,this.ba);u.ch();return u}};_mcp.bh=function(){_mcp.bh.initializeBase(this)};_mcp.bh.prototype={b:null,a:null,d:function(n){if(this.b!==n){this.b=n;this.ez("Description")}return n},c:function(n){if(this.a!==n){this.a=n;this.ez("ConversationOwner")}return n}};_mcp.Y=function(n){this.e=Function.createDelegate(this,this.i);_mcp.Y.initializeBase(this);this.b=_a.g.a;this.c=n};_mcp.Y.prototype={c:null,b:null,a:function(n,t,i,r){t&&n.c(t);n.d(i||this.e);r&&n.a(r);this.b.a(n)},f:function(n,t){var i=_nbs.a.OB;this.g(n,i,null,i,null,t)},h:function(n,t,i,r,u,f){var e=t;var o=n.I;if(o){if(_g.R.a(o)){var h=o;if(h.ErrorCode===503){_j.e.a(_a.a.a,"GetErrorMessage returning service unavailable {0} since the specified exception was a service unavailable json fault body",_u.R.Dm);e=_u.R.Dm}else if(h.ErrorCode===408&&u){_j.e.a(_a.a.a,"GetErrorMessage returning request timeout {0} since the specified exception was a request timeout json fault body",u);e=u}else if(_g.R.c(h)&&i){_j.e.a(_a.a.a,"GetErrorMessage returning disconnected {0} since the specified exception was a disconnected json fault body",i);e=i}}if(e===t){var s=_a.b.l(o);s?r&&s==="ErrorItemNotFound"?e=r:s==="ErrorAccessDenied"?e=_u.R.DX:f&&s==="ErrorQuotaExceeded"?e=f:_j.e.a(_a.a.cp,"CalculateInfoBarMessageId returning default id "+t+" since the specified exception was not one of the specific jsonFaultBody or response code exceptions we are currently looking for"):_j.e.b(_a.a.cp,"CalculateInfoBarMessageId returning default id "+t+" since the specified exception was not a JsonFaultBody exception or an exception with response code. The exception.Message was "+o.message)}}else _j.e.a(_a.a.a,"GetErrorMessage returning default message {0} since the exception was null",t);_j.e.a(_a.a.a,"MailComposeActionSubmitter.GetErrorMessage: showing error {0}",e);return e},g:function(n,t,i,r,u,f){var e=this.h(n,t,i,r,u,null);this.c.g(0,e,f)},i:function(n){this.f(n,null);this.d(n)},d:function(n){this.bN("MailComposeActionFailed",n)}};_mcp.b=function(){this.fB=Function.createDelegate(this,this.gK);this.u=this.I;this.da=this.v;this.cY=this.y;this.cZ=this.bD;this.ey=this.j;this.ex=this.q;_mcp.b.resolveInheritance();this.ev=this.eL;this.eu=this.eU;_mcp.b.initializeBase(this);this.i("Html"===_g.a.a().a().m()?"HTML":"Text");this.apcl(_mcp.b.c.a,this.fB);this.apcl(_mcp.b.k.a,this.fB);if(_a.p.a&&_a.p.d()){this.eo(_g.a.a().a().bB.SmimeEncrypt);this.eq(_g.a.a().a().bB.SmimeSign)}this.fg=-1;this.eP={};this.eT={}};_mcp.b.$$cctor=function(){_mcp.b.o.b(new _a.bx(_g.f));_mcp.b.i.b(new _a.bx(_g.f));_mcp.b.h.b(new _a.bx(_g.f));_mcp.b.n.b(new _a.bx(_pc.a));_mcp.b.f.b(new _a.bx(_g.Attachment));_mcp.b.j.b(new _a.bx(_g.bj));_mcp.b.g.b(new _a.bx(_db.d))};_mcp.b.a=function(){_mcp.b.b||_mcp.b.d||_mcp.b.cd();return _mcp.b.b};_mcp.b.ce=function(){_mcp.b.b||_mcp.b.d||_mcp.b.cd();return _mcp.b.d};_mcp.b.cd=function(){var n=_g.a.a().c();_j.h.a(n.bB.SharePointUrl)?_mcp.b.b=n.bB.UserEmailAddress||"":_mcp.b.b=n.bB.LogonEmailAddress||"";_mcp.b.d=n.bB.UserDisplayName};_mcp.b.cb=function(n,t,i,r){if(!(i in t))return r;var u=t[i];return _j.h.a(u)?r:_j.t.b(n,u)};_mcp.b.ca=function(n,t,i){if(!(t in n))return i;var r=n[t];return _j.h.a(r)?i:Boolean.parse(r)};_mcp.b.bZ=function(n){return!_j.h.b(_mcp.b.a())&&!_j.h.b(n)&&(_mcp.b.a()===n||_mcp.b.a().toLowerCase()===n.toLowerCase())};_mcp.b.cg=function(n){return n.replace(_mcp.b.cc,"\r\n")};_mcp.b.prototype={fP:null,eV:null,eW:!1,fA:null,gG:function(n){this.eE("BeforeDraftUpdateEvent",n)},hi:function(n){this.eF("BeforeDraftUpdateEvent",n)},gF:function(n){this.eE("AfterDraftUpdateEvent",n)},hh:function(n){this.eF("AfterDraftUpdateEvent",n)},db:function(n){this.eE("OnAsyncSendCallbackEvent",n)},dG:function(n){this.eF("OnAsyncSendCallbackEvent",n)},gH:function(n){this.eE("OnInitializingDraftContentEvent",n)},hj:function(n){this.eF("OnInitializingDraftContentEvent",n)},gI:function(n){this.eE("OnPrepareQuotedBodyEvent",n)},hk:function(n){this.eF("OnPrepareQuotedBodyEvent",n)},ft:!1,dl:function(){return this.ft},cK:function(n){this.ft=n;return n},d:function(){return this.eB(_mcp.b.bV)},fW:function(n){this.eA(_mcp.b.bV,n);return n},a:function(){return this.eB(_mcp.b.c)},c:function(n){this.eA(_mcp.b.c,n);return n},l:function(){return this.eB(_mcp.b.l)},p:function(n){this.eA(_mcp.b.l,n);return n},A:function(){return this.eB(_mcp.b.br)},cf:function(n){this.eA(_mcp.b.br,n);return n},dt:function(){return this.eB(_mcp.b.bq)},eg:function(n){this.eA(_mcp.b.bq,n);return n},g:function(){this.eV||(this.eV=this.eB(_mcp.b.bs));return this.eV},cg:function(n){this.eV=n;this.eA(_mcp.b.bs,this.eV);return n},h:function(){return this.eB(_mcp.b.H)},H:function(n){if(this.h()&&n){this.h().Id=n.Id;this.h().ChangeKey=n.ChangeKey}else this.eA(_mcp.b.H,n);return n},bs:function(){return!!this.h()},bf:function(){return!this.gn()},gR:function(){return this.eB(_mcp.b.bP)},hr:function(n){this.eA(_mcp.b.bP,n);return n},I:function(){return this.eB(_mcp.b.bQ)},v:function(n){this.eA(_mcp.b.bQ,n);return n},y:function(){return this.eB(_mcp.b.K)},r:function(n){this.eA(_mcp.b.K,n);return n},B:function(){return this.eB(_mcp.b.bD)},cP:function(n){this.eA(_mcp.b.bD,n);return n},di:function(){return this.eB(_mcp.b.J)},cG:function(n){this.eA(_mcp.b.J,n);return n},eR:null,bD:function(){return this.eR},dT:function(n){this.eR=n;return n},j:function(){return this.eB(_mcp.b.t)},i:function(n){this.eA(_mcp.b.t,n);return n},f:function(){return this.eB(_mcp.b.o)},s:function(n){this.eA(_mcp.b.o,n);return n},bQ:function(){return this.eB(_mcp.b.n)},er:function(n){this.eA(_mcp.b.n,n);return n},bo:function(){return this.eB(_mcp.b.bR)},cT:function(n){this.eA(_mcp.b.bR,n);return n},k:function(){return this.eB(_mcp.b.i)},bb:function(n){this.eA(_mcp.b.i,n);return n},bh:function(){return this.eB(_mcp.b.v)},dK:function(n){this.eA(_mcp.b.v,n);return n},b:function(){return this.eB(_mcp.b.h)},bV:function(n){this.eA(_mcp.b.h,n);return n},N:function(){return this.eB(_mcp.b.s)},dJ:function(n){this.eA(_mcp.b.s,n);return n},gj:function(){return this.eB(_mcp.b.m)},e:function(n){this.eA(_mcp.b.m,n);return n},X:function(){return this.eB(_mcp.b.U)},dV:function(n){this.eA(_mcp.b.U,n);return n},dw:function(){return this.eB(_mcp.b.bz)},fl:function(n){this.eA(_mcp.b.bz,n);return n},gQ:function(){return this.eB(_mcp.b.bI)},en:function(n){this.eA(_mcp.b.bI,n);return n},bO:function(){return this.eB(_mcp.b.bK)},cR:function(n){this.eA(_mcp.b.bK,n);return n},gk:function(){return this.eB(_mcp.b.bL)},ep:function(n){this.eA(_mcp.b.bL,n);return n},fJ:function(){return this.eB(_mcp.b.p)},cD:function(n){this.eA(_mcp.b.p,n);return n},fp:0,O:function(){return this.fp},ca:function(n){this.fp=n;return n},eX:null,bA:function(){return this.eX},bU:function(n){this.eX=n;return n},fc:0,cy:function(){return this.fc},M:function(n){this.fc=n;return n},gh:function(){return this.eB(_mcp.b.ba)},fe:function(n){this.eA(_mcp.b.ba,n);return n},br:function(){return this.eB(_mcp.b.k)},fT:function(n){this.eA(_mcp.b.k,n);return n},bj:function(){return this.eB(_mcp.b.be)},fU:function(n){this.eA(_mcp.b.be,n);return n},dm:function(){return this.eB(_mcp.b.bl)},gv:function(n){this.eA(_mcp.b.bl,n);return n},fx:function(){return this.eB(_mcp.b.bp)},gw:function(n){this.eA(_mcp.b.bp,n);return n},bF:function(){return this.eB(_mcp.b.R)},gr:function(n){this.eA(_mcp.b.R,n);return n},dk:function(){return this.eB(_mcp.b.W)},dX:function(n){this.eA(_mcp.b.W,n);return n},n:function(){return this.eB(_mcp.b.N)},cH:function(n){this.eA(_mcp.b.N,n);return n},bt:function(){return this.eB(_mcp.b.bE)},cQ:function(n){this.eA(_mcp.b.bE,n);return n},m:function(){return this.eB(_mcp.b.bo)},cN:function(n){this.eA(_mcp.b.bo,n);return n},dy:function(){return this.eB(_mcp.b.bH)},hq:function(n){this.eA(_mcp.b.bH,n);return n},z:function(){return this.eB(_mcp.b.bc)},ea:function(n){this.eA(_mcp.b.bc,n);return n},ct:function(){return this.eB(_mcp.b.Y)},fz:function(n){this.eA(_mcp.b.Y,n);return n},Y:function(){return this.eB(_mcp.b.X)},cb:function(n){this.eA(_mcp.b.X,n);return n},bN:function(){return this.eB(_mcp.b.bv)},ei:function(n){this.eA(_mcp.b.bv,n);return n},bM:function(){return this.eB(_mcp.b.bu)},eh:function(n){this.eA(_mcp.b.bu,n);return n},gN:function(){return!!this.cm()},cm:function(){return this.eB(_mcp.b.u)},cE:function(n){this.eA(_mcp.b.u,n);return n},cv:function(){return this.eB(_mcp.b.bg)},cM:function(n){this.eA(_mcp.b.bg,n);return n},dj:function(){return this.eB(_mcp.b.M)},dR:function(n){this.eA(_mcp.b.M,n);return n},gg:function(){return this.eB(_mcp.b.V)},dW:function(n){this.eA(_mcp.b.V,n);return n},bE:function(){return this.eB(_mcp.b.Q)},fR:function(n){this.eA(_mcp.b.Q,n);return n},cr:function(){return this.eB(_mcp.b.P)},dU:function(n){this.eA(_mcp.b.P,n);return n},S:function(){return this.eB(_mcp.b.bS)},cU:function(n){this.eA(_mcp.b.bS,n);return n},T:function(){return this.eB(_mcp.b.bT)},hs:function(n){this.eA(_mcp.b.bT,n);return n},bm:function(){return this.eB(_mcp.b.bm)},ce:function(n){this.eA(_mcp.b.bm,n);return n},P:function(){return this.eB(_mcp.b.I)},dP:function(n){this.gV();this.eA(_mcp.b.I,n);this.gU();return n},bg:function(){return this.eB(_mcp.b.q)},hm:function(n){this.eA(_mcp.b.q,n);return n},V:function(){return this.eB(_mcp.b.O)},cI:function(n){this.eA(_mcp.b.O,n);return n},q:function(){return this.eB(_mcp.b.f)},U:function(n){var i=null;if(n){i=new _j.l;for(var t=0;t<n.b();t++)i.a(n.c(t))}this.eA(_mcp.b.f,i);this.gD();return n},bz:function(){return this.eB(_mcp.b.g)},dI:function(n){this.eA(_mcp.b.g,n);return n},gM:function(){return this.eB(_mcp.b.G)},hn:function(n){this.eA(_mcp.b.G,n);return n},L:function(){return this.eB(_mcp.b.bU)},et:function(n){this.eA(_mcp.b.bU,n);return n},eN:function(){return this.eB(_mcp.b.r)},fo:function(n){this.eA(_mcp.b.r,n);return n},eO:null,eS:!1,bG:function(){return this.eS},cJ:function(n){this.eS=n;return n},fn:!1,cu:function(){return this.fn},F:function(){return this.eB(_mcp.b.bC)},ch:function(n){if(n!==this.F()){this.eA(_mcp.b.bC,n);this.eD("IsCopyRestricted","IsPrintRestricted")}return n},w:function(){return this.eB(_mcp.b.A)},bZ:function(n){this.eA(_mcp.b.A,n);return n},fY:!1,em:function(n){this.fY=n;return n},bq:function(){return this.eW},dZ:function(n){if(this.eW!==n){this.eW=n;n&&!this.eN()&&this.gf();this.ez("IsEditorInitialized")}return n},fC:null,dQ:function(n){this.fC=n;return n},fD:!1,ee:function(n){this.fD=n;return n},bH:function(){return this.eB(_mcp.b.bd)},fS:function(n){this.eA(_mcp.b.bd,n);return n},dB:function(){return this.eB(_mcp.b.bW)},fa:function(n){this.eA(_mcp.b.bW,n);return n},W:function(){return this.eB(_mcp.b.T)},gt:function(n){this.eA(_mcp.b.T,n);return n},gi:function(){return this.eB(_mcp.b.bf)},cL:function(n){this.eA(_mcp.b.bf,n);return n},cA:function(){return this.eB(_mcp.b.bX)},fX:function(n){this.eA(_mcp.b.bX,n);return n},fL:function(){return!!this.F()&&!this.F().a()&&!this.F().f()&&!this.F().b()},bu:function(){return this.br()&&_mcp.g.g(this)},fK:function(){return!!this.F()&&0===this.F().a()&&!this.F().h()&&!this.F().b()},be:function(){return null},ci:function(){return this.I()},bx:function(){return this.fP},bp:function(){return this.eB(_mcp.b.Z)},cc:function(n){this.eA(_mcp.b.Z,n);return n},de:function(){return this.eB(_mcp.b.x)},bY:function(n){this.eA(_mcp.b.x,n);return n},cq:function(){return this.eB(_mcp.b.F)},dO:function(n){this.eA(_mcp.b.F,n);return n},cp:function(){return this.eB(_mcp.b.E)},dN:function(n){this.eA(_mcp.b.E,n);return n},gL:function(){return this.eB(_mcp.b.D)},dM:function(n){this.eA(_mcp.b.D,n);return n},cn:function(){return this.eB(_mcp.b.z)},bW:function(n){this.eA(_mcp.b.z,n);return n},co:function(){return this.eB(_mcp.b.w)},bX:function(n){this.eA(_mcp.b.w,n);return n},df:function(){return this.eB(_mcp.b.y)},gp:function(n){this.eA(_mcp.b.y,n);return n},C:function(){return this.eB(_mcp.b.bG)},el:function(n){this.eA(_mcp.b.bG,n);return n},Z:function(){return this.eB(_mcp.b.bb)},dY:function(n){this.eA(_mcp.b.bb,n);return n},ba:function(){return this.eB(_mcp.b.bj)},ec:function(n){this.eA(_mcp.b.bj,n);return n},fN:function(){return this.K()},bP:function(){return this.eB(_mcp.b.bM)},cS:function(n){this.eA(_mcp.b.bM,n);return n},K:function(){return _a.p.a&&(this.o()||this.t())},o:function(){if(!_a.p.a||!_a.p.i()||!this.dF()||_g.a.a().a().bB.AlwaysShowFrom)return!1;var n=_g.a.a().bB.SmimeAdminSettings;return!!n&&n.AlwaysEncrypt||this.eB(_mcp.b.bJ)},eo:function(n){this.eA(_mcp.b.bJ,n);this.ez(_mcp.b.e);_j.e.a(_a.a.k,"Context.SmimeEncryptMessage is set to {0}",n);return n},t:function(){if(!_a.p.a||!_a.p.i()||!this.dF()||_g.a.a().a().bB.AlwaysShowFrom)return!1;var n=_g.a.a().bB.SmimeAdminSettings;return!!n&&n.AlwaysSign||this.eB(_mcp.b.bN)},eq:function(n){this.eA(_mcp.b.bN,n);this.ez(_mcp.b.e);_j.e.a(_a.a.k,"Context.SmimeSignMessage is set to {0}",n);return n},dz:function(){return _g.a.a().bB.SmimeAdminSettings&&(_g.a.a().bB.SmimeAdminSettings.AlwaysEncrypt||_g.a.a().a().bB.AlwaysShowFrom)||this.z()?!1:!0},dA:function(){return _g.a.a().bB.SmimeAdminSettings&&(_g.a.a().bB.SmimeAdminSettings.AlwaysSign||_g.a.a().a().bB.AlwaysShowFrom)||this.z()?!1:!0},fg:0,bi:function(){return this.eB(_mcp.b.B)},fy:function(n){this.eA(_mcp.b.B,n);return n},du:function(){return this.eB(_mcp.b.bt)},fV:function(n){this.eA(_mcp.b.bt,n);return n},bJ:function(){if(this.br()||_y.c.a.i()||this.K())return!1;var n=this.F();return!n||!!n.a()||n.b()},bI:function(){return _a.g.b?!1:this.a()!==8&&!this.R()},eY:function(){return this.eB(_mcp.b.bi)},ho:function(n){this.eA(_mcp.b.bi,n);return n},fu:!1,fZ:!1,bn:function(){return this.fZ},R:function(){return this.a()===11||this.a()===12||this.a()===13},bB:function(){return this.eB(_mcp.b.bx)},x:function(n){this.eA(_mcp.b.bx,n);return n},fk:function(){return this.eB(_mcp.b.bw)},bc:function(n){this.eA(_mcp.b.bw,n);return n},gS:function(){return this.eB(_mcp.b.bY)},bd:function(n){this.eA(_mcp.b.bY,n);return n},dx:function(){return this.eB(_mcp.b.bB)},ek:function(n){this.eA(_mcp.b.bB,n);return n},Q:function(){return this.eB(_mcp.b.j)},dS:function(n){this.eA(_mcp.b.j,n);return n},bl:function(){return this.eB(_mcp.b.bh)},eb:function(n){this.eA(_mcp.b.bh,n);return n},dn:function(){return this.eB(_mcp.b.bn)},ed:function(n){this.eA(_mcp.b.bn,n);return n},cs:function(){return this.eB(_mcp.b.S)},gs:function(n){this.eA(_mcp.b.S,n);return n},gP:function(){return this.eB(_mcp.b.bF)},hp:function(n){this.eA(_mcp.b.bF,n);return n},cz:function(){this.fA||(this.fA=this.bS());return this.fA},cW:function(){return this.eB(_mcp.b.by)},cj:function(n){this.eA(_mcp.b.by,n);return n},bC:function(){return this.eB(_mcp.b.C)},cF:function(n){this.eA(_mcp.b.C,n);return n},bk:function(){if(this.Q()){var n=_g.c.a(this.Q().d(),_g.c.c());return!!n&&n.bB.Value.toUpperCase()==="TRUE"}return!1},cd:function(n){_j.e.a(_a.a.a,"Setting IsOmeRequested to {0}",n);this.hv(n);return n},bL:function(){if(!this.Q())return null;var n=_g.c.a(this.Q().d(),_g.c.b());if(n&&n.bB.Value){var i=n.bB.Value;var t=_a.d.b(i);t||_j.e.c(_a.a.T,"Attempt to get OME expiration time but value in extended property cannot be parsed into a datetime object.  Value: {0}",i);return t}else return null},cO:function(n){_j.e.a(_a.a.a,"Setting OmeTimeExpiration to {0}",n);this.hw(n?_a.d.w(n):"");return n},gO:function(){return this.a()===1||this.a()===2||this.fr===1},fh:null,cw:function(){return this.fh},ef:function(n){this.fh=n;return n},fi:null,ej:function(n){this.fi=n;return n},eP:null,dv:function(){return this.eP},dp:function(){return _cmc.h.c(_g.co,this.eP,_cmc.c.b,null)},eT:null,cx:function(){return this.eT},dd:function(){return _cmc.a.f(this.eT,this.fs,!0)},fs:null,fm:null,dg:function(){return this.fm},dL:function(n){this.fm=n;return n},fr:0,dh:function(){return this.fr},fj:!1,bR:function(){return this.fj},es:function(n){this.fj=n;return n},fE:!1,dq:function(){return this.fE},fH:null,ds:function(){return this.fH},fF:null,dr:function(){return this.fF},fG:null,bK:function(){return this.fG},cl:function(){return this.eB(_mcp.b.bO)},gy:function(n){this.eA(_mcp.b.bO,n);return n},ck:function(){return this.eB(_mcp.b.L)},gq:function(n){this.eA(_mcp.b.L,n);return n},ew:function(){return this.eB(_mcp.b.bA)},gx:function(n){this.eA(_mcp.b.bA,n);return n},cX:function(){return this.eB(_mcp.b.bk)},gu:function(n){this.eA(_mcp.b.bk,n);return n},cB:function(n){return _dg.l.isInstanceOfType(n)?2:1},hc:function(n){this.p(_mcp.b.cb(_y.eb,n,_mcp.b.l.a,0));this.c(_mcp.b.cb(_y.m,n,_mcp.b.c.a,0));this.e(_mcp.b.ca(n,_mcp.b.m.a,!0));var t=_mcp.b.ca(n,"IsCalendarItem",!1);this.cE(t?1:0);if(n&&"StoreId"in n){this.fe(!1);this.hr(n.StoreId)}this.hd(n);this.cN(0===this.a()||4===this.a())},dC:function(n){_g.cv.isInstanceOfType(n)?this.c(1):_g.cu.isInstanceOfType(n)?this.c(2):_g.cH.isInstanceOfType(n)&&this.c(3);this.gE(n,n.e());this.cf(n.bB.ReferenceItemId);this.eg(n.n());this.H(n.bB.ItemId);this.v(n.bB.Subject);this.r(n.e().bB.Value);this.cH(n.bB.From);this.s(n.m()?n.m().e:null);this.bb(n.p()?n.p().e:null);this.bV(n.x()?n.x().e:null);this.e(!1);this.dV(n.bd());this.fv(n);this.ch(n.bS());this.el(n.cg());this.dY(n.bB.IsDeliveryReceiptRequested);this.ec(n.bB.IsReadReceiptRequested);this.dX(n.bB.InternetMessageId);this.gb(n);this.gm(n);this.cN(!1);this.fe(!0);_j.e.a(_a.a.a,"Initialized context with smart response")},cC:function(n){if(!n)throw Error.argumentNull("message");this.gE(n,n.O());this.dP(n);this.H(n.bB.ItemId);this.v(n.bB.Subject);var u=this.a()===16;u?this.r(n.ca().bB.Value):this.r(n.cG()?n.cG().bB.Value:n.O().bB.Value);this.gW();this.fy(n.bB.ConversationId);if(_g.i.isInstanceOfType(n)){var t=n;this.cH(t.bB.From);this.s(t.m()?t.m().w():null);this.bb(t.p()?t.p().w():null);this.bV(t.x()?t.x().w():null);this.dY(t.bB.IsDeliveryReceiptRequested);this.ec(t.bB.IsReadReceiptRequested);this.dX(t.bB.InternetMessageId);if(t.bB.ParentMessageId){this.cf(t.bB.ParentMessageId);this.fr=t.ec()}n.ds()&&_cmc.h.f(n.ds(),this.eP,this.eT,_mco.g.b);n.cn()&&(this.fs=n.cn())}else if(_g.bk.isInstanceOfType(n)){var f=n;this.cH(f.bB.From)}this.e(!1);this.dV(n.bd());this.fv(n);this.ch(n.bS());this.el(n.cg());n.bS()&&!n.bS().a()?this.i(n.bS().g()):n.cG()?this.i(n.cG().a()):this.i(n.dW()===1?"Text":"HTML");this.fT(_dg.q.isInstanceOfType(n));if(this.br()){var i=n;this.fw(i.E());this.fU(_dg.m.isInstanceOfType(i));i.bB.From&&this.cH(i.bB.From);i.bB.Sender&&this.cQ(i.bB.Sender)}n.cM()&&n.cM().b()?this.U(n.cM()?n.cM().e:null):(!this.eY()||this.m())&&this.U(n.be()?n.be().e:null);if(this.q()&&(u&&n.ca().a()==="Text"||n.O()&&n.O().a()==="Text"))for(var r=0;r<this.q().b();r++)this.q().c(r)&&this.q().c(r).b()&&this.q().c(r).h(!1);this.gm(n);this.cN(!0);this.fe(!0);_j.e.a(_a.a.a,"Initialized context with draft")},dD:function(n,t,i){this.fy(n);this.cf(t.bB.ItemId);this.fn=!0;this.cg(this.P());this.fE=i;if(i){this.fH=t.m().f();this.fF=t.p().f();this.fG=t.bB.Sender.Mailbox}},G:function(n){this.cg(n);this.gY(n)},gl:function(){this.eI("OnAsyncSendCallbackEvent",this)},gW:function(){this.eH("OnInitializingDraftContentEvent")},gX:function(){this.eH("OnPrepareQuotedBodyEvent")},gV:function(){this.eI("BeforeDraftUpdateEvent",this)},gU:function(){this.eI("AfterDraftUpdateEvent",this)},E:function(n){var i=new _g.i;var t;this.gz(i,t={val:n}),n=t.val;return i},by:function(n){var i=new _g.bk;var t;this.gz(i,t={val:n}),n=t.val;return i},dc:function(){var t=this.ge();_a.b.b(this.eR,"GetEditorContentCommand");this.eR.a();var n=this.y();t.a()==="Text"&&(n=_mcp.b.cg(n));t.b(n);this.fg=_j.h.a(n)?0:n.length;_j.e.a(_a.a.a,"MailComposeContext.CreateBodyFromEditor, ContentLength: {0}",this.fg);return t},hu:function(n){var t=this.eN();if(!t||this.X()===t.i()){this.dV(n);t&&t.A(n)}},gf:function(){if(this.eW&&this.fD){this.eR.a();if(this.eN()){_mcp.c.z(this.eN(),this);_j.e.a(_a.a.a,"Updated baseline")}else{this.fo(_mcp.c.b(this));_j.e.a(_a.a.a,"Captured baseline for the first time");if(this.fu&&this.eO){this.eO.r(this.eN().a());this.fu=!1}if(!this.h()||this.eY()&&this.dB()){this.eO=_mcp.c.b(this);_j.e.a(_a.a.a,"Captured initial baseline for context")}}}},gn:function(){if(!this.eN())return!1;this.eR&&this.eR.a();return!this.eN().t(this)},bT:function(n){var t=null;if(this.j()==="HTML"){var r,i;i=_a.A.a(this.y(),r={val:t}),t=r.val,i}else t=this.y();t=t?t.length>n?t.substr(0,n)+"...":t:"";return t},fb:function(n,t,i,r,u){this.s(new _j.l);var f=n?n.Mailbox:null;this.a()!==8&&this.dW(!0);if(f&&_mcp.b.bZ(f.EmailAddress)){var l;var c;if(this.a()===1&&(l=t?t.b():0)+(c=i?i.b():0)+(r?r.b():0)===1){this.dW(!1);l===1?this.f().a(t.c(0)):c===1?this.f().a(i.c(0)):this.f().a(r.c(0))}else this.a()===2&&this.dW(!1)}if(this.a()===8&&this.gg()||this.a()!==8&&(!u||!u.b())&&f&&this.gg()){this.f().a(f);_j.e.a(_a.a.a,"Adding original From to To, Operation = {0}; From= {1}; Self= {2}",this.a(),_g.n.m(n),_mcp.b.a())}if(this.a()===2||this.a()===8){_j.e.a(_a.a.a,"Adding {0} To recipients to To.",t?t.b():0);this.fI(t,this.f(),f,null);_j.e.a(_a.a.a,"Adding {0} Cc recipients to Cc.",i?i.b():0);this.bb(new _j.l);this.fI(i,this.k(),f,this.f());_j.e.a(_a.a.a,"Adding {0} Bcc recipients to Bcc.",r?r.b():0);this.bV(new _j.l);this.fI(r,this.b(),f,this.f())}if(u&&u.b()>0)if(this.a()===1){this.f().g();for(var e=0;e<u.b();e++){var a=u.c(e);this.f().a(a)}}else if(this.a()===2)for(var o=0;o<u.b();o++){var s=u.c(o);var v=this;if(this.f().b()===this.f().j(function(n){return _g.n.a(s,n)})){var y=this;var h=this.k().j(function(n){return _g.n.a(s,n)});h!==this.k().b()&&this.k().n(h);this.f().a(s)}}if(this.a()!==8&&f&&0===this.f().b()&&(!this.k()||0===this.k().b())){this.f().a(f);_j.e.a(_a.a.a,"Adding original From since there are no recipients left, From = {0}",_g.n.m(n))}this.ga()},dH:function(){_j.e.a(_a.a.a,"Context reset start.");this.fW(null);this.eR=null;this.a()&&this.c(0);this.l()&&this.p(0);this.A()&&this.cf(null);this.g()&&this.cg(null);this.h()&&this.H(null);_j.h.a(this.I())||this.v(null);_j.h.a(this.y())||this.r("");this.f()&&this.s(null);_j.h.a(this.bo())||this.cT(null);this.k()&&this.bb(null);_j.h.a(this.bh())||this.dK(null);this.b()&&this.bV(null);_j.h.a(this.N())||this.dJ(null);this.gj()||this.e(!0);this.X()!=="Normal"&&this.dV("Normal");_j.h.a(this.dw())||this.fl(null);this.gh()&&this.fe(!1);this.br()&&this.fT(!1);this.bj()&&this.fU(!1);this.dm()&&this.gv(!1);this.fx()&&this.gw(null);this.bF()&&this.gr(!1);this.dk()&&this.dX(null);this.cl()&&this.gy(null);this.ck()&&this.gq(null);this.ew()&&this.gx(null);this.cX()&&this.gu(!1);this.n()&&this.cH(null);this.bt()&&this.cQ(null);this.m()&&this.cN(!1);this.z()&&this.ea(!1);this.ct()&&this.fz(!1);this.Y()&&this.cb(!1);this.q()&&this.U(null);this.bz()&&this.dI(null);this.L()&&this.et(!1);this.eN()&&this.fo(null);this.bE()&&this.fR(!1);this.cr()&&this.dU(!1);this.bm()&&this.ce(!1);this.P()&&this.dP(null);this.F()&&this.ch(null);_j.h.a(this.w())||this.bZ(null);this.bp()&&this.cc(!1);_j.h.a(this.de())||this.bY(null);_j.h.a(this.cn())||this.bW(null);_j.h.a(this.co())||this.bX(null);this.df()&&this.gp(!1);this.C()!=="Normal"&&this.el("Normal");this.Z()&&this.dY(!1);this.ba()&&this.ec(!1);this.o()&&this.eo(!1);this.t()&&this.eq(!1);this.gk()&&this.ep(null);this.bi()&&this.fy(null);_j.h.a(this.du())||this.fV(null);this.cm()&&this.cE(0);this.cv()&&this.cM(!1);this.bH()&&this.fS(!1);this.gi()&&this.cL(!1);this.Q()&&this.dS(null);this.fj&&(this.fj=!1);if(this.bB()){_y.j.a(this.bB(),null,"ContextReset",null,null);this.x(null)}_j.e.a(_a.a.a,"Context reset end.")},dE:function(){return!!this.g().bS()&&0===this.g().bS().a()&&!this.g().bS().j()&&!this.g().bS().l()},bv:function(){var n=null;if(this.n()&&this.n().Mailbox&&!_j.h.a(this.n().Mailbox.EmailAddress))n=this.n().Mailbox;else if(this.bt()&&this.bt().Mailbox&&!_j.h.a(this.bt().Mailbox.EmailAddress))n=this.bt().Mailbox;else if(!_j.h.a(_mcp.b.a())){n=new _g.f;n.EmailAddress=_mcp.b.a();n.Name=_mcp.b.ce();n.MailboxType="Mailbox";n.RoutingType="SMTP"}return n},dF:function(){if(!_a.p.a||_a.p.o)return!1;switch(this.a()){case 0:case 1:case 2:case 3:case 4:break;default:return!1}return this.P()&&!this.fO(this.P())?!1:this.g()&&!this.fO(this.g())?!1:_j.h.a(this.bC())?!0:!1},fO:function(n){if(_j.h.a(n.bB.ItemClass)||n.bB.ItemClass==="IPM.Note"||n.bx())return!0;else{var i=this.a()===1||this.a()===2;var t=i||this.a()===3;return i&&(n.bB.ItemClass.startsWith("IPM.Schedule.Meeting")||n.bB.ItemClass.startsWith("IPM.Appointment"))?!0:t&&n.bB.ItemClass.startsWith("REPORT.IPM.Note")?!0:t&&n.bB.ItemClass.startsWith("IPM.Note.Rules")?!0:t&&n.bB.ItemClass==="IPM.Post"?!0:!1}},cV:function(n){_j.e.a(_a.a.k,"Updating S/MIME options...");if(_a.p.a)switch(n){case 6:this.eo(!0);this.eq(!1);break;case 10:case 11:this.eo(!1);this.eq(!0);break;case 12:case 13:case 14:this.eo(!0);this.eq(!0);break;case-1:case 0:default:this.eo(!1);this.eq(!1);break}},hx:function(n){_j.e.a(_a.a.k,"Upgrading S/MIME options...");if(_a.p.a)switch(n){case 6:this.eo(!0);break;case 10:case 11:this.eq(!0);break;case 12:case 13:case 14:this.eo(!0);this.eq(!0);break;case-1:case 0:default:break}},bw:function(){if(this.bB()){var t=!1;var n=this;this.fP=function(i){if(!t&&n.bB()){_y.j.a(n.bB(),null,i);n.x(null);t=!0}}}},bS:function(n,t){var i=this.gk();if(!i||!i.length)return null;_j.B.a(n)&&(n=0);_j.B.a(t)&&(t=i.length);for(var r=new _j.q,h=n;h<n+t;h++){var s=i[h];if(s&&s.length)for(var a=s,v=a.length,f=0;f<v;++f){var u=a[f];_j.h.a(u)||r.g(u)||r.c(u)}}if(n+t<i.length){var o=i[i.length-1];if(o&&o.length>0)for(var l=o,y=l.length,e=0;e<y;++e){var c=l[e];_j.h.a(c)||r.g(c)||r.c(c)}}return r.d.length>0?r.d:null},gz:function(n,t){t.val=!!t.val!==t.val?!1:t.val;n.da(this.I());n.dY(this.X());n.bZ(this.h());n.bm(new(_a.fC.$$(_g.Attachment,_g.bn)));if(this.K()){var s=_g.a.a().bB.SmimeAdminSettings.ClearSign;n.fy(this.o()?"IPM.Note.SMIME":s?"IPM.Note.SMIME.MultipartSigned":"IPM.Note.SMIME");n.bB.ItemClass==="IPM.Note.SMIME.MultipartSigned"?n.cI(this.gd(t.val)):n.cI(new _g.w(new _g.s(this.j(),"")));var o=_a.bi.a(this.gQ());n.iF(new _g.ez(o))}else{n.cI(this.gd(t.val));(this.P()&&this.P().bx()||this.g()&&this.g().bx())&&n.fy("IPM.Note");this.q()&&n.be().j(this.q().d())}n.iK(this.F());n.dN(this.C());n.fx(this.bp());n.ft(this.cn());n.fu(this.co());n.fv(this.de());n.gV(this.cq());n.gU(this.cp());n.gT(this.gL());n.ix(this.gM());if(this.Q()){n.gg(new(_a.fC.$$(_g.bj,_g.U)));n.bV().j(this.Q().d())}if(_g.i.isInstanceOfType(n)){var i=n;i.cC(this.n());_cmc.c.e(i.O().bB.Value,i.bB.Subject,this.eP);_cmc.a.e(i.O().bB.Value,i.bB.Subject,this.eT);var e=_cmc.c.d(i.O().bB.Value,i.bB.Subject,this.eP);i.ge(e);this.hf(e);_cmc.h.b(i,this.eP,this.dp(),this.eT,this.dd());if(this.K()&&this.fc){if(this.fc===1){i.ch(new _a.k);this.f()&&i.m().j(this.f().d());i.cj(new _a.k);this.k()&&i.p().j(this.k().d())}else if(this.fc===2){i.cu(new _a.k);this.b()&&i.x().c(this.b().c(this.fp))}else if(this.fc===3){i.cu(new _a.k);this.b()&&i.x().j(this.b().d())}}else{i.ch(new _a.k);this.f()&&i.m().j(this.f().d());i.cj(new _a.k);this.k()&&i.p().j(this.k().d());i.cu(new _a.k);this.b()&&i.x().j(this.b().d())}i.cQ(this.Z());i.cU(this.ba());i.eh(this.o());i.el(this.t());this.dk()&&i.cP(this.dk())}else{var u=n;u.cN(this.bM());var f=_g.a.a().c();var r=null;r=_j.h.a(f.bB.LogonEmailAddress)?null!==this.n()&&this.n().Mailbox?this.n().Mailbox.EmailAddress:_mco.a.g(null)||f.bB.UserEmailAddress:f.bB.LogonEmailAddress;if(r){u.g(new _g.N);u.bB.From.Mailbox=new _g.f;u.bB.From.Mailbox.EmailAddress=r}}},hf:function(n){if(n){var r="AtAllMention_Mail_";r=r+(this.eS?"Group_":"ME_");var h=_y.m.toString(this.a());var e=new _a.bq(1,r+h);_a.z.b.a(e);for(var t=this.f(),i=!1,u=0;u<t.b();u++)if(t.c(u).MailboxType==="GroupMailbox"){i=!0;break}if(!i){t=this.k();for(var f=0;f<t.b();f++)if(t.c(f).MailboxType==="GroupMailbox"){i=!0;break}}if(!i){t=this.b();for(var o=0;o<t.b();o++)if(t.c(o).MailboxType==="GroupMailbox"){i=!0;break}}var s="MsgHasAtleastAGroup_";i||(s="MsgHasNoGroup_");e=new _a.bq(1,r+s+h);_a.z.b.a(e)}},fI:function(n,t,i,r){if(n)for(var f=0;f<n.b();f++){var u=n.c(f);if(_g.n.a(u,i)){_j.e.a(_a.a.a,"Excluding original from {0}",i);continue}if(_mcp.b.bZ(u.EmailAddress)||this.he(u.EmailAddress)){_j.e.a(_a.a.a,"Excluding self address {0}",_mcp.b.a()||"null");continue}var e=this;if(r&&r.b()!==r.j(function(n){return _g.n.a(u,n)})){_j.e.a(_a.a.a,"Excluding address {0} already in to",u);continue}t.a(u)}},he:function(n){var t=this.n();return!!t&&!!t.Mailbox&&t.Mailbox.EmailAddress===n},gK:function(n,t){this.ez("ShowMeetingReadonlyFields")},hd:function(n){var t=this.hg(n);switch(this.a()){case 0:case 4:this.H(t);break;case 1:case 2:case 3:this.cf(t);break}},gm:function(n){if(n.bV()){this.dS(new _j.l);this.Q().m(n.bV().f())}},hg:function(n){var t=null;if(n&&"Id"in n){t=new _g.e(n.Id);"ChangeKey"in n&&(t.ChangeKey=n.ChangeKey)}return t},gE:function(n,t){0===n.dW()&&n.gk(t&&t.a()==="Text"?1:3)},hb:function(n){var r=_mco.a.g(n);if(r){this.cH(new _g.N);this.n().Mailbox=new _g.f;this.n().Mailbox.EmailAddress=r}this.cE(0);switch(this.a()){case 1:case 2:case 12:this.fv(n);if(_g.i.isInstanceOfType(n)){var t=n;t.A()?this.fb(t.bB.From||t.bB.Sender,null,null,null,null):this.fb(t.bB.From||t.bB.Sender,t.m()?t.m().e:null,t.p()?t.p().e:null,t.x()?t.x().e:null,t.dm()?t.dm().e:null);this.gv(this.a()===2&&n.ip()&&!t.bB.IsGroupEscalationMessage);this.eg(n.eP())}else if(_g.bk.isInstanceOfType(n)){var i=n;this.fb(i.bB.From||i.bB.Sender,null,null,null,null)}this.fQ(n);break;case 3:_dg.q.isInstanceOfType(n)||this.fv(n);this.eg(n.eP());this.ga();this.fQ(n);this.hl(n);break;case 9:case 10:_g.i.isInstanceOfType(n)?this.fb(n.bB.Sender,null,null,null,null):_g.bk.isInstanceOfType(n)&&this.fb(n.bB.Sender,null,null,null,null);this.fQ(n);break;case 5:case 6:case 7:default:this.gC();break}_j.e.a(_a.a.a,"Initialized context with original email message")},gY:function(n){this.cf(n.bB.ItemId);var i=this.dE();this.ch(i?null:n.bS());this.ht(n.db());this.el(n.cg());this.r(this.y()||"");this.gb(n);if(!this.m()){this.cN(!(this.a()===1||this.a()===2||this.a()===3||this.a()===12));this.a()!==3||_a.p.a&&n.bx()||i||this.F()&&this.F().a()||this.U(n.be()?n.be().e:null)}if(_dg.ICalendaring.isInstanceOfType(n)){var t=n;t.bq();this.ha(t)}else if(_g.i.isInstanceOfType(n)||_g.bk.isInstanceOfType(n)){if(3===this.a()&&!this.m()){this.dV(n.bd());_j.e.a(_a.a.a,"Setting importance to {0} since we are forwarding item {1} with that importance",this.X(),_h.bb.a(n.bB.ItemId))}this.hb(n)}else throw Error.invalidOperation(String.format("Original item of type {0} is not supported.",Object.getType(n).getName()));this.gD();_g.i.isInstanceOfType(n)&&n.ce?this.fe(!1):this.fe(!0)},gb:function(n){n.cG()&&this.i(n.cG().a())},gT:function(n){var t=null;_dg.s.isInstanceOfType(n)||_dg.p.isInstanceOfType(n)?t=n.bB.From:n.w()?t=n.w():_j.e.c(_a.a.a,"ICalendaring doesnt have an organizer");return t},gD:function(){var n=new _j.q;this.bj()&&n.h(_dg.m.a(this.q()));if(this.eV&&_a.p.a&&this.eV.bx()&&this.eV.ej()){var t=this.eV.be().a(0).bB.AttachmentId.Id;n.c(t)}this.hm(n.i())},ha:function(n){this.cE(this.cB(n));var u=this.gT(n);var t;var r;if(_dg.s.isInstanceOfType(n)||_dg.p.isInstanceOfType(n)){t=n.m()?_g.n.g(n.m().e):null;r=n.p()?_g.n.g(n.p().e):null}else{t=n.s()?_g.n.g(_dg.e.d(n.s().e)):null;r=n.v()?_g.n.g(_dg.e.d(n.v().e)):null}if(_dg.l.isInstanceOfType(n)){var i=n;if(!_j.h.a(i.bB.CustomerEmail)&&_a.K.a(i.bB.CustomerEmail)){var f=new _g.f;f.EmailAddress=i.bB.CustomerEmail;f.Name=_j.h.b(i.bB.CustomerName)?i.bB.CustomerEmail:i.bB.CustomerName;t.a(f)}}switch(this.a()){case 1:case 2:this.fb(u,t,r,null,null);break;case 5:case 6:case 7:this.fb(u,t,r,null,null);this.fw(n);this.gt(!0);break;case 8:var e=n.s().t();e.j(n.L().f());t=_g.n.g(_dg.e.d(e.e));this.fb(u,t,r,null,null);this.fw(n);this.gt(!0);break;case 3:if(_dg.m.isInstanceOfType(n)||_dg.a.isInstanceOfType(n)){this.fU(!0);this.cH(u);this.fw(n)}break;default:this.gC();break}this.fT(!0);_j.e.a(_a.a.a,"Initialized context from original calendar item")},fw:function(n){this.gJ(n);this.gw(n.u());this.gr(!!this.fx()&&!_j.h.a(this.fx().bB.DisplayName))},ht:function(n){var t="";switch(this.a()){case 1:case 2:case 12:t=_u.n.NL;break;case 3:t=_nbs.a.ar;break;case 5:t=_nbs.a.Ws;break;case 6:t=_nbs.a.jP;break;case 7:t=_nbs.a.gl;break;case 8:t=_nbs.a.Tj;break;case 9:t=_nbs.a.qL;break;case 10:t=_nbs.a.Oc;break}var i=String.format(_nbs.a.lN,t,n);_j.e.a(_a.a.a,"Formatted subject with Prefix = {0}; Operation = {1}",t,this.a());if(255<i.length){this.v(i.substr(0,255));_j.e.a(_a.a.a,"Truncated subject from {0} to {1} to meet the {2} characters rule.",i,this.I(),255)}else this.v(i)},fQ:function(n){this.fy(n.bB.ConversationId);_g.i.isInstanceOfType(n)?this.fV(n.bB.InternetMessageId):_g.bk.isInstanceOfType(n)&&this.fV(n.bB.InternetMessageId)},gC:function(){var n=_j.t.c(_y.m,this.a());throw Error.invalidOperation(String.format("Cannot perform operation {0} with original item.",n));},fv:function(n){this.cc(n.dU());this.bY(n.eN());this.bW(n.eu());this.bX(n.ev());this.gp(n.id())},gd:function(n){return n?this.ge():this.dc()},ge:function(){var n=new _g.w(new _g.s("HTML",""));n.b("");if(4!==this.a()&&13!==this.a()||this.dx()){_j.e.a(_a.a.a,"Create new body for action email message, setting body type to context body type: {0}",this.j());n.c(this.j())}else{_j.e.a(_a.a.a,"Create new body for action email message, setting body type to text due to lack of support for RichTextEditor.");n.c("Text")}return n},ga:function(){if(_y.c.a.i()){var n=this.bv();if(n){if(!this.go(this.f(),n.EmailAddress)&&!this.go(this.k(),n.EmailAddress)){this.k()||this.bb(new _j.l);this.k().a(n);_j.e.a(_a.a.a,"Adding self to CC")}}else _j.e.c(_a.a.a,"Could not add self to CC as the address was missing")}},go:function(n,t){if(n)for(var i=0;i<n.b();i++){var r=n.c(i);if(t.toLowerCase()===r.EmailAddress.toLowerCase())return!0}return!1},hv:function(n){var t=null;if(n){this.Q()?t=_g.c.a(this.Q().d(),_g.c.c()):this.dS(new _j.l);if(!t){var i=new _g.U;i.ExtendedFieldURI=_g.c.c();t=new _g.bj(i);this.Q().a(t)}t.b("True")}else{if(!this.Q())return;t=_g.c.a(this.Q().d(),_g.c.c());t&&t.b("False")}},gJ:function(n){this.gy(n.c());this.gq(n.e());this.gx(n.G());this.gu(n.P())},hw:function(n){var t=null;if(_j.h.a(n)){if(!this.Q())return;t=_g.c.a(this.Q().d(),_g.c.b());if(t){t.b(undefined);this.Q().p(t,!0)}}else{this.Q()?t=_g.c.a(this.Q().d(),_g.c.b()):this.dS(new _j.l);if(!t){var i=new _g.U;i.ExtendedFieldURI=_g.c.b();t=new _g.bj(i);this.Q().a(t)}t.b(n)}},hl:function(n){if(_a.g.b){var t=n.bV()?_g.c.a(n.bV().f(),_g.c.b()):null;t&&this.cO(_a.d.b(t.bB.Value))}}};_mcp.H=function(n,t,i){_j.s.a(n,"mailComposeContextAsyncFactory");_j.s.a(t,"mailComposeConductorSelector");_j.s.a(i,"urlParameters");this.m=n;this.l=t;this.n=i};_mcp.H.a=function(n,t,i,r){r.val=null;var u=n.a[t];if(_j.h.b(u))return!1;else{r.val=i?u.replace(_a.w.l," "):u;return!0}};_mcp.H.prototype={h:0,c:function(n){this.h=n;return n},i:null,e:function(n){this.i=n;return n},k:!1,d:function(n){this.k=n;return n},j:null,f:function(n){this.j=n;return n},m:null,l:null,n:null,a:function(n){var t=this;this.m.a(function(n){var i=n.a(!1,!0);i.p(t.h);i.c(0);t.g(i,t.i,t.n);var u=t.j?t.j.g:null;var f=t.l.a(u,t.h,u?u.n():0,null);f.a(i);var r=new _a.l;r.b("pid",i.dg());r.c("f",t.k);t.i.j=r.toString();_a.c.a(t.i)});return this.h===3},g:function(n,t,i){try{var r=null;var c,h;(h=_mcp.H.a(i,"subject",!0,c={val:r}),r=c.val,h)&&n.v(r);var a,l;if(l=_mcp.H.a(i,"body",!0,a={val:r}),r=a.val,l){n.r(_a.A.b(r,!0,!0));n.i("HTML")}var s,f;(f=_mcp.H.a(i,"to",!1,s={val:r}),r=s.val,f)&&n.cT(r);var u,o;(o=_mcp.H.a(i,"pid",!1,u={val:r}),r=u.val,o)&&n.dL(r)}catch(v){var e="Could not parse optional deep-link parameters.";_j.e.d(_a.a.a,v,e);t.m=e;t.k=Object.getType(v).getName();return}}};_mcp.C=function(n){this.e={};this.f=n};_mcp.C.prototype={f:null,a:function(n){return n in this.e},d:function(n,t){if(n in this.e){var i=this.e[n];!i.a&&t&&(this.e[n]=new _mcp.bb(t))}else this.e[n]=new _mcp.bb(t)},g:function(n,t){var u=n.a;var r=u.Z;var i=r.d();var o=r.h();var f=!1;if(r.bH())_j.e.a(_a.a.a,"Not discarding a loaded draft for context {0}",i);else if(r.bE())_j.e.a(_a.a.a,"Not discarding an explicitly saved draft for context {0}",i);else if(u.bj().f())_j.e.a(_a.a.a,"Not discarding a draft currently being explicitly saved for context {0}",i);else if(u.bg().b())_j.e.a(_a.a.a,"Not discarding a draft currently being sent for context {0}",i);else{var e=!1;if(t)_j.e.a(_a.a.a,"Skipping dirty check for context {0}",i);else{_j.e.a(_a.a.a,"Checking dirty for determining whether to discard unused message on navigate away.");e=u.bX()}if(e)_j.e.a(_a.a.a,"Not discarding a dirty draft for context {0}",i);else if(r.eO)if(r.eO.s(r.eN())){if(_g.k.b&&r.bm()&&!r.h()){_j.e.a(_a.a.a,"Calling main window to remember the pending discard for context {0}",i);_g.k.b.ka(i,!r.bE());f=!0}else if(!r.R()){_j.e.a(_a.a.a,"Discarding unused draft for context {0}",i);this.b(i,o,u.bo,r.bE());f=!0}}else _j.e.a(_a.a.a,"Not discarding a draft different from the initial baseline for context {0}",i);else _j.e.a(_a.a.a,"Not discarding without an initial baseline for context {0}",i)}return f},b:function(n,t,i,r){i||(i=new _mcp.Y(new _bc.b));var u;if(this.e[n]){var e=this.e[n];u=e.a}else u=!r;if(t){var f=this.f.b(t,u);i.a(f,null,null,null);delete this.e[n];_j.e.a(_a.a.a,"Delete action submitted, ID={0}, Changekey={1}, isHardDelete={2}",t.Id,t.ChangeKey,u)}else{this.e[n]=new _mcp.bb(u);_j.e.a(_a.a.a,"Discard pending because we do not have the draft ID yet. ContextId={0}; Hard={1}",n,u)}},c:function(n,t){this.b(n,t,new _mcp.Y(new _bc.b),!1)}};_mcp.c=function(){_mcp.c.initializeBase(this)};_mcp.c.$$cctor=function(){_mcp.c.h.b(_mcp.c.f);_mcp.c.e.b(_mcp.c.f);_mcp.c.d.b(_mcp.c.f);_mcp.c.c.b(new _a.bx(_g.Attachment));_mcp.c.g.b(new _a.bx(_g.bj))};_mcp.c.b=function(n){var t=new _mcp.c;_mcp.c.z(t,n);return t};_mcp.c.z=function(n,t){n.K(t.u());n.r(t.y());if(t.f()){n.B(new _j.l);n.e().m(t.f().d())}else n.B(null);n.L(t.bo());if(t.k()){n.x(new _j.l);n.d().m(t.k().d())}else n.x(null);n.D(t.bh());if(t.b()){n.w(new _j.l);n.c().m(t.b().d())}else n.w(null);if(t.q()){n.p(new _j.l);n.b().m(t.q().d())}else n.p(null);if(t.Q()){n.y(new _j.l);n.q().m(t.Q().d())}else n.y(null);n.C(t.N());n.A(t.X());n.z(t.n());n.E(t.w());n.H(t.C());n.F(t.Z());n.G(t.ba());n.I(t.o());n.J(t.t())};_mcp.c.a=function(n,t,i,r){if(i!==r&&!(_j.h.a(i)&&_j.h.a(r))||!_mcp.c.x(n,t))return!1;if(!n||!t)return!0;for(var u=0;u<n.b();u++){var e=n.c(u);var f=t.c(u);if(!_mcp.c.i(e,f))return!1}return!0};_mcp.c.i=function(n,t){return!n&&t||!t&&n?!1:!n&&!t?!0:_g.n.a(n,t)};_mcp.c.x=function(n,t){var r=_mcp.c.y(n);var i=_mcp.c.y(t);return r===i};_mcp.c.y=function(n){return n?n.b():0};_mcp.c.w=function(n,t){if(!_mcp.c.x(n,t))return!1;if(!n||!t)return!0;for(var i=0;i<n.b();i++){var u=n.c(i);var r=t.c(i);if(!_mcp.c.B(u,r))return!1}return!0};_mcp.c.A=function(n,t){return _db.by.a(n,t)};_mcp.c.B=function(n,t){return!n&&t||!t&&n?!1:!n&&!t?!0:!n.bB.AttachmentId&&t.bB.AttachmentId||!t.bB.AttachmentId&&n.bB.AttachmentId?!1:n.bB.AttachmentId&&n.bB.AttachmentId.Id!==t.bB.AttachmentId.Id?!1:n.bB.Name!==t.bB.Name?!1:n.bB.ContentType!==t.bB.ContentType?!1:n.bB.ContentId!==t.bB.ContentId?!1:n.bB.ContentLocation!==t.bB.ContentLocation?!1:n.a()!==t.a()?!1:!n.m()&&t.m()||!t.m()&&n.m()?!1:n.m()&&!n.m().B(t.m())?!1:n.b()!==t.b()?!1:!0};_mcp.c.prototype={f:function(){return this.eB(_mcp.c.u)},K:function(n){this.eA(_mcp.c.u,n);return n},a:function(){return this.eB(_mcp.c.m)},r:function(n){this.eA(_mcp.c.m,n);return n},e:function(){return this.eB(_mcp.c.h)},B:function(n){this.eA(_mcp.c.h,n);return n},j:function(){return this.eB(_mcp.c.v)},L:function(n){this.eA(_mcp.c.v,n);return n},d:function(){return this.eB(_mcp.c.e)},x:function(n){this.eA(_mcp.c.e,n);return n},h:function(){return this.eB(_mcp.c.k)},D:function(n){this.eA(_mcp.c.k,n);return n},c:function(){return this.eB(_mcp.c.d)},w:function(n){this.eA(_mcp.c.d,n);return n},g:function(){return this.eB(_mcp.c.j)},C:function(n){this.eA(_mcp.c.j,n);return n},i:function(){return this.eB(_mcp.c.o)},A:function(n){this.eA(_mcp.c.o,n);return n},l:function(){return this.eB(_mcp.c.n)},z:function(n){this.eA(_mcp.c.n,n);return n},k:function(){return this.eB(_mcp.c.l)},E:function(n){this.eA(_mcp.c.l,n);return n},o:function(){return this.eB(_mcp.c.r)},H:function(n){this.eA(_mcp.c.r,n);return n},m:function(){return this.eB(_mcp.c.p)},F:function(n){this.eA(_mcp.c.p,n);return n},n:function(){return this.eB(_mcp.c.q)},G:function(n){this.eA(_mcp.c.q,n);return n},u:function(){return this.eB(_mcp.c.s)},I:function(n){this.eA(_mcp.c.s,n);return n},v:function(){return this.eB(_mcp.c.t)},J:function(n){this.eA(_mcp.c.t,n);return n},b:function(){return this.eB(_mcp.c.c)},p:function(n){this.eA(_mcp.c.c,n);return n},q:function(){return this.eB(_mcp.c.g)},y:function(n){this.eA(_mcp.c.g,n);return n},t:function(n){if(this.i()!==n.X()){_j.e.a(_a.a.a,"Dirty due to importance: snapshotImportance={0}, contextImportance={1}",this.i(),n.X());return!1}if(this.f()!==n.u()){_j.e.a(_a.a.a,"Dirty due to subject: snapshotSubjectLength={0}, contextSubjectLength={1}",this.f()?this.f().length:0,n.u()?n.u().length:0);return!1}if(this.k()!==n.w()){_j.e.a(_a.a.a,"Dirty due to compliance ID: snapshotId={0}, contextId={1}",this.k(),n.w());return!1}if(this.o()!==n.C()){_j.e.a(_a.a.a,"Dirty due to sensitivity: snapshot={0}, context={1}",this.o(),n.C());return!1}if(this.m()!==n.Z()){_j.e.a(_a.a.a,"Dirty due to IsDeliveryReceiptRequested: snapshot={0}, context={1}",this.m(),n.Z());return!1}if(this.n()!==n.ba()){_j.e.a(_a.a.a,"Dirty due to IsReadReceiptRequested: snapshot={0}, context={1}",this.n(),n.ba());return!1}if(this.u()!==n.o()){_j.e.a(_a.a.a,"Dirty due to SmimeEncryptMessage: snapshot={0}, context={1}",this.u(),n.o());return!1}if(this.v()!==n.t()){_j.e.a(_a.a.a,"Dirty due to SmimeSignMessage: snapshot={0}, context={1}",this.v(),n.t());return!1}var i=this.l()?this.l().Mailbox:null;var t=n.n()?n.n().Mailbox:null;if(!_mcp.c.i(i,t)){_j.e.a(_a.a.a,"Dirty due to From: snapshotFrom={0}, contextFrom={1}",i?i.EmailAddress:"null",t?t.EmailAddress:"null");return!1}if(!_mcp.c.a(this.e(),n.f(),this.j(),n.bo())){_j.e.a(_a.a.a,"Dirty due to To: snapshotToCout={0}, contextToCout={1}, snapshotQueryStringLength={2}, contextQueryStringLength={3}",this.e()?this.e().x.length:0,n.f()?n.f().b():0,this.j()?this.j().length:0,n.bo()?n.bo().length:0);return!1}if(!_mcp.c.a(this.d(),n.k(),this.h(),n.bh())){_j.e.a(_a.a.a,"Dirty due to To: snapshotCcCout={0}, contextCcCout={1}, snapshotQueryStringLength={2}, contextQueryStringLength={3}",this.d()?this.d().x.length:0,n.k()?n.k().b():0,this.h()?this.h().length:0,n.bh()?n.bh().length:0);return!1}if(!_mcp.c.a(this.c(),n.b(),this.g(),n.N())){_j.e.a(_a.a.a,"Dirty due to To: snapshotBccCout={0}, contextBccCout={1}, snapshotQueryStringLength={2}, contextQueryStringLength={3}",this.c()?this.c().x.length:0,n.b()?n.b().b():0,this.g()?this.g().length:0,n.N()?n.N().length:0);return!1}if(!_mcp.c.w(this.b(),n.q())){_j.e.a(_a.a.a,"snapshotAttachmentCount="+(this.b()?this.b().b():0)+", contextAttachmentCount="+(n.q()?n.q().b():0));return!1}if(!_mcp.c.A(this.q(),n.Q())){_j.e.a(_a.a.a,"snapshotExtendedPropertyCount="+(this.q()?this.q().x.length:0)+", contextExtendedPropertyCount="+(n.Q()?n.Q().x.length:0));return!1}if(this.a()!==n.y()){_j.e.a(_a.a.a,"Dirty due to editor content: snapshotContentLength={0}, contextContentLength={1}",this.a()?this.a().length:0,n.y()?n.y().length:0);return!1}_j.e.a(_a.a.a,"Context is clean");return!0},s:function(n){if(!n){_j.e.a(_a.a.a,"Comparing with a null snapshot, this case is always considered equal.");return!0}if(this.i()!==n.i()){_j.e.a(_a.a.a,"sourceImportance={0}, targetImportance={1}",this.i(),n.i());return!1}if(this.f()!==n.f()){_j.e.a(_a.a.a,"sourceSubject={0}, targetSubject={1}",this.f(),n.f());return!1}if(this.k()!==n.k()){_j.e.a(_a.a.a,"sourceComplianceId={0}, targetComplianceId={1}",this.k(),n.k());return!1}if(this.o()!==n.o()){_j.e.a(_a.a.a,"sourceSensitivity={0}, targetSensitivity={1}",this.o(),n.o());return!1}if(this.m()!==n.m()){_j.e.a(_a.a.a,"sourceIsDeliveryReceiptRequested={0}, targetIsDeliveryReceiptRequested={1}",this.m(),n.m());return!1}if(this.n()!==n.n()){_j.e.a(_a.a.a,"sourceIsReadReceiptRequested={0}, targetIsReadReceiptRequested={1}",this.n(),n.n());return!1}var i=this.l()?this.l().Mailbox:null;var t=n.l()?n.l().Mailbox:null;if(!_mcp.c.i(i,t)){_j.e.a(_a.a.a,"sourceFrom={0}, targetFrom={1}",i?i.EmailAddress:"null",t?t.EmailAddress:"null");return!1}if(!_mcp.c.a(this.e(),n.e(),this.j(),n.j())){_j.e.a(_a.a.a,"sourceToCout={0}, targetToCout={1}, sourceQueryString={2}, targetQueryString={3}",this.e()?this.e().x.length:0,n.e()?n.e().x.length:0,this.j(),n.j());return!1}if(!_mcp.c.a(this.d(),n.d(),this.h(),n.h())){_j.e.a(_a.a.a,"sourceCcCout={0}, targetCcCout={1}, sourceQueryString={2}, targetQueryString={3}",this.d()?this.d().x.length:0,n.d()?n.d().x.length:0,this.h(),n.h());return!1}if(!_mcp.c.a(this.c(),n.c(),this.g(),n.g())){_j.e.a(_a.a.a,"sourceBccCout={0}, targetBccCout={1}, sourceQueryString={2}, targetQueryString={3}",this.c()?this.c().x.length:0,n.c()?n.c().x.length:0,this.g(),n.g());return!1}if(!_mcp.c.w(this.b(),n.b())){_j.e.a(_a.a.a,"sourceAttachmentCount="+(this.b()?this.b().b():0)+", targetAttachmentCount="+(n.b()?n.b().b():0));return!1}if(this.a()!==n.a()){_j.e.a(_a.a.a,"Dirty due to editor content: snapshotContentLength={0}, snapshotContentLength={1}",this.a()?this.a().length:0,n.a()?n.a().length:0);return!1}_j.e.a(_a.a.a,"snapshot is clean");return!0}};_mcp.bW=function(n,t){this.g=Function.createDelegate(this,this.i);if(!n)throw Error.argumentNull("callback");if(t<=3e3)throw Error.argumentOutOfRange("timeoutPeriod");this.f=t;this.d=n};_mcp.bW.prototype={f:0,d:null,a:null,b:!1,c:function(){!this.a&&this.b&&(this.a=_j.m.a().a(_a.a.a,"MailComposeTimer",this.g,this.f))},h:function(){_j.e.a(_a.a.a,"Disabling timer.");this.b=!1;this.e()},e:function(){if(this.a){_j.e.a(_a.a.a,"Clearing timer.");this.a=_j.m.a().b(this.a)}},i:function(){_j.e.a(_a.a.a,"Executing timer callback.");this.e();this.d()}};_mcp.bk=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,lt,at,vt,yt,pt,wt,bt,kt,dt,gt,ni,ti,ii,ri,ui,fi,ei,oi,si,hi,ci,li){_mcp.bk.initializeBase(this,[n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,lt,at,vt,yt,pt,wt,bt,kt,dt,gt,ni,ti,ii,ri,ui,fi,ei,oi,si,hi,ci,li])};_mcp.bk.prototype={bD:function(){return this.Z.bR()?"MailUnifiedCompose_UpConverted":"MailUnifiedCompose"},ed:function(){return 15}};_mcp.d=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,lt,at,vt,yt,pt,wt,bt,kt,dt,gt,ni,ti,ii,ri,ui,fi,ei,oi,si,hi,ci,li){this.dk=Function.createDelegate(this,this.be);this.dU=Function.createDelegate(this,this.fn);this.dW=Function.createDelegate(this,this.fB);this.dX=Function.createDelegate(this,this.fE);this.di=Function.createDelegate(this,this.ft);this.cW=Function.createDelegate(this,this.es);this.cX=Function.createDelegate(this,this.fs);this.dT=Function.createDelegate(this,this.ea);this.dj=Function.createDelegate(this,this.fu);this.dV=Function.createDelegate(this,this.fp);this.cp=new _j.P;_mcp.d.resolveInheritance();this.U=this.dispose;_mcp.d.initializeBase(this);_a.b.b(k,"nativeBridge");this.cP=4;this.Z=n;this.bh=t||new _bc.b;this.bh.G(g);this.ba=this.bz();this.dw=i;this.bR=r;this.da=u;this.bo=new _mcp.Y(this.bh);this.dJ=f;this.cO=s;this.dH=e;this.bv=o;this.bV=h;this.bB=c;this.bf=l;this.bn=v;this.cE=p;this.cz=a;this.cI=w;this.br=b;this.bs=y;this.cN=k;this.bT=d;this.bA=g;this.dI=nt;this.cu=tt;this.cv=it;this.cw=rt;this.ds=ut;this.bY=ft;this.ci=et;this.dx=ot;this.cT=st;this.cy=ht;this.er=ct;this.cM=lt;this.dK=at;this.cs=vt;this.cq=yt;this.ct=pt;this.cD=wt;this.cr=bt;this.dr=kt;this.cC=dt;this.dg=gt;this.bF=ni;this.bU=ti;this.bW=ii;this.dG=ri;this.cS=ui;this.co=fi;this.cx=ei;this.cB=ci;this.cA=oi;this.dv=si;this.cf=hi;this.dl=li;if(this.Z.l()===3)this.bM=_mcp.d.d(o);else if(o){var ai=o;this.bM=ai.s||(ai.s=Function.createDelegate(ai,ai.d))}this.bA||(this.cL=!0);this.cl=!0;this.cn=!0;this.dB()&&this.bZ()&&this.fo();_j.e.a(_a.a.a,"ViewModel created")};_mcp.d.a=function(n,t){if(!n){_j.e.b(_a.a.a,"MailComposeViewModel.SafeGetComponent - map is null, cannot access component.");return null}return n.b(t)};_mcp.d.d=function(n){return function(t){if(n&&t){n.L(t,n.c());n.c().c(t)}else _j.e.b(_a.a.a,"GetDeepLinkPopUpHandler cannot invoke popup.")}};_mcp.d.c=function(){return+new Date+":"+Math.random()};_mcp.d.prototype={dw:null,Z:null,bR:null,da:null,dJ:null,dH:null,cO:null,bh:null,bv:null,bn:null,cE:null,dK:null,bV:null,bB:null,bs:null,cN:null,cI:null,er:null,bT:null,cu:null,cv:null,cw:null,ds:null,bA:null,dI:null,bY:null,ci:null,dx:null,bF:null,cz:null,cT:null,cy:null,bU:null,bW:null,dG:null,cS:null,cM:null,cs:null,cq:null,ct:null,cD:null,cB:null,co:null,cx:null,cA:null,dv:null,dl:null,cf:null,ba:null,bf:null,de:null,bS:null,cK:!1,cc:!1,ck:null,cj:!1,bL:!1,cP:0,cL:!1,cR:!1,bP:null,cZ:null,cr:null,cC:null,cQ:!1,dr:null,dg:null,bE:!1,cJ:!1,G:function(n){this.cp.b(n)},L:function(n){this.cp.c(n)},a:function(){return this.Z},fw:function(n){if(this.ba!==n){this.ba=n;this.ez("InfoBarViewModel")}return n},fy:function(n){if(n!==this.bS){var t;_a.h.a(t={val:this.bS}),this.bS=t.val;this.bS=n;this.ez("SenderPhotoViewModel")}return n},dB:function(){return(this.ej()||this.fk())&&this.bk()},cG:function(){_a.b.d(this.cT.d(),"MailComposeViewModel: Smime override factory has not been created");return this.cT.b()},bt:function(){return _mcp.d.a(this.bd,0)},bI:function(){return _mcp.d.a(this.bd,10)},bl:function(){return _mcp.d.a(this.bd,2)},bc:function(){return _mcp.d.a(this.bd,5)},ep:function(){return _mcp.d.a(this.bd,11)},ek:function(){return _mcp.d.a(this.bd,4)},bb:function(){return _mcp.d.a(this.bd,1)},ef:function(){return _mcp.d.a(this.bd,6)},bg:function(){return _mcp.d.a(this.bd,7)},bj:function(){return _mcp.d.a(this.bd,8)},ca:function(){return _mcp.d.a(this.bd,9)},cb:function(){return _mcp.d.a(this.bd,28)},bC:function(){return _mcp.d.a(this.bd,16)},ce:function(){return _mcp.d.a(this.bd,18)},cF:function(){return _mcp.d.a(this.bd,3)},dc:function(){return _mcp.d.a(this.bd,17)},el:function(){return _mcp.d.a(this.bd,29)},dd:function(){return _mcp.d.a(this.bd,23)},bp:function(){return _mcp.d.a(this.bd,19)},bm:function(){return _mcp.d.a(this.bd,22)},dC:function(){return _mcp.d.a(this.bd,24)},bH:function(){return _mcp.d.a(this.bd,30)},bN:function(){return _mcp.d.a(this.bd,25)},ec:function(){return _mcp.d.a(this.bd,32)},em:function(){return _mcp.d.a(this.bd,35)},bK:function(){return _mcp.d.a(this.bd,12)},dD:function(){return _mcp.d.a(this.bd,27)},fl:function(){return _mcp.d.a(this.bd,31)},dy:function(){return _mcp.d.a(this.bd,36)},ee:function(){return _mcp.d.a(this.bd,34)},fb:function(){return _mcp.d.a(this.bd,37)},bo:null,fk:function(){return this.bs.i()||this.fi()},ej:function(){return this.dE()||this.bs.a().bq().Enabled},dE:function(){return this.bs.a().bp().Enabled},e:function(){return this.bA},bq:function(){return!this.bv.b()||!!this.bA},bk:function(){return!1},bD:function(){return"MailCompose"},dA:function(){return!1},ed:function(){return 5},fg:function(){return!!this.bn&&this.bn.a().Y().Enabled},cd:function(){var t=this.bq();var n=new _a.l;n.c("P",t);n.b("I",t?this.bJ().toString():"NA");n.b("ET",this.Z.fC);n.b("S",this.bD());return n},fx:function(n){if(this.cL!==n){this.cL=n;this.ez("IsReadyForViewInitialization")}return n},bJ:function(){return!!this.bA},bx:function(){return this.cP},ew:function(n){if(this.cP!==n){this.cP=n;this.ez("PopupPanelSize")}return n},w:function(){if(this.bI()){var n=this.bI();return n.c||(n.c=Function.createDelegate(n,n.j))}else return this.dV},y:function(){return this.de},k:function(n){_j.e.a(_a.a.a,"Shell setting ClosePopupCommand from {0} to ",this.de?"non-null":"null",n?"non-null":"null");this.de=n;return n},cl:!1,by:function(){return this.cl},O:function(n){this.cl=n;return n},cn:!1,T:function(n){this.cn=n;return n},eg:function(){return this.bF.g()},fe:function(){return this.bF.e()},ei:function(){return this.bF.j()},eh:function(){return this.bF.f()},dz:function(){return this.bF.b()},o:function(){return this.bZ()?0:1},fc:function(){return this.bF.E()},cY:!1,H:function(){return this.cY},Q:function(n){this.cY=n;return n},et:function(n){if(this.cK!==n){this.cK=n;this.ez("IsInView")}return n},bG:!1,u:function(n){this.bG=n;return n},ey:function(n){var t=this.en();if(this.cc!==t){this.cc=t;this.ez("ShouldShowToolbarMessage")}return n},eN:function(n){if(this.ck!==n){this.ck=n;this.ez("ToolbarMessage")}return n},bd:null,ex:function(n){var t=this.en();if(t!==this.cj){this.cj=t;this.ez("ShouldBlockView")}return n},P:function(n){if(this.bL!==n){this.bL=n;this.ez("IsNavigatingAway")}return n},en:function(){return this.bl()&&(this.bl().i()||this.bl().g())?!0:this.bg()&&this.bg().b()?!0:!1},db:function(){return!this.bF.k()},br:null,dY:null,f:function(n){this.dY=n;return n},bM:null,v:function(n){this.bM=n;return n},s:function(){var n=_mcp.d.a(this.bd,27);if(n){n.e()||n.h();return n.a()}else{this.eM||this.fd||_j.e.b(_a.a.a,"MailComposeViewMode.ComposeCommandingBarViewModel -- CommandingBarComponent should not be null if the state is not disposed or disposing.");return null}},cH:function(){return this.Z.fN()},t:function(n){if(this.cR!==n){this.cR=n;this.ez("SharedCommandingBarShown")}return n},bZ:function(){return this.bv.a()==="Mouse"},fm:function(){return this.bU.b()&&this.bZ()},bi:function(){this.cZ||(this.cZ=new _cmc.bF);return this.cZ},cm:null,I:function(){return this.bg().a()},S:function(n){this.bg().c(n);return n},R:function(n){if(n!==this.cQ){this.cQ=n;this.ez("ReadyToSetInitialFocus")}return n},eo:function(){return!1},eu:function(n){this.bE!==n&&(this.bE=n);return n},fi:function(){return this.bs.a().ck().Enabled&&this.bU.a()==="Mouse"&&(this.dg.z()&131072)==131072},df:function(n){if(this.cJ!==n){this.cJ=n;this.ez("IsInSxSView")}return n},fu:function(n,t){if(this.Z.K()){this.Y();this.bd.q()}else{this.X();this.bd.l()}},eY:function(){this.Z.apcl(_mcp.b.e,this.dj)},Y:function(){if(this.cH()&&!this.bP){_j.e.a(_a.a.a,"Setting mail compose viewmodel override");this.bP=this.cG().c();this.bP.b(this.ba)}},X:function(){if(this.bP){this.bP.a();this.bP=null}},M:function(){!this.fd&&this.bc()&&this.bc().a()&&this.bc().a().f(this.bc().a().b(),this.Z.q(),this.Z.bg())},be:function(){if(!this.fd){this.bN().d();this.bb().bi()}},dF:function(n){this.cm=n;this.bc()&&this.bc().a()&&this.bc().a().cq(this.cm)},ch:function(){this.Z.d()&&(this.Z.eY()||this.Z.dn())||this.Z.fW(_mcp.d.c());_j.e.a(_a.a.a,"Init");this.bf.a(_cmc.bo,new _mcp.bV);this.bd||(this.bd=this.dt());this.cQ=!this.bW||!this.bW.q()||this.bW.a;if(this.cH()){_j.e.a(_a.a.a,"Creating Smime override factory");this.du(this.dT)}else this.ea()},du:function(n){_j.e.a(_a.a.a,"Calling CreateSmimeOverrideFactoryAsync");var t=this;this.cT.a(function(i){_j.e.a(_a.a.a,"Smime override factory created");i.f(t.Z,t.bf);_j.e.a(_a.a.a,"Calling createFactoryCallback");n()})},eb:function(){},dt:function(){return new _mcp.bB(this,this.cz,this.bn,this.bs,this.cE,this.cI,this.cN,this.bA,this.cu,this.cv,this.cw,this.cy,this.cM,this.cs,this.cq,this.ct,this.cD,this.cr,this.dr,this.cC,this.dg,this.bF,this.bU,this.bW,this.cS,this.co,this.cx,this.cA,this.dv,this.cB,this.dl)},ea:function(){_j.e.a(_a.a.a,"Completing initialization");this.Y();this.eY();if(this.ba){this.ba.q();this.bf.a(_y.ed,new _y.ed);this.Z.dn()&&this.dZ(this.Z.gP())}this.P(!1);this.bf.b(_a.dG,this.cX);this.bt().h();if(!this.bA){this.bv.l(this.cW);this.bv.m(this.cW);_j.e.a(_a.a.a,"Before unload handler has been hooked up")}this.bI()&&(this.bI().f()?this.cp.a():this.bI().apcl("IsAppBarSetup",this.di))},ft:function(n,t){this.bI().f()&&this.cp.a()},dZ:function(n){switch(n){case 94:case 99:case 100:this.ba.c(n,null,_u.n.Ru,this.dX);break;case 98:this.ba.c(n,null,_u.n.Ru,this.dW);break;default:this.ba.a(n,null);break}},d:function(n){this.bl()?this.bl().d(n):this.eM||this.fd||_j.e.b(_a.a.a,"MailComposeViewMode.SetMailComposeConductor - NavigationComponent should not be null if the state is not disposed or disposing.")},c:function(){if(this.bl())return this.bl().n();else{this.eM||this.fd||_j.e.b(_a.a.a,"MailComposeViewMode.TryExitNow - NavigationComponent should not be null if the state is not disposed or disposing.");return!1}},h:function(n,t){this.bj().b(n,t)},fE:function(){window.open("/owa/owahipcontrol.aspx?compose=1");this.ba.b(100);this.ba.b(99);this.ba.b(94)},fB:function(){window.open(_mcp.d.b);this.ba.b(98)},fz:function(n){this.eO(n);_j.e.a(_a.a.a,"Set screen view model appbar. ContextId={0}",this.Z.d())},fA:function(n){this.eV(n);_j.e.a(_a.a.a,"Set screen view model top appbar. ContextId={0}",this.Z.d())},dm:function(){_y.iD.prototype.dm.call(this);var n=this.bt();try{if(n.e()){_j.e.a(_a.a.a,"PostTransitionIn view model, begin secondary init now since primary init is already finished.");n.c()}else _j.e.a(_a.a.a,"PostTransitionIn view model, primary init not finished yet. Relying on primary init to fire secondary init...");this.et(!0);if(this.Z.dn()&&this.Z.cs()){var i=this.Z.d();this.bf.a(_y.fa,new _y.fa(i))}(this.Z.a()||this.bv.a()!=="TouchNarrow")&&this.Z.fh&&this.Z.fh();if(this.bZ()){var t=this;_j.m.a().c(_a.a.b,"PreloadOwaFilePicker",function(){var n=t.bc();n&&n.u()})}if(this.Z.fi){this.Z.fi(this);this.Z.fi=null}this.bi().m(this.bD())}catch(r){n.a("MailComposeViewModelInitializeException",null,r.message);_j.e.c(_a.a.a,"MailComposeViewModel.PostTransitionIn exception: {0}",r.message);throw r;}},dn:function(){_j.e.a(_a.a.a,"Post transition out");if(!this.bg()){_j.e.a(_a.a.a,"[MailComposeViewModel:PostTransitionOut] Send component is null");return}if(this.bg().k()){var n=this.bg().k();n.j=this.Z.cs()?"SentViaNotification":"NotSentViaNotificationDueToOtherPendingFailedAsyncSend";_a.c.a(n)}this.et(!1);this.bi().c();if(!this.bg().j()){if(this.bG){this.bb().f();this.Z.eR.a()}IMailComposeAutoSaveComponent.isInstanceOfType(this.bg())&&this.bg().k()}this.bf.a(_a.cv,new _a.cv(!0,"NotLoadedByReadingPaneComposeHide"));this.bf.a(_a.bd,new _a.bd("MCompose"));_y.iD.prototype.dn.call(this)},bX:function(){if(this.bc().b()){_j.e.a(_a.a.a,"Dirty due to attachment in progress");return!0}this.bb().f();return this.Z.gn()},bz:function(){this.ba||this.fw(new _db.h);return this.ba},K:function(){_h.v.k()},N:function(){_h.v.g()},fC:function(){this.bP&&this.bP.c()},W:function(){this.fx(!0)},V:function(){var n=new _y.fk;this.es(n);return n.b},es:function(n){this.bl().f(n);this.bi().c()},n:function(){this.bi().c()},eW:function(){this.bq()&&this.Z&&!_j.h.a(this.Z.I())&&!this.bA&&(document.title=this.Z.I())},j:function(n){this.dD()&&this.dD().c(n+this.ed())},eC:function(){_j.e.a(_a.a.a,"Disposing view model");this.X();this.Z.rpcl(_mcp.b.e,this.dj);if(!this.bd){_j.e.b(_a.a.a,"MailComposeViewModel.Reset - Skipping post-transition out processing because the component map is null.");return}var n=this.bl();if(!n){_j.e.b(_a.a.a,"MailComposeViewModel.Reset - Skipping post-transition out processing because the navigation component is null.");return}if(n.c())this.bH()&&this.bH().a("Navigate");else{_j.e.b(_a.a.a,"MailComposeViewModel.Reset - Skipping post-transition out processing because IsNavigatingAwayFromCompose is false.");return}this.bm()&&this.bm().a()&&this.bm().a().g(!1);this.bI()&&this.bI().rpcl("IsAppBarSetup",this.di);n.m(!1);this.bd.dispose();this.bd=null;this.Z&&!this.bG&&this.Z.dH();if(this.ba){this.ba.p.g();var i;_a.h.a(i={val:this.ba}),this.ba=i.val}this.bA||this.bv.l(this.cW);this.bf.c(_a.dG,this.cX);this.bM=null;this.cY=!1;var t;_a.h.a(t={val:this.bS}),this.bS=t.val;_y.iD.prototype.eC.call(this)},fv:function(n,t){this.bc().t(n);this.bZ()&&(!n.c||n.c===2)&&this.bc().q();this.ee()&&this.ee().a()},fr:function(n){if(this.Z.bs()&&this.Z.A()&&this.Z.dh()===1){var t=this.Z.A().Id;if(this.eS(n)){_j.e.a(_a.a.a,"Original message {0} loaded from cache.",t);return}var r=new _h.I(200,[this.Z.A()],_h.b.a(),"ItemNormalizedBody",2,!1,this.bn);var i=this,u=this;this.bo.a(r,function(r){_j.e.a(_a.a.a,"Original message {0} loaded from server.",t);i.eS(n)},function(n){_j.e.b(_a.a.a,"Fail to load original item with id "+t)},null)}},eS:function(n){var t=_h.d.a().a(this.Z.A().Id);if(t){this.Z.cg(t);n&&n();return!0}return!1},fp:function(n,t,i){return t===1?!this.cn:!1},eR:function(n){if(this.bh.p)_j.e.b(_a.a.a,"ShowMessageBoxForSessionTimeout: A message is already being shown, pending timeout dialog was not shown");else{_j.e.b(_a.a.a,"ShowMessageBoxForSessionTimeout: Show pending timeout dialog");n?this.bh.g(0,_u.n.n,this.dU,!1,_u.n.Nv,null,_u.n.DI,this.bh.z):this.bh.g(0,_u.n.TJ,null,!1,null,null,_u.n.DI,this.bh.z)}},fs:function(n){if(n.b()<120){_j.e.a(_a.a.a,"OnSessionTimeoutEvent: Timeout header recieved with less than 2 minutes until session expires");this.bf.c(_a.dG,this.cX);var i=this,t=this;this.bj().a("Save",function(){_j.e.a(_a.a.a,"OnSessionTimeoutEvent: Save was successful");i.eR(!0)},function(){_j.e.a(_a.a.a,"OnSessionTimeoutEvent: Save was unsuccessful");t.eR(!1)},!1)}},fn:function(n,t){if(n){_j.e.a(_a.a.a,"HandleSessionTimeoutDialog: Logout for user");var r=new _a.bw;this.bf.a(_a.bw,r);var i=new _a.cl(this.dG.d());this.bf.a(_a.cl,i)}},fo:function(){var n=this.Z.bv();if(n){var i=_h.i.a(n,!1);var t=this.fD(i);this.fy(t)}},fD:function(n){var i=2;n.b()!==5&&(i|=1);var t=null;if(this.bR&&this.bR.c){t=this.bR.c.a(n,i,!0,5,!1,!1,!1);t.b(!0)}return t}};_mcp.D=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,lt,at,vt,yt,pt,wt,bt,kt,dt,gt,ni,ti,ii,ri,ui,fi,ei,oi,si,hi,ci,li){this.g=Function.createDelegate(this,this.z);_mcp.D.initializeBase(this,[n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,lt,at,vt,yt,pt,wt,bt,kt,dt,gt,ni,ti,ii,ri,ui,fi,ei,oi,si,hi,ci,li]);this.bs.r()&&(this.Z.cu()||this.bE)&&this.bf.b(_mco.q,this.g)};_mcp.D.prototype={bk:function(){return!0},bD:function(){return"MailInlineCompose"},eo:function(){return!0},i:null,d:function(n){_mcp.d.prototype.d.call(this,n);IInlineComposeConductorViewModel.isInstanceOfType(n)&&(this.i=n.d())},eC:function(){this.bf.c(_mco.q,this.g);_mcp.d.prototype.eC.call(this)},z:function(n){if(this.Z.bi().Id===n.b.Id){var t=n.a.a();this.bb().f();if(_mco.h.d(this.Z,t)){this.b(t.m()?t.m().f():new Array(0),this.bb().c(),t.bB.Sender.Mailbox);this.b(t.p()?t.p().f():new Array(0),this.bb().g(),t.bB.Sender.Mailbox);this.p(t.bB.Sender.Mailbox);this.q(t.bB.ItemId,n.a)}else{this.ba.a(1004);this.m(!1,"Recipients differ")}}},q:function(n,t){var u=this.Z.a();this.Z.c(14);this.Z.cf(n);var f=this.bT.h(this,0);var i=this,r=this;this.bo.a(f,function(n){i.ba.a(1003);i.bf.a(_mco.j,new _mco.j(t));t?i.m(!0,""):_mco.h.a(!0,"",!0)},function(n){r.ba.a(1004);t?r.m(!1,n.I.toString()):_mco.h.a(!1,"Server",!0)},null);this.Z.c(u)},b:function(n,t,i){var f=_g.a.a().c().bB.UserEmailAddress;var e=i.EmailAddress;t.a.E();for(var o=n.length,r=0;r<o;r++){var u=n[r];u.EmailAddress!==f&&u.EmailAddress!==e&&t.a.bE(u)}},p:function(n){if(n.EmailAddress!==_g.a.a().c().bB.UserEmailAddress){this.bb().c().b&&this.bb().c().b.n(n);this.bb().c().a&&this.bb().c().a.n(n)}},m:function(n,t){var i=new _a.l;i.c("S",n);i.b("err",t);var r=_a.c.b(_a.a.a,"RPCountDraftReparent");r.j=i.toString();_a.c.a(r)},eb:function(){this.eu(!0);this.Z.c(2);if(this.Z.dq()){this.b(this.Z.ds(),this.bb().c(),this.Z.bK());this.b(this.Z.dr(),this.bb().g(),this.Z.bK());this.p(this.Z.bK());this.q(this.Z.A(),null);return}this.bf.a(_mco.j,new _mco.j(null));_mco.h.a(!0,"",!1)}};_mcp.j=function(n,t,i){this.b=n;this.c=t;this.g=!!i&&i.a().G().Enabled};_mcp.j.b=function(n){return n.EmailAddress?n.EmailAddress.toLowerCase():n.ItemId.Id};_mcp.j.prototype={b:null,g:!1,d:null,c:!1,a:null,e:null,f:null,h:function(){!this.d&&this.b&&(this.d=_a.I.a(this.b.EmailAddress));return this.d},m:function(n){if(!this.c)return n.val.f();_j.e.a(_mcp.j.a,"begin calculating initial audience");var t=new _j.l;this.a={};if(this.b){_j.e.a(_mcp.j.a,"adding always keep address "+this.h()+" as the first To recipient");t.a(this.b);this.a[this.h()]=0}this.i(t,n.val.f(),0);this.i(t,n.val.k(),1);_j.e.a(_mcp.j.a,"end calculating initial audience");this.l(t,n);return t},o:function(n,t){if(_rw.d.isInstanceOfType(n)){this.e=n;if(this.g&&this.b)for(var u=this.e.G,i=0;i<u.b();i++){var r=u.c(i);if(_a.I.a(r.k.a().EmailAddress)===this.d){r.j.I(!0);break}}}this.f=t},l:function(n,t){if(!this.c||!n){t.val.s(n);return}for(var f=new _j.l,e=new _j.l,o=n.x.length,r=0;r<o;r++){var i=n.x[r];var u=_mcp.j.b(i);if(u in this.a)this.a[u]?e.a(i):f.a(i);else{_j.e.a(_mcp.j.a,"Email address "+u+" is not in the local bookkeeping, add it to To");f.a(i)}}t.val.s(f);t.val.bb(e);if(this.f){this.f.F(e);_j.e.a(_mcp.j.a,"Update Cc recipient well with the separated Cc recipients")}},n:function(n,t){if(this.c){var i=t.c;_j.e.a(_mcp.j.a,"user edited the To recipients, processing the "+i+" change");var u=t.b;var r=t.a;switch(i){case 0:this.j(r);break;case 2:this.k(u);break;case 3:this.k(u);this.j(r);break;default:throw Error.notImplemented("a new NotifyCollectionChangedAction "+i+" has been introduced and to recipient helper does not work with it");}}},k:function(n){if(n)for(var f=n.length,r=0;r<f;r++){var u=n[r].k.a();var t=_mcp.j.b(u);_j.e.a(_mcp.j.a,"recording removed recipient "+t);if(t in this.a)if(t===this.h()){var i=this;_j.m.a().a(_mcp.j.a,"ProcessAlwaysKeepRecipients",function(){if(i.e){_j.e.a(_mcp.j.a,"adding the always keep address "+t+" back in To well");var n=i.e.bE(i.b);i.g&&n.I(!0)}},0)}else{_j.e.a(_mcp.j.a,"removing removed recipient "+t+" from cc recipient well");delete this.a[t]}}},j:function(n){if(n)for(var r=n.length,t=0;t<r;t++){var u=n[t].k.a();var i=_mcp.j.b(u);_j.e.a(_mcp.j.a,"adding added recipient "+i+" to local copy");this.a[i]=0}},i:function(n,t,i){var e=t?t.b():0;_j.e.a(_mcp.j.a,"merging "+e+" "+i+" partial audience into audience");for(var r=0;r<e;r++){var f=t.c(r);var u=_mcp.j.b(f);if(!(u in this.a)){n.a(f);this.a[u]=i}}}};_mcp.bn=function(n,t,i,r,u,f,e,o,s){this.O=Function.createDelegate(this,this.S);this.A=Function.createDelegate(this,this.I);this.N=Function.createDelegate(this,this.Q);_mcp.bn.initializeBase(this);this.H=o;this.l=o.b;this.n=n;this.v=t;this.m=o.a;this.y=i;this.C=r;this.G=u;this.F=f;this.E=e;this.K=s};_mcp.bn.prototype={v:null,n:null,l:null,m:null,H:null,y:null,C:null,G:null,F:null,E:null,K:null,s:null,o:0,x:!1,M:!1,z:null,p:null,t:null,w:!1,f:function(){this.s||(this.s=new _y.bm);return this.s},e:function(n){this.s=n;return n},q:function(){return this.m?this.m.cn():null},B:null,k:function(n){this.B=n;return n},c:function(n){_a.H.a(_a.a.w,"MailComposeReplyLoad",3);this.w=!0;this.p=_y.j.b(_a.a.w,"MailComposeReply",!0);this.t=_y.j.b(_a.a.w,"MailComposeReplyLoad",!0);this.l.bB.ConversationId?this.n.n("Inference.Reply",this.l.bB.ItemId,this.l.bB.ConversationId,this.m?this.m.P():null,this.q()):this.n.a("Inference.Reply",this.l.bB.ItemId,this.q());this.u(1,n)},d:function(n){_a.H.a(_a.a.w,"MailComposeReplyAllLoad",3);this.w=!0;this.p=_y.j.b(_a.a.w,"MailComposeReplyAll",!0);this.t=_y.j.b(_a.a.w,"MailComposeReplyAllLoad",!0);this.l.bB.ConversationId?this.n.n("Inference.ReplyAll",this.l.bB.ItemId,this.l.bB.ConversationId,this.m?this.m.P():null,this.q()):this.n.a("Inference.ReplyAll",this.l.bB.ItemId,this.q());this.u(2,n)},h:function(n){this.x=!0;this.d(n)},i:function(n){this.M=!0;this.d(n)},b:function(n){this.n.a("Inference.PostReply",this.l.bB.ItemId,this.q());this.u(12,n)},a:function(n){_a.H.a(_a.a.w,"MailComposeForwardLoad",3);this.w=!0;this.p=_y.j.b(_a.a.w,"MailComposeForward",!0);this.t=_y.j.b(_a.a.w,"MailComposeForwardLoad",!0);this.l.bB.ConversationId?this.n.n("Inference.Forward",this.l.bB.ItemId,this.l.bB.ConversationId,this.m?this.m.P():null,this.q()):this.n.a("Inference.Forward",this.l.bB.ItemId,this.q());this.u(3,n)},g:function(n){this.x=!0;this.a(n)},j:function(){if(!this.H.l())throw Error.invalidOperation("OnSendAgain is invoked on an item that can't be sent again. ");var t=_g.b.a.nameToId("drafts");var n=new _mcp.bs(this.l.bB.ItemId.Id,t.Id);n.c(this.N);n.d(this.A);_a.g.a.a(n)},Q:function(n){var i=n.i;if(i.length>0){var t=this.C.i(_g.e.b(i));t.c(this.O);t.d(this.A);_a.g.a.a(t)}else this.I(n)},I:function(n){this.m.C().b(9500);this.m.C().a(9500)},S:function(n){var t=n;if(t.e){this.m.C().b(9500);var i=this.y.b(t.j[0],!1,t.e.dW(),t.e.bS());_y.c.a.b()||i.p(0);this.f().a(i)}else this.I(n)},u:function(n,t){this.o=n;this.T(t)},T:function(n){var u=_dg.a.isInstanceOfType(this.l);n||(n=!_y.c.a.b());var t=this.y.a(n,!1);t.bd(this.w);n&&t.p(0);var f=null;switch(this.o){case 1:f=!t.l()||u?"MailComposeReplyPopOut":"MailComposeReply";break;case 2:f=!t.l()||u?"MailComposeReplyAllPopOut":"MailComposeReplyAll";break;case 3:f=!t.l()||u?"MailComposeForwardPopOut":"MailComposeForward";break;default:break}if(f&&this.p){this.p.r=f;t.x(this.p);t.bc(this.t);t.bw()}t.eh(this.l.bB.ParentFolderId);this.m&&t.ei(this.m.cA());t.c(this.o);t.ce(!0);t.eS=this.x;t.fn=this.M;t.e(!t.eS||this.o===3);var i=new _g.N;i.Mailbox=new _g.f;i.Mailbox.EmailAddress=this.v.c().bB.UserEmailAddress;i.Mailbox.Name=this.v.c().bB.UserDisplayName;i.Mailbox.MailboxType="Mailbox";i.Mailbox.RoutingType="SMTP";t.cQ(i);t.fh=this.B;if(u){var r=this.l;if(r.cJ())t.G(r);else{t.dR(_dg.a.a(r));t.cE(t.cB(r));t.cf(this.l.bB.ItemId);t.cM(_dg.a.e(r))}}else t.G(this.l);if((this.o===1||this.o===2)&&_g.i.isInstanceOfType(this.l)){var o;var e=this.l;var l=this.L(e.x())+this.L(e.p())+this.L(e.m());o=this.o===1?"MailComposeBeforeReply":"MailComposeBeforeReplyAll";var c=_a.c.b(_a.a.w,o);c.j=l.toString();_a.c.a(c)}if((_g.i.isInstanceOfType(this.l)||u)&&t.fO(this.l)){var s=_a.p.d();s&&t.hx(this.l.by());if(this.l.cB()||t.K()&&s){var h=this;this.R(function(n){n.b(t,h.l,h.o)})}else this.f().a(t)}else this.f().a(t)},R:function(n){_j.e.a(_a.a.k,"[MailResponseViewModel] Creating Smime command factory.");var t=this;this.G.a(function(i){t.F.a(function(r){t.E.a(function(u){t.z||(t.z=t.P(i,r,u));_j.e.a(_a.a.k,"[MailResponseViewModel] Executing smime operation.");n(t.z)})})})},P:function(n,t,i){_j.e.a(_a.a.k,"[MailResponseViewModel] Creating SmimeMailResponseViewModelCommand instance.");var r=null;r=n.f();var f=this,u=this;r.a(this,this.v,this.K,function(n,i){i.cE(i.cB(n));var u=t.a(n.bB.ItemId,i.cv(),i.cm(),_dg.a.a(n));var r=t.b(200,u,i.cm());r.Y=i.d();return r},function(n,t,r){var u=new _mcp.bZ(n,t,r,i);return u.toString()});return r},L:function(n){return n?n.b():0}};_mcp.bo=function(n,t,i,r,u,f,e,o){this.f=n;this.i=t;this.g=i;this.b=r;this.h=u;this.d=f;this.c=e;this.e=o};_mcp.bo.prototype={f:null,i:null,g:null,b:null,h:null,d:null,c:null,e:null,a:function(n){return new _mcp.bn(this.f,this.i,this.g,this.b,this.h,this.d,this.c,n,this.e)}};_mcp.P=function(){_mcp.P.initializeBase(this)};_mcp.P.prototype={a:null,d:"Normal",e:!1,f:!1,b:!1,c:!1,i:!1,j:!1,g:null,h:!1,k:!1,l:!1,s:function(){if(!this.a){this.a=new _j.l;this.a.a("Normal");this.a.a("Personal");this.a.a("Private");this.a.a("Confidential")}return this.a},o:function(n){if(this.d!==n){this.d=n;this.ez("Sensitivity")}return n},m:function(n){if(this.e!==n){this.e=n;this.ez("IsDeliveryReceiptRequested")}return n},n:function(n){if(this.f!==n){this.f=n;this.ez("IsReadReceiptRequested")}return n},v:function(n){if(this.h!==n){this.h=n;this.ez("ShowSmimeOptions")}return n},p:function(n){if(this.b!==n){this.b=n;this.ez("SmimeEncryptMessage")}return n},q:function(n){if(this.c!==n){this.c=n;this.ez("SmimeSignMessage")}return n},w:function(n){if(this.i!==n){this.i=n;this.ez("SmimeEncryptMessageIsEnabled")}return n},x:function(n){if(this.j!==n){this.j=n;this.ez("SmimeSignMessageIsEnabled")}return n},y:function(n){if(this.l!==n){this.l=n;this.ez("WaitingForPreviousAction")}return n},u:function(n){if(this.g!==n){this.g=n;this.ez("Conductor")}return n},t:function(n){this.k=n.K();this.v(_a.p.a&&_a.p.i()&&n.dF());this.y(!1);this.o(n.C());this.m(n.Z());this.n(n.ba());this.p(n.o());this.q(n.t());this.w(n.dz());this.x(n.dA())},eC:function(){this.g=null;this.a.g();var n;_a.h.a(n={val:this.a}),this.a=n.val;_a.fM.prototype.eC.call(this)}};_mcp.ba=function(n){_mcp.ba.initializeBase(this);this.h=n;var t=_a.d.cb();if(t.length>=3){this.c=new _mcp.Z(t[0]);this.e=new _mcp.Z(t[1]);this.f=new _mcp.Z(t[2])}};_mcp.ba.prototype={h:0,b:null,a:0,d:!1,g:"",c:null,e:null,f:null,l:function(){return(this.h&3)==3},j:function(n){if(this.d!==n){this.d=n;this.ez("IsTimeExpirationSelected")}return n},n:function(n){this.a=n;this.j(this.a===1?!0:!1);this.ez("SelectedOption");return n},i:function(n){this.g=n;this.ez("ErrorText");return n},k:function(){return[this.c,this.e,this.f]},m:function(n){if(this.b!==n){this.b=n;this.ez("Conductor")}return n}};_mcp.Z=function(n){this.b=n};_mcp.Z.prototype={b:0,a:null,c:!1,f:function(n){this.a!==n&&(this.a=n);return n},e:function(){var n="";switch(this.b){case 7:n=_nbs.a.Ch;break;case 6:n=_nbs.a.sO;break;case 5:this.c=!0;n=_nbs.a.jj;break}return n},d:function(){var n=0;switch(this.b){case 7:case 6:n=2;break;case 5:n=4;break}return n}};_mcp.bb=function(n){this.a=n};_mcp.bb.prototype={a:!1};_mcp.bY=function(n,t){this.a=n;this.b=t};_mcp.bY.prototype={a:null,b:null};_mcp.bZ=function(n,t,i,r){this.j=new RegExp("<","g");this.i=new RegExp(">","g");this.d=n;this.a=t;this.e=i};_mcp.bZ.prototype={e:0,a:null,d:!1,f:null,toString:function(){_j.e.a(_a.a.a,"Building message headers for reply/fwd. locally.");var a=this.n();var t=this.g(!0);var r=this.g(!1);r&&r.toLowerCase()!==t.toLowerCase()&&(t=String.format(_u.n.Qj,r,t));var o=this.a.cx()||this.a.dh();var w=o?o.toString():this.a.iq();var h=this.h(!0);var e=this.h(!1);var i,n;var s,u;this.o(s={val:i},u={val:n}),i=s.val,n=u.val;var p=this.b(_nbs.a.gt,t);var k=this.b(_nbs.a.Lg,w);var b=h?this.b(_u.n.PT,h.join("; ")):null;var y=e?this.b(_u.n.Pu,e.join("; ")):null;var l=this.b(_u.P.e,a);var c=i?this.b(_u.P.R,i):null;var v=n?this.b(_u.P.J,n):null;var f=this.k(p,k,b,y,l,c,v);return this.d?'<p style="color:black;border-top:1pt solid #E1E1E1;padding-top:3pt;margin-bottom:13pt;font-family:Calibri,sans-serif;font-size:11pt">'+f.join("<br/>")+"</p>":String.format("________________________________________{0}{1}{0}{0}","\r\n",f.join("\r\n"))},k:function(){for(var u=[],n=0;n<arguments.length;++n)u[n]=arguments[n];for(var f=new _j.q,r=u,e=r.length,t=0;t<e;++t){var i=r[t];_j.h.a(i)||f.c(i)}return f.i()},n:function(){if(this.a.bB.Subject)return this.a.bB.Subject;else{var n;switch(this.e){case 1:case 2:case 12:n=_u.n.NL;break;case 3:n=_nbs.a.ar;break;case 8:n=_nbs.a.Tj;break;case 9:n=_nbs.a.qL;break;case 10:n=_nbs.a.Oc;break;case 5:case 6:case 7:n="";break;default:n="";break}return String.format(_nbs.a.lN,n,this.a.db()||_u.R.SA)}},g:function(n){if(_g.i.isInstanceOfType(this.a)){var r=this.a;var i=n?r.bB.From:r.bB.Sender;return i?this.c(i.Mailbox):null}else if(_dg.a.isInstanceOfType(this.a)){var t=this.a;return t.bB.Organizer?this.c(t.bB.Organizer.Mailbox):null}else return null},h:function(n){if(_g.i.isInstanceOfType(this.a)){var i=this.a;return this.m(n?i.m():i.p())}else if(_dg.a.isInstanceOfType(this.a)){var t=this.a;return this.l(n?t.s():t.v(),n)}else return null},o:function(n,t){var i=null;var r=null;n.val=t.val=null;if(_dg.q.isInstanceOfType(this.a)){var f=this.a;i=f.E();r=f.dP()}else if(_dg.a.isInstanceOfType(this.a)){var u=this.a;i=u;r=u}if(r){var e=this.f.a();n.val=e.a(r,null)||" "}i&&(t.val=i.u()?i.u().bB.DisplayName||" ":" ")},m:function(n){if(!n||!n.b())return null;var t=new _j.q;var i=this;n.n(function(n){t.c(i.c(n))});return t.i()},l:function(n,t){if(!n||!n.b())return t?[this.c(this.a.bB.Organizer.Mailbox)]:null;var i=new _j.q;var r=this;n.n(function(n){i.c(r.c(n.bB.Mailbox))});return i.i()},c:function(n){return n?n.Name||n.OriginalDisplayName||n.EmailAddress||"":""},b:function(n,t){return this.d?"<b>"+n+"</b> "+this.p(t):n+" "+t},p:function(n){if(!n)return null;n=n.replace(this.j,"&lt;");n=n.replace(this.i,"&gt;");return n}};_mcp.bp=function(n,t){this.i=Function.createDelegate(this,this.l);this.j=Function.createDelegate(this,this.q);_mcp.bp.initializeBase(this);this.h=n;this.f=t};_mcp.bp.prototype={h:null,f:null,a:null,b:null,g:null,c:null,e:null,n:function(){this.c||(this.c=new _j.g(this.j,_a.a.a));return this.c},m:function(){this.e||(this.e=new _j.g(this.i,_a.a.a));return this.e},bQ:function(){this.b||(this.b=new _y.w);return this.b},bw:function(n){this.b=n;return n},o:function(n){if(this.a!==n){this.a=n;this.ez("ConsensusSchedulingViewModel")}return n},eC:function(){var t;_a.h.a(t={val:this.c}),this.c=t.val;var n;_a.h.a(n={val:this.a}),this.a=n.val;this.b=null;_a.fM.prototype.eC.call(this)},bx:function(){return 2},w:function(){return null},d:null,y:function(){return this.d},k:function(n){this.d=n;return n},by:function(){return!1},p:function(n){if(this.f){var t=this;this.f.a(function(n){t.o(n.a(_a.d.a().d(),null,0));t.a.x(60);t.a.d(3);t.h.z(t)})}this.g=n},q:function(){var n=this.a.a();this.g(n.d());this.g=null;this.d()},l:function(){_a.c.c(_a.a.a,"AvailableTimeInsertCanceled");this.d()}};_mcp.be=function(){};_mcp.be.prototype={setNoRestriciton:0,unknownClassification:1};_mcp.be.registerEnum("_mcp.be",!1);_mcp.bf=function(){};_mcp.bf.prototype={others:0,fullComposeCommandingBar:1,fullComposeBottomButton:2,inlineCompose:3};_mcp.bf.registerEnum("_mcp.bf",!1);var IMailComposeComponent=function(){};IMailComposeComponent.registerInterface("IMailComposeComponent");var IMailComposeAccCheckerComponent=function(){};IMailComposeAccCheckerComponent.registerInterface("IMailComposeAccCheckerComponent");_mcp.ce=function(){};_mcp.ce.registerInterface("_mcp.ce");var IMailComposeAttachmentComponent=function(){};IMailComposeAttachmentComponent.registerInterface("IMailComposeAttachmentComponent");var IMailComposeAutoSaveComponent=function(){};IMailComposeAutoSaveComponent.registerInterface("IMailComposeAutoSaveComponent");var IMailComposeCalendaringInfobarComponent=function(){};IMailComposeCalendaringInfobarComponent.registerInterface("IMailComposeCalendaringInfobarComponent");var IMailComposeCommandingBarComponent=function(){};IMailComposeCommandingBarComponent.registerInterface("IMailComposeCommandingBarComponent");var IMailComposeComplianceComponent=function(){};IMailComposeComplianceComponent.registerInterface("IMailComposeComplianceComponent");var IMailComposeContentConversionComponent=function(){};IMailComposeContentConversionComponent.registerInterface("IMailComposeContentConversionComponent");var IMailComposeContextMenuProvider=function(){};IMailComposeContextMenuProvider.registerInterface("IMailComposeContextMenuProvider");var IMailComposeContextMenuComponent=function(){};IMailComposeContextMenuComponent.registerInterface("IMailComposeContextMenuComponent");var IMailComposeDecisionCollabComponent=function(){};IMailComposeDecisionCollabComponent.registerInterface("IMailComposeDecisionCollabComponent");var IMailComposeDiscardComponent=function(){};IMailComposeDiscardComponent.registerInterface("IMailComposeDiscardComponent");var IMailComposeEditorComponent=function(){};IMailComposeEditorComponent.registerInterface("IMailComposeEditorComponent");var IMailComposeExtensibilityComponent=function(){};IMailComposeExtensibilityComponent.registerInterface("IMailComposeExtensibilityComponent");_mcp.cf=function(){};_mcp.cf.registerInterface("_mcp.cf");var IMailComposeHashtagComponent=function(){};IMailComposeHashtagComponent.registerInterface("IMailComposeHashtagComponent");var IMailComposeImportanceComponent=function(){};IMailComposeImportanceComponent.registerInterface("IMailComposeImportanceComponent");var IMailComposeInitializerComponent=function(){};IMailComposeInitializerComponent.registerInterface("IMailComposeInitializerComponent");var IMailComposeLinkPreviewComponent=function(){};IMailComposeLinkPreviewComponent.registerInterface("IMailComposeLinkPreviewComponent");var IMailComposeMailTipsComponent=function(){};IMailComposeMailTipsComponent.registerInterface("IMailComposeMailTipsComponent");var IMailComposeMeetingComponent=function(){};IMailComposeMeetingComponent.registerInterface("IMailComposeMeetingComponent");var IMailComposeMessageOptionsComponent=function(){};IMailComposeMessageOptionsComponent.registerInterface("IMailComposeMessageOptionsComponent");var IMailComposePeopleRecommendationsComponent=function(){};IMailComposePeopleRecommendationsComponent.registerInterface("IMailComposePeopleRecommendationsComponent");var IMailComposeNavigationComponent=function(){};IMailComposeNavigationComponent.registerInterface("IMailComposeNavigationComponent");var IMailComposeOmeComponent=function(){};IMailComposeOmeComponent.registerInterface("IMailComposeOmeComponent");var IMailComposePALGenericAttachmentComponent=function(){};IMailComposePALGenericAttachmentComponent.registerInterface("IMailComposePALGenericAttachmentComponent");var IMailComposePhotoComponent=function(){};IMailComposePhotoComponent.registerInterface("IMailComposePhotoComponent");var IMailComposePolicyTipsComponent=function(){};IMailComposePolicyTipsComponent.registerInterface("IMailComposePolicyTipsComponent");var IMailComposeRecipientComponent=function(){};IMailComposeRecipientComponent.registerInterface("IMailComposeRecipientComponent");var IMailComposeRecipientSummarizationComponent=function(){};IMailComposeRecipientSummarizationComponent.registerInterface("IMailComposeRecipientSummarizationComponent");var IMailComposeSaveComponent=function(){};IMailComposeSaveComponent.registerInterface("IMailComposeSaveComponent");var IMailComposeSendAsContextMenuComponent=function(){};IMailComposeSendAsContextMenuComponent.registerInterface("IMailComposeSendAsContextMenuComponent");_mcp.cg=function(){};_mcp.cg.registerInterface("_mcp.cg");var IMailComposeSendComponent=function(){};IMailComposeSendComponent.registerInterface("IMailComposeSendComponent");var IMailComposeShareAttachmentComponent=function(){};IMailComposeShareAttachmentComponent.registerInterface("IMailComposeShareAttachmentComponent");var IMailComposeSignatureComponent=function(){};IMailComposeSignatureComponent.registerInterface("IMailComposeSignatureComponent");var IMailComposeTouchComponent=function(){};IMailComposeTouchComponent.registerInterface("IMailComposeTouchComponent");var IMailComposeUpgradeComponent=function(){};IMailComposeUpgradeComponent.registerInterface("IMailComposeUpgradeComponent");_mcp.by=function(n,t,i,r,u){this.g=Function.createDelegate(this,this.i);_mcp.by.initializeBase(this,[37,n,i,r]);this.d=u;this.f=t};_mcp.by.prototype={d:null,f:null,c:null,b:null,a:function(){this.c||(this.c=new _j.g(this.g,_a.a.dv));return this.c},bO:function(){if(this.f.a().C().Enabled){var n=new _fm.d(_nbs.a.Xv,null,this.a());return[n]}return null},bQ:function(){if(this.f.a().C().Enabled){var n=_mcp.q.a(this.a(),_nbs.a.Xv);return[n]}return null},bF:function(){return null},bw:function(){if(this.b){this.b.b();this.b.dispose()}this.c&&this.c.dispose();_mcp.q.prototype.bw.call(this)},i:function(){this.bk.eR&&this.bk.eR.a();var t=this.bk.y();if(this.b)this.b.a(t);else if(this.d){var n=this;this.d.a(function(i){n.b=i.a();n.b.c(n.a());n.b.a(t)})}}};_mcp.bz=function(n,t,i,r){this.q=Function.createDelegate(this,this.v);this.m=Function.createDelegate(this,this.w);this.p=Function.createDelegate(this,this.u);_mcp.bz.initializeBase(this,[32,n]);this.l=i;this.d=t;this.k=r};_mcp.bz.prototype={l:null,d:null,k:null,c:null,f:null,h:function(){if(this.e()){_j.e.b(_a.a.a,"MailComposeAtMentionComponent is already initialized, skipping redundant Initialize call.");return}if(this.d&&this.d.c()&&this.k){this.k.a(this.p);this.d.d()&&this.t()}_mcp.I.prototype.h.call(this)},bw:function(){this.c&&this.s();var n;_a.h.a(n={val:this.f}),this.f=n.val;_mcp.I.prototype.bw.call(this)},a:function(){return this.f},b:function(){return!this.d||!this.d.d()},o:function(){if(this.r()){var n=this.bl.a.ba;n.a(10302,null);this.bj.be()}},x:function(){if(this.r()){var n=this.bl.a.ba;n.b(10302);this.bj.be()}},i:function(n){if(this.bk)if(n.c()){this.c.a(n.a(),this.bk.eP);this.o()}else if(this.n()){var i=this.bj.bb().b(0);var t=this.bj.bb().b(1);this.c.b(n,this.bk.eP,i,t)}},j:function(n){if(n.a()&&this.bk){var t=this.bk.eP;if(n.c()){this.c.c(n.a(),t);_cmc.c.h(t)||this.x()}else if(this.n()){var i=this.bj.bb().b(0);this.c.d(n,t,i,_cmc.c.g)}}},g:function(){return this.bk?_cmc.c.f(this.bk.eP):null},u:function(n){this.c=n;this.l.b(_y.cD,this.m)},t:function(){this.f=new _j.g(this.q,_a.a.a);_cmc.c.h(this.bk.eP)&&this.o()},s:function(){this.l.c(_y.cD,this.m);this.c=null},w:function(n){if(this.n()){var t=this.bj.bb().b(0);this.bk&&t&&n.b()===t.v()&&this.c.e(n.a(),this.bk.eP)}},v:function(){var t=_j.h.c("{0}{1}","OWAALLAM",_cmc.h.a());var r=_cmc.c.k("@all",t);var n=new _cmc.o(0,r,!0,7);n.r=!1;n.o=!0;this.bk.cG(n);this.o();this.bk.eP[t]="at-all";var i=new _a.bq(1,"AtAllMention_AddedUsingButton");_a.z.b.a(i)},n:function(){return!!this.bj&&!!this.bj.bb()},r:function(){return!!this.bl&&!!this.bl.a&&!!this.bl.a.ba}};_mcp.m=function(n,t,i,r,u,f,e){this.bB=Function.createDelegate(this,this.ce);this.bd=Function.createDelegate(this,this.cp);this.bi=Function.createDelegate(this,this.cw);this.be=Function.createDelegate(this,this.ct);this.bf=Function.createDelegate(this,this.cu);this.bg=Function.createDelegate(this,this.ca);this.bh=Function.createDelegate(this,this.cv);this.bc=Function.createDelegate(this,this.ci);this.bG=Function.createDelegate(this,this.bZ);this.bT=Function.createDelegate(this,this.cd);this.bQ=Function.createDelegate(this,this.cB);this.bR=Function.createDelegate(this,this.cC);this.bP=Function.createDelegate(this,this.cA);this.bO=Function.createDelegate(this,this.cz);this.bE=Function.createDelegate(this,this.cn);this.bF=Function.createDelegate(this,this.co);this.bI=Function.createDelegate(this,this.cr);this.bH=Function.createDelegate(this,this.cq);this.bJ=Function.createDelegate(this,this.cs);this.bD=Function.createDelegate(this,this.cf);this.p=this.a;_mcp.m.initializeBase(this,[5,n]);this.O=i;this.N=u;this.bn=t;this.C=new _j.g(this.bD,this.bm());this.bx=new _j.g(this.bJ,this.bm());this.bt=new _j.g(this.bH,this.bm());this.bu=new _j.g(this.bI,this.bm());this.I=r;this.U=f;this.F=e;if(this.O){this.br=this.O.a().b().Enabled&&this.O.a().W().Enabled;this.V=this.O.a().eE().Enabled&&_y.c.a.a()==="Mouse"&&!!this.F&&!!this.F.WacEditableFileTypes&&this.F.WacEditableFileTypes.length>0}};_mcp.m.prototype={H:null,O:null,I:null,N:null,bn:null,U:null,br:!1,V:!1,C:null,P:null,bx:null,bt:null,bu:null,bA:null,ba:!1,G:null,E:null,S:!1,F:null,bp:!0,R:null,L:null,bb:!1,Z:null,M:null,T:null,j:function(){this.H||this.bX();return this.H},cF:function(n){if(this.H!==n){this.H=n;this.bv("Menu")}return n},cD:function(n){if(this.R!==n){this.R=n;this.bv("InsertButtonCommand")}return n},cE:function(n){if(this.Z!==n){this.Z=n;this.bv("InsertButtonText")}return n},f:function(){if(!this.P){var n=this;this.P=new _j.u(this.bF,this.bm(),this.bl.a.Z,"BodyType",function(){return n.bl.a.Z.j()==="HTML"})}return this.P},o:function(n){this.bz("AttachmentWellInitialized",n)},v:function(n){this.bM("AttachmentWellInitialized",n)},a:function(){return this.eB(_mcp.m.a)},w:function(n){this.eA(_mcp.m.a,n);return n},b:function(){return this.a()?this.a().k():!1},g:function(){return this.a()&&this.a().a()?this.a().a().x.length>0:!1},r:function(){return this.a()?this.a().o():0},x:function(n){this.bp=n;return n},i:function(){var n=_a.o.a();return n.c()&&this.I.b()},cm:function(){this.T||this.bY();return this.T},cI:function(n){this.T=n;this.bv("NewFileMenu");return n},cl:function(){return!this.V||!!this.E},Y:function(){if(this.bj.cH()&&!this.E){_j.e.a(_a.a.a,"Setting attachment component override");this.E=this.bj.cG().a();this.E.c(this.bE);this.bv("HideNewDocumentMenuButton")}},X:function(){if(this.E){this.E.a();this.E=null;this.bv("HideNewDocumentMenuButton")}},h:function(){var n=this.bk;this.Y();this.bX();this.bY();if(this.a()){var t=n.W();this.a().ce(n.h(),n.q(),t,n.d(),n.bg());this.bV(n,t)}else this.bn.a(this.bO)},cn:function(){return this.a()},cw:function(n,t){t==="EditorCallContext"&&this.bj.bN().a(this.a().bh())},n:function(n){this.bA&&this.bA.a(!n)},ct:function(n){if(_a.br.a){var t=this.bj;_j.m.a().c(_a.a.I,"SafeTriggerPolicyTipsIfNeededForAttachmentAdded",this.bP)}this.bl.a.dF(this.bl.a.cm)},cu:function(){var t=this.bl.a;var n=t.Z;var i=t.bK();var r=!!i&&i.k();if(n.h()){this.bW(n);this.a()&&this.a().f(n.h(),n.q(),n.bg())}else r||t.bj().a("Attach",this.bR,this.bQ,!1)},z:function(){if(!this.ba&&this.a()){var n=this.bl.a.Z;if(_y.c.a.a()==="Mouse")this.a().f(n.h(),n.q(),n.bg());else{_j.e.a(_a.a.a,"Delaying attachment refresh because we're in not in mouse layout.");this.a().bG(n.h(),n.q(),n.bg(),this.bT)}this.cd();this.bl.a.bf.a(_y.ea,new _y.ea);this.ba=!0}},q:function(){this.bb||(this.bk.g()?this.bZ():this.bj.fr(this.bG))},t:function(n){this.a()&&this.a().L(n)},y:function(n){if(this.I.b()){this.M=n;this.M.i(this.bc)}},cM:function(){if(this.M){this.M.l(this.bc);this.M=null}},ci:function(n){if(this.g()&&_zz.m.isInstanceOfType(n.d())){var t=n.d();t.cj()||this.cy(t.A())}},cy:function(n){if(n)for(var r=this.k(),i=r.x.length-1;i>=0;i--){var t=r.x[i];if(t.a().b()&&t.b()){var u=n.querySelectorAll(String.format('img[originalSrc="cid:{0}"]',t.a().bB.ContentId));u.length||this.m(t,!1)}}},cd:function(){var n=this.bl.a.Z;if(n.eO)if(n.q()){var t=new _j.l;t.m(n.q().d());n.eO.p(t);n.eN()&&n.eN().p(t)}else{n.eO.p(null);n.eN()&&n.eN().p(null)}},s:function(){var n=[];var t=this.bl.b(13);var i=this.bl.b(20);if(t){t.a().b&&Array.add(n,new _y.h(_u.P.p,t.a()));t.b().b&&Array.add(n,new _y.h(_u.P.Q,t.b()));this.Q()&&Array.add(n,new _y.h(this.K(),this.C))}else i?Array.add(n,new _y.h(this.K(),i.a())):_a.o.a().B()&&Array.add(n,new _y.h(this.K(),this.C));return n},l:function(){var n=new _j.q;var t=this.bl.b(13);var i=this.bl.b(20);if(t){t.a().b&&n.c(new _fm.d(_u.P.p,null,t.a(),!1,null,_u.P.L));t.b().b&&n.c(new _fm.d(_u.P.Q,null,t.b(),!1,null,_u.P.C));this.Q()&&n.c(new _fm.d(this.K(),null,this.C,!1,null,this.W()))}else i?n.c(new _fm.d(this.K(),null,i.a(),!1,null,this.W())):_a.o.a().B()&&n.c(new _fm.d(this.K(),null,this.C,!1,null,this.W()));return n},A:function(){var n=this.bl.a.Z;if(!_j.h.a(n.bC())&&!this.S&&n.h()&&this.a()){this.S=!0;var t=!1;try{this.a().bC(n.bC(),this.bh,this.bg);t=!0}finally{t||(this.S=!1)}}},B:function(n){this.U&&this.a()&&this.U.a(this.a(),this.bm()).b(n)},k:function(){return this.a().a()},m:function(n,t){this.a().l(n,t)},cf:function(){var t=this.bl.a;var i=t.Z;_j.e.a(_a.a.a,"Insert attachment start");if(this.a())if(this.E)this.E.b(!1);else if(this.Q()){var n=_a.c.b(_a.a.b,"AttachmentsFilePickerPanelOpen");_j.e.a(_a.a.a,"Opening OWA's file picker");this.cc(n,0)}else{_j.e.a(_a.a.a,"Opening OS's file picker");this.a().h(!1,null,null)}this.bj.bi().a("AttachFile");_j.e.a(_a.a.a,"Insert attachment end")},cp:function(n,t){this.a()&&this.a().cm(this.bj.bj().c())},bY:function(){if(!this.T&&this.V){var i=new _fm.d(_nbs.a.mN,_b.i.n(),this.bx,!1,null,_nbs.a.mN);var t=new _fm.d(_nbs.a.tO,_b.i.v(),this.bt,!1,null,_nbs.a.tO);var n=new _fm.d(_nbs.a.pR,_b.i.s(),this.bu,!1,null,_nbs.a.pR);i.w(t.w(n.w("MailInlineComposeView.Mouse.NewFileMenuItemLineTemplate")));this.cI(new _fm.f([i,t,n]))}},cs:function(){this.bs(0)},cq:function(){this.bs(1)},cr:function(){this.bs(2)},bs:function(n){_j.e.a(_a.a.a,"New document start");this.a()&&this.a().bp(n,this.bj.Z.j()==="Text",!1);_j.e.a(_a.a.a,"New document end")},co:function(){var t=this.bl.a;var i=t.Z;_j.e.a(_a.a.a,"Insert picture start");if(this.a()){if(this.E)this.E.b(!0);else if(this.br){var n=_a.c.b(_a.a.b,"AttachmentsFilePickerPanelOpen");this.cc(n,1)}else this.a().h(!0,null,null);this.bj.bi().a("InsertPicture")}_j.e.a(_a.a.a,"Insert picture end")},bw:function(){var n=this.a();if(n){n.N(this.bf);n.A(this.be);n.rpcl("EditorCallContext",this.bi);this.bj.bj().rpcl("IsSaving",this.bd);this.a().bs(this.bj.dk);n.dispose();this.w(null)}this.G=null;var r;_a.h.a(r={val:this.P}),this.P=r.val;var i;_a.h.a(i={val:this.C}),this.C=i.val;this.R=null;var t;_a.h.a(t={val:this.H}),this.H=t.val;this.ba=!1;this.X();this.cM();this.bo(0);_mcp.I.prototype.bw.call(this)},bX:function(){if(!this.H){var n=[];var t=new _fm.d(this.K(),null,this.C,!1,null,this.W());Array.add(n,t);this.cD(this.C);this.cE(_nbs.a.Uz);this.bj.bk()||this.cF(new _fm.f(n))}},bV:function(n,t){this.a().cl(!n.m());_j.e.a(_a.a.a,"Attachment component initialized, ReadOnly={0}",t);n.m()&&this.z();this.cL(n);this.ch(n);_mcp.I.prototype.h.call(this)},cz:function(n){var t=this.bk;var i=this.bj;if(this.bq()){_j.e.a(_a.a.a,"InitializeAttachmentWell is exiting early due to null context and/or view model disposing.");return}var h=t.W();var o=!((t.a()===4||t.a()===13)&&!this.I.b());var r=i.bb();var e=!!r.c().a||!!r.g().a||!!r.o().a;if(_y.c.a.a()==="TouchNarrow")this.w(n.a(t.h(),t.q(),t.W(),o,t.bg(),!0,i.ba,t.d(),e));else{var u=n.b(t.h());u.f(t.P());u.k(1);var f=t.V();var s=f?f.EmailAddress:null;this.w(n.c(u,t.q(),t.W(),_y.c.a.a()==="Mouse"?3:0,o&&this.bp,t.bg(),!0,i.ba,t.d(),i.bA,i.dI,i.bM,s,e))}this.a().w(this.bf);this.a().v(this.be);this.a().apcl("EditorCallContext",this.bi);this.a().bb(i.dk);this.bj.bj().apcl("IsSaving",this.bd);this.bN("AttachmentWellInitialized",this);this.bV(t,h);i.dF(this.bl.a.cm)},ch:function(n){if(n&&this.a()&&n.a()===3&&this.a().x()){var t=_a.c.b(_a.a.b,"IntentToForwardReferenceAttachment");_a.c.a(t)}},bW:function(n){n.q()||n.U(new _j.l)},cC:function(n){var i=this.bl.a;var t=i.Z;if(n.Y===t.d()){this.bW(t);this.a()&&this.a().f(t.h(),t.q(),t.bg());this.A()}},cB:function(n){var t=this.bl.a;var i=t.Z;if(this.a()&&n.Y===i.d()){this.a().O();t.bh.p||t.bh.g(0,_nbs.a.rE,null);this.A()}},cc:function(n,t){if(this.N){var i=this;this.N.a(function(r){i.G=r;i.G.d(!i.F.AttachmentDataProviderAvailable&&i.F.GroupsOneDriveDataProviderAvailable);i.G&&i.G.a(i.a(),n,!1,i.bl.a.bM,i.bl.a.bA,i.bj.Z.j()==="Text",t)})}},u:function(){if(this.Q()&&this.N){var n=this;this.N.a(function(t){n.G=t;n.G&&n.G.c()})}},Q:function(){return!this.bk.R()&&!!this.I&&!!this.F&&this.I.j(this.F.AttachmentDataProviderAvailable||this.F.GroupsOneDriveDataProviderAvailable)},cv:function(n){this.bl.a.Z.cF(null);this.ca(n)},ca:function(n){n.A(this.bh);n.bb(this.bg);this.S=!1},K:function(){return this.Q()?_u.P.m:_u.P.A},W:function(){return this.Q()?_u.P.Z:_u.P.E},bZ:function(){if(this.bk){this.bj.ba.b(10301);var n=this.bk.g();if(_g.i.isInstanceOfType(n)&&!n.bx()&&n.bB.HasAttachments&&this.bk.gO()){var f=this.bj.fl().a(n);if(!f.length)return;for(var u=0,r=0;r<n.ex().b();r++){var t=n.ex().c(r);if(!t.b()||_dg.b.isInstanceOfType(t)){_j.e.a(_a.a.a,"Found attachments from original item to be added: {0}, show infobar.",t.bB.Name);u++}}if(u>0){this.L=new _cmc.g(_a.a.a,"AddOriginalAttachment",!1);var i=this;var e=new _mcp.N(f,u,this.bB,function(){i.bb=!0;i.bj.ba.b(10301);i.bo(-1)});this.bj.ba.d(10301,e,null)}}}},ce:function(){this.bb=!0;this.bj.ba.b(10301);var t=this.bk.g();if(t){for(var i=new _j.q,r=0;r<t.ex().b();r++){var n=t.ex().c(r);if(n.b()&&!_dg.b.isInstanceOfType(n)){_j.e.a(_a.a.a,"Skip adding original attachment: {0}. IsInline: {1}",n.bB.Name,n.b());continue}var u=new _db.F(n,t.bB.ItemId.Id);i.c(u);_j.e.a(_a.a.a,"Original attachment '{0}' added to the collection.",n.bB.Name)}if(i.d.length>0){this.B(i);this.bo(i.d.length)}}},bo:function(n){if(this.L){this.L.a("A",n,!0,!0);this.L.b();this.L=null}},cA:function(){_mcp.I.a(this.bj,8)},cL:function(n){n.bz()&&n.bz().x.length>0&&this.a().S(new _h.bQ(n.bz().d()))}};_mcp.V=function(n,t,i,r,u){this.C=Function.createDelegate(this,this.bh);this.M=Function.createDelegate(this,this.bi);this.N=Function.createDelegate(this,this.bn);this.E=Function.createDelegate(this,this.bp);_mcp.V.initializeBase(this,[n,t,i,r,u])};_mcp.V.prototype={p:null,h:function(){var n=this.bj;var t=n.Z;_j.e.a(_a.a.a,"Enabling timer during initialization of auto save component");this.p=this.bo();this.p.b=!0;if(!t.bn()){this.br();_j.e.a(_a.a.a,"Auto save timer started")}_mcp.z.prototype.h.call(this);n.bf.b(_a.cH,this.E)},bh:function(){var r=this.bj;var n=r.Z;if(!this.cb&&!n.bn()){if(!n.bI()){_j.e.a(_a.a.a,"Auto Save not supported for the current operation {0}",n.a());return}var u=this.bj.bc();_j.e.a(_a.a.a,"Checking dirty before auto save");var t=r.bX();var i=u.b();if(t&&!i){_j.e.a(_a.a.a,"AutoSave");this.p.e();this.a("AutoSave",this.N,this.M,!1)}else{this.p.c();_j.e.a(_a.a.a,"Skip auto save since IsDirty={0}, AttachmentInProgress={1}",t,i)}}},br:function(){var n=this.bl.a.Z;!n.bn()&&n.bI()&&this.p.c()},k:function(){this.p&&this.p.h()},bw:function(){this.k();this.bj.bf.c(_a.cH,this.E);_mcp.z.prototype.bw.call(this)},bo:function(){return new _mcp.bW(this.C,this.F())},F:function(){return 6e4},L:function(n){_mcp.z.prototype.L.call(this,n);this.n&&n==="AutoSave"&&this.n.n(_mcp.V.a)},bp:function(n){_j.m.a().c(_a.a.a,"Autosave triggered for PAL OnPause event",this.C)},bn:function(n){var i=this.bl;var r=i.a;var t=r.Z;t.dU(!0);t.bn()||this.p.c()},bi:function(n){_j.e.a(_a.a.a,"AutoSaveActionFailed: Error: {0}",n.I.message);this.bl.a.Z.bn()||this.p.c()}};_mcp.y=function(n,t,i,r){this.z=Function.createDelegate(this,this.Z);this.r=Function.createDelegate(this,this.W);this.s=Function.createDelegate(this,this.X);this.t=Function.createDelegate(this,this.Y);_mcp.y.initializeBase(this,[0,n]);this.y=t;this.u=i;this.v=r;this.i=new _a.k};_mcp.y.prototype={u:null,v:null,i:null,l:null,k:null,o:null,p:null,q:null,m:null,d:null,B:null,y:null,w:0,g:null,b:function(){return this.B},a:function(){return this.d},ba:function(n){if(this.d!==n){this.d=n;this.bv("ComposeCommandingBar")}return n},F:function(){return this.bk.R()?this.bj.bg().a():this.bj.bg().o()},I:function(){return this.bj.bp().a()},T:function(){return this.bj.bm().j()},O:function(){return this.bj.bl().b()},Q:function(){return this.bj.bj().j()},n:function(){return this.bj.bc().j()},x:function(){this.q||(this.q=new _fm.g(this.T(),_u.P.N,_mcp.e.t(),0,null,_mcp.e.u(),!1,!1,!1,!1));return this.q},S:function(){this.l||(this.l=this.bk.R()?new _fm.g(this.F(),_u.P.h,_mcp.e.L(),0,null,null,!1,!1,!1,!1):new _fm.g(this.F(),_u.P.D,_mcp.e.N(),0,null,null,!1,!1,!1,!1));return this.l},K:function(){this.m||(this.m=new _fm.g(this.I(),_u.n.Oo,null,0,null,null,!1,!1,!1,!1));return this.m},L:function(){if(!this.k)if(this.n().p.x.length>1){var n=this;this.k=new _fm.l(_nbs.a.Fu,function(t){t(n.n())},0,_nbs.a.Fu,!1,!1,_mcp.e.j(),null,!1)}else this.n().p.x.length===1&&(this.k=new _fm.g(this.n().p.x[0].k,_nbs.a.Uz,_mcp.e.j(),0,null,null,!1,!1,!1,!1));return this.k},P:function(){this.o||(this.o=new _fm.g(this.O(),null,_mcp.e.J(),0,_u.n.CI,null,!0,!1,!1,!1));return this.o},R:function(){this.p||(this.p=new _fm.g(this.Q(),null,_mcp.e.z(),0,_u.n.SC,null,!0,!1,!1,!1));return this.p},N:function(){return this.u.k()},M:function(){if(!this.bj||!this.bj.bn)return!1;var i=!!this.bj.bn.a().l()&&this.bj.bn.a().l().Enabled;var t=!!this.bj.bn.a().i()&&this.bj.bn.a().i().Enabled;var n=!!this.bj.bn.a().k()&&this.bj.bn.a().k().Enabled;return i||t||n||this.E()},C:function(){return!!this.bj&&!!this.bj.bn&&!!this.bj.bn.a()&&!!this.bj.bn.a().i()&&this.bj.bn.a().i().Enabled},E:function(){return!!this.bj&&!!this.bj.bn&&!!this.bj.bn.a()&&!!this.bj.bn.a().e()&&this.bj.bn.a().e().Enabled},h:function(){if(this.e()){_j.e.a(_mcp.y.a,"Commanding bar component is already initialized, skipping redundant Initialize call.");return}if(!this.bj.bk()){_j.e.a(_mcp.y.a,"Initializing compose commanding bar");this.ba(new _fm.k(_u.R.Tw,_u.R.Tw,_u.R.Gt));this.d.Z=!0;this.d.K=!0;this.d.t=!0;this.j(this.S(),!0);this.j(this.L(),!0);this.bk.l()===3||this.M()&&(!this.bj.bq()||this.E())||this.j(this.x(),!1);this.j(this.K(),!0);this.C()&&this.U();(this.y.a||this.bj.bq())&&!this.bk.dn()&&this.j(this.R(),!0);this.bl.a.apcl("ShouldShowToolbarMessage",this.t);if(this.bj.bt().e()){_j.e.a(this.bm(),"Primary init is complete; creating commanding bar affordance menu synchronously.");this.A()}else{_j.e.a(this.bm(),"Scheduling commanding bar affordance menu creation because primary initialization has not finished.");this.bj.bt().apcl("IsInitialized",this.s)}this.bl.a.bq()||this.bl.a.Z.l()===3||this.j(this.P(),!0);this.d.bb();this.G(this.bj.bm().m());this.c(0);_j.e.a(_mcp.y.a,"Completed initializing compose commanding bar")}_mcp.I.prototype.h.call(this)},c:function(n){if(this.d){var u=this.bj.bq();var r=this.N();var t;var i;if(u){t=0;i=0}else{t=r?20:n;i=r?n:20}this.d.bB(t);this.d.be(i)}},bw:function(){this.bl.a.rpcl("ShouldShowToolbarMessage",this.t);this.g&&this.g.rpcl("ComposeItems",this.r);var n;_a.h.a(n={val:this.d}),this.d=n.val;_mcp.I.prototype.bw.call(this)},A:function(){_j.e.a(_mcp.y.a,"Adding affordance items to compose commanding bar");var n=new _j.q;this.f(n,8);this.f(n,11);this.f(n,1);this.f(n,28);this.f(n,6);this.f(n,3);this.f(n,15);this.f(n,9);this.f(n,37);for(var t=0;t<n.d.length;t++)this.d.a(n.d[t]);var i=n.d[0];i?_j.e.a(_mcp.y.a,"Completed added affordance items to compose commanding bar"):_j.e.b(_mcp.y.a,"Affordance menu item at index 0 is null.")},f:function(n,t){var r=null;var i=this.bl.b(t);if(i&&IMailComposeContextMenuProvider.isInstanceOfType(i)){_j.e.a(_a.a.a,"Getting affordance menu items for type '{0}', IsInitialized = {1}",Object.getType(i).getName(),i.e());i.e()||i.h();r=i;n.h(r.P())}},j:function(n,t){if(!this.d.bx(n)){n.b(!0);n.c(t);this.d.a(n)}},V:function(n,t){if(this.d&&!this.d.bx(t)){t.b(!0);t.c(!0);this.d.bc(n,t)}},Y:function(n,t){var i=!this.bl.a.cc;this.bb(i)},bb:function(n){if(this.d)for(var r=this.d.b.x.length,t=0;t<r;t++){var i=this.d.b.x[t];i&&i.e!==1&&i.b(n)}},G:function(n){this.d&&!this.d.cb&&this.d.bx(this.x())&&this.x().c(n)},X:function(n,t){this.bj.bt().rpcl("IsInitialized",this.s);_j.m.a().c(_a.a.a,"AddAffordanceMenuItemsToComposeCommandingBar",this.z)},Z:function(){if(!this.cb&&this.d&&!this.d.cb&&this.d.b){this.d.t=!0;this.A();this.d.bb()}else _j.e.a(this.bm(),"OnInitializerComponentPrimaryInitCompleted - commanding bar or its item collection is null, skipping affordance async init.")},U:function(){if(this.C()&&this.bj&&!this.bj.bq()&&this.bk.l()!==3){this.w=this.d.b.x.length;var n=this;this.v.a(function(t){if(t.f()&&!n.bq()){n.g=t;n.H();t.apcl("ComposeItems",n.r)}})}},H:function(){if(this.g&&this.g.a()){for(var t=0;t<this.i.b();t++)this.d.bd(this.i.a(t));this.i.l();for(var i=this.g.a(),n=0;n<i.b();n++){this.V(this.w+n,i.a(n));this.i.c(i.a(n))}}},W:function(n,t){this.H()}};_mcp.E=function(n,t,i,r){this.x=Function.createDelegate(this,this.I);this.y=Function.createDelegate(this,this.K);this.s=Function.createDelegate(this,this.F);this.z=Function.createDelegate(this,this.w);_mcp.E.initializeBase(this,[3,n,i,r]);this.E=t;this.k=!1};_mcp.E.b=function(n,t){return new _y.h(n,t)};_mcp.E.c=function(n,t){return new _fm.d(n,null,t,!0)};_mcp.E.prototype={E:null,p:null,j:null,o:null,m:null,n:!1,r:null,i:null,l:null,b:function(){return"IsIrmProtected"},g:null,f:null,a:function(){return this.n},q:function(n){if(this.n!==n){this.n=n;this.bv("IsIrmProtected")}return n},d:function(){return this.r},H:function(n){if(this.r!==n){this.r=n;this.bv("ShowIrmInformationCommand")}return n},c:function(){return this.i},G:function(n){if(this.i!==n){this.i=n;this.bv("DialogViewModel")}return n},k:!1,u:function(){var i=_g.a.a();if(i.e()&&!i.e().bB.Irm||this.bV.b()){_j.e.a(_a.a.a,"IRM segmentation flag has been turned off or user is consumer, cannot set compliance.");return!1}var n=this.bl.a.Z.F();var t=!n||!!n.a()||n.b()||n.l();_j.e.a(_a.a.a,"CanSetCompliance={0}",t);return t},v:function(){return!this.bk.R()&&this.u()&&!this.bj.bk()},h:function(){var n=this.bj;var u=n.Z;var o=n.ev;var r=n.br;if(this.u())if(_g.k.b){_j.e.a(_a.a.a,"Checking main window for compliance configuration");this.f=_mcp.E.a;_g.k.b.jR(this.z)}else if(r.WasLoadedFromServer)this.w(r);else{_j.e.a(_a.a.a,"Adding the loading permissions menu item");this.f=_mcp.E.a;if(!r.IsLoadingFromServer){_j.e.a(_a.a.a,"Submitting GetComplianceConfigurationAction");var e=n.bf;e.b(_a.cx,this.s);var s=new _h.cb(r,n.bf);s.i()}}else if(this.f&&this.k&&o.a){n.ev.t(this.f);this.k=!1}var t=u.F();this.q(!!t&&!t.a());if(this.n&&"Mouse"===_y.c.a.a()){var i=n.bz();i.a.apply(i,[4499].concat([t.bB.TemplateName,t.bB.TemplateDescription]));i.a.apply(i,[4500].concat([t.bB.ContentOwner]))}else if(u.bp()){var f=n.bz();f.a.apply(f,[3800].concat([u.cn(),u.co()]))}"Mouse"===_y.c.a.a()||this.r||this.H(new _j.g(this.y,this.bm()));_mcp.q.prototype.h.call(this)},bw:function(){this.bj.bf.c(_a.cx,this.s);var t;_a.h.a(t={val:this.i}),this.i=t.val;var n;_a.h.a(n={val:this.l}),this.l=n.val;this.q(!1);_mcp.q.prototype.bw.call(this)},bO:function(){if(this.v()){!this.g&&this.bj.br.WasLoadedFromServer&&this.t();if(this.g){this.j=new _fm.j(_nbs.a.qM,null,this.g);return[this.j]}else if(this.u()&&this.bj.br.IsLoadingFromServer){this.j=new _fm.j(_nbs.a.qM,null,null);this.j.a(!0);this.p=new _fm.d(_u.P.g,null,null);return[this.p,this.j]}else _j.e.b(_a.a.a,"Compliance sub-menu creation has been skipped.")}return null},bQ:function(){if(this.v()){var n=this;this.m=new _fm.l(_nbs.a.qM,function(t){t(n.g)},1,null,!1,!1,null,null,!1);if(this.g)return[this.m];else if(this.u()&&this.bj.br.IsLoadingFromServer){this.m.b(!1);this.o=_mcp.q.a(null,_u.P.g);return[this.m,this.o]}}return null},bF:function(){if(this.v())return[this.f];else{this.k=!1;return null}},ce:function(){this.o&&this.o.b(!1);if(!this.g&&this.bj.br.WasLoadedFromServer){this.t();this.g||(this.m=null)}this.m&&this.m.b(!0)},ca:function(){this.p&&this.p.a(!0);if(!this.g&&this.bj.br.WasLoadedFromServer){this.t();this.g||(this.j=null)}if(this.j){this.j.C(this.g);this.j.a(!1)}},cy:function(){this.f&&this.bj.ev&&this.bj.ev.t(this.f);this.f=null;this.k=!1;this.t()},C:function(n){var t=this.bl.a.br;var e=t.RmsTemplates?t.RmsTemplates.length:0;var o=t.MessageClassifications?t.MessageClassifications.length:0;if(0===e&&0===o){_j.e.a(_a.a.a,"There are neither RmsTemplates nor message classifications available, skip setup of the compliance sub context menu.");return null}var i=new Array(1+e+o);var f=0;i[f++]=n(_nbs.a.q,new _j.g(this.x,this.bm()));for(var u=0,r=0;u<e||r<o;)if(u===e){var c=t.MessageClassifications[r++];i[f++]=n(c.Name,new _j.g(this.A(c.Id),this.bm()))}else if(r===o){var l=t.RmsTemplates[u++];i[f++]=n(l.Name,new _j.g(this.B(l.Id),this.bm()))}else{var s=t.MessageClassifications[r];var h=t.RmsTemplates[u];if(0<h.Name.localeCompare(s.Name)){i[f++]=n(s.Name,new _j.g(this.A(s.Id),this.bm()));r++}else{i[f++]=n(h.Name,new _j.g(this.B(h.Id),this.bm()));u++}}return i},t:function(){if("Mouse"===_y.c.a.a()||_y.c.a.a()==="TouchNarrow"){var i=this.C(_mcp.E.c);i&&(this.g=new _fm.f(i))}else if(!this.k){if(!this.f){var t=this.C(_mcp.E.b);t&&(this.f=new _y.h(_nbs.a.qM,null,t))}var n=this.bj.ev;if(this.f&&n){var r=n.a;if(r){this.cl=[this.f];this.bj.bI().b();this.k=!0}}}},F:function(n){if(!this.bq()){var t=this.bl.a;this.w(t.br);t.bf.c(_a.cx,this.s)}},w:function(n){var t=this.bj;t.br=n;_j.e.a(_a.a.a,"Updating menu with complete compliance configuration.");n.WasLoadedFromServer&&this.bt()},I:function(){var i=this.bl.a;var n=i.Z;i.bi().a(_mcp.be.toString(0));_j.e.a(_a.a.a,"Set no restriction");n.bZ("0");var t=i.bz();if(n.F()){if("Mouse"===_y.c.a.a()){t.b(4499);t.b(4500)}n.ch(null);this.q(!1)}else if(n.bp()){t.b(3800);n.cc(!1);n.bW(null);n.bX(null);n.bY(null)}},B:function(n){var t=this;return function(){var h=new _cmc.g(_a.a.a,"MailComposeSetIRM",!0);var e=t.bl.a;var r=e.Z;r.bZ(n);if(r.bp()){e.ba.b(3800);t.bj.be();r.cc(!1);r.bW(null);r.bX(null);r.bY(null)}for(var s=e.br.RmsTemplates,o=0;o<s.length;o++){var u=s[o];if(n.toLowerCase()===u.Id.toLowerCase()){var c="Permission_"+u.Id.toLowerCase();e.bi().a(c);var i=new _g.cJ;i.u(n);i.r(_g.a.a().c().bB.UserEmailAddress);i.s(!0);i.t(0);i.w(u.Name);i.v(u.Description);i.q(r.j());r.ch(i);if("Mouse"===_y.c.a.a()){var f=e.bz();f.b(4499);f.b(4500);f.a.apply(f,[4499].concat([u.Name,u.Description]));f.a.apply(f,[4500].concat([i.bB.ContentOwner]))}t.q(!0);_j.e.a(_a.a.a,"Set IRM {0}",u.Name);break}}h.b()}},A:function(n){var t=this;return function(){var u=t.bl.a;var r=u.Z;r.bZ(n);if(r.F()&&"Mouse"===_y.c.a.a()){var s=u.bz();s.b(4499);s.b(4500);r.ch(null);t.q(!1)}for(var o=u.br.MessageClassifications,f=0;f<o.length;f++){var i=o[f];if(n.toLowerCase()===i.Id.toLowerCase()){var h="Classification_"+i.Id.toLowerCase();u.bi().a(h);r.cc(!0);r.bW(i.Name);r.bX(i.Description);r.bY(i.Id);var e=u.bz();e.b(3800);e.a.apply(e,[3800].concat([i.Name,i.Description]));_j.e.a(_a.a.a,"Set class {0}",i.Name);break}}}},K:function(){var t=this.bl.a.Z;if(t.F()){var n=t.F();this.L(n.bB.TemplateName,n.bB.TemplateDescription,n.bB.ContentOwner)}else _j.e.c(_a.a.a,"ShowIrmInformation was triggered without pre-existing license data or compliance entry selected.")},L:function(n,t,i){if(!this.i){this.G(new _bc.l);this.i.n.a(new _ff.d(this.i.o,_nbs.a.TZ,null,!0,!1))}this.i.q(n);this.l||(this.l=new _mcp.bh);this.l.d(t);this.l.c(String.format(_nbs.a.eZ,i));this.i.s(this.l);this.i.f(!0)}};_mcp.I=function(n,t){this.dF=Function.createDelegate(this,this.em);this.cG=Function.createDelegate(this,this.en);_mcp.I.initializeBase(this);this.dG=n;this.bl=t;if(t&&t.a){this.bj=t.a;this.bk=this.bj.Z;this.bU=this.bj.ba}};_mcp.I.a=function(n,t){n&&!n.fd&&n.dd().a(t)};_mcp.I.prototype={dG:0,bl:null,bj:null,bk:null,bU:null,df:!1,e:function(){return this.df},ck:function(n){this.df=n;return n},bm:function(){return _a.a.a},bq:function(){return this.cb||!this.bk||!this.bj||this.bj.fd},h:function(){this.ck(!0)},cH:function(n){var i=this.cx(n);this.bj.dZ(i);if(i===55||i===50){var t=this;this.bj.cO.a(function(n){if(!t.bq()){n.a(t.bU);t.bj.be()}})}else this.bj.be()},en:function(n){this.bU.g(n);this.bj.be()},em:function(n,t){for(var u=[],i=2;i<arguments.length;++i)u[i-2]=arguments[i];var r;(r=this.bU).k.apply(r,[t,n].concat(u));this.bj.be()},bw:function(){this.ck(!1);_j.Q.prototype.bw.call(this)},cj:function(){this.bU.n();this.bU.f(_mcp.z.b);this.bU.f(_mcp.s.a);this.bU.f(_mcp.t.b);var n=this;this.bj.cO.a(function(t){if(!n.bq()){t.b(n.bU);n.bj.be()}})},cx:function(n){throw Error.notImplemented(String.format("GetErrorInfoBarMessageId is not implemented for type {0}",Object.getType(this)));},dg:function(n,t,i,r){t.val=r;i.val="";if(n)if(_g.R.a(n)){t.val=_g.R.b(n);i.val=n.FaultMessage}else if(_g.J.isInstanceOfType(n)){t.val=n.responseCode;i.val=n.toString()}else Error.isInstanceOfType(n)&&(i.val=n.message)}};_mcp.bB=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht){this.f=Function.createDelegate(this,this.k);this.i=Function.createDelegate(this,this.p);this.g=Function.createDelegate(this,this.m);this.h=Function.createDelegate(this,this.o);this.c=[];this.e=new _mcp.bA(this,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht);this.a=n};_mcp.bB.prototype={e:null,c:null,a:null,b:function(n){var t=n;this.c[t]||(this.c[t]=this.e.w(n,this.a.bv.a(),this.a.Z.l()));return this.c[t]},n:function(){this.d(this.h)},dispose:function(){this.d(this.g,!0);this.c.length=0;this.c=null;this.a=null},q:function(){_j.e.a(_a.a.a,"Component Map set override start.");this.d(this.i);_j.e.a(_a.a.a,"Component Map set override end.")},l:function(){_j.e.a(_a.a.a,"Component Map clear override start.");this.d(this.f);_j.e.a(_a.a.a,"Component Map clear override end.")},d:function(n,t){if(!!t===t&&t)for(var i=this.c.length-1;i>=0;i--)this.j(n,i);else for(var r=0;r<this.c.length;r++)this.j(n,r)},j:function(n,t){var i=this.c[t];i&&n(i,t)},o:function(n,t){IMailComposeInitializerComponent.isInstanceOfType(n)||n.e()||n.h()},m:function(n,t){var i=Object.getType(n).getName();if(n.cb)_j.e.b(_a.a.a,"Skip component '{0}' at index {1} because it is already disposing.",i,t);else{_j.e.a(_a.a.a,"Disposing component '{0}' at index {1}...",i,t);try{n.dispose()}catch(r){_j.e.d(_a.a.a,r,"Exception in MailComposeComponentMap trying to dispose component '{0}'",i)}}},p:function(n,t){IMailComposeOverridable.isInstanceOfType(n)&&n.Y()},k:function(n,t){IMailComposeOverridable.isInstanceOfType(n)&&n.X()}};_mcp.bC=function(n,t,i,r){this.l=Function.createDelegate(this,this.q);this.j=Function.createDelegate(this,this.o);this.k=Function.createDelegate(this,this.p);_mcp.bC.initializeBase(this,[15,n,i,r]);this.i=t};_mcp.bC.prototype={a:null,b:null,d:null,c:null,g:null,f:null,i:null,h:function(){this.b||(this.b=new _j.g(this.k,this.bm()));this.a||(this.a=new _j.g(this.j,this.bm()));_mcp.q.prototype.h.call(this)},bw:function(){var t;_a.h.a(t={val:this.b}),this.b=t.val;var n;_a.h.a(n={val:this.a}),this.a=n.val;this.i=null;_mcp.q.prototype.bw.call(this)},bO:function(){if(this.bj.bk())return null;this.d=new _fm.d(_nbs.a.dA,null,this.b);this.c=new _fm.d(_nbs.a.fR,null,this.a,!0);this.bt();return[this.d,this.c]},bQ:function(){this.g=_mcp.q.a(this.b,_nbs.a.dA);this.f=_mcp.q.a(this.a,_nbs.a.fR);this.bt();return[this.g,this.f]},bF:function(){return null},ca:function(){if(this.c&&this.d){this.c.a(this.bk.j()==="HTML");this.d.a(this.bk.j()!=="HTML")}},ce:function(){this.f.b(this.bk.j()!=="HTML");this.g.b(this.bk.j()==="HTML")},p:function(){_j.e.a(this.bm(),"User chose to convert to plain text");this.bl.a.bi().a("SwitchToPlain");if(this.n(_nbs.a.Qg)){this.bl.a.Z.bD().a();var r=this.bl.a.Z.y();var n;var i,t;var f=(t=_a.A.g(r,i={val:n}),n=i.val,t);if(!f){n=r;_j.e.a(this.bm(),"Using html due to failed conversion")}if(n.length>0){var u=this.bl.a.bh;u.h(1,[_nbs.a.YB],this.l,!1,null,null,null,this.i,null)}else this.m()}},q:function(n,t){n&&this.m()},m:function(){var n=this.bl.b(5);n.n(!1);n.a()&&n.a().cs();this.bl.a.Z.i("Text");this.bt();_j.e.a(this.bm(),"MailComposeContentConversionComponent.ToPlainText succeeded.")},o:function(){_j.e.a(this.bm(),"User chose to convert to html");this.bl.a.bi().a("SwitchToHTML");if(this.n(_nbs.a.SA)){var t=this.bl;var r=t.a;var i=r.Z;i.i("HTML");this.bt();var n=this.bl.b(5);n.n(!0);n.a()&&n.a().bV();_j.e.a(this.bm(),"MailComposeContentConversionComponent.ToHtml succeeded.")}},n:function(n){_j.e.a(this.bm(),"Checking if the email has been upgraded which is a pre-requisite of content conversion.");if(!this.bl.a.Z.m()){this.bl.a.bh.g(0,n,null);_j.e.a(this.bm(),"Conversion is not available because the email has not yet been upgraded.");return!1}if(!this.bl.a.Z.bq()){this.bl.a.bh.g(0,n,null);_j.e.a(this.bm(),"Conversion is not available when content is being loaded in editor.");return!1}var t=this.bl.b(5);if(t.a()&&t.a().x()){this.bl.a.bh.g(0,_nbs.a.cb,null);_j.e.a(this.bm(),"Conversion is not available because the email has reference attachments.");return!1}return!0}};_mcp.J=function(n){_mcp.J.initializeBase(this,[16,n])};_mcp.J.prototype={a:function(){return this.eB(_mcp.J.a)},f:function(n){this.eA(_mcp.J.a,n);return n},h:function(){if(this.e()){_j.e.a(_a.a.a,"Context menu component is already initialized, skipping redundant Initialize call.");return}var n=this.d();if(n&&n.d.length>0){_j.e.a(_a.a.a,"Creating context menu items.");this.f(new _fm.f(n.i()))}_mcp.I.prototype.h.call(this)},d:function(){var n=new _j.q;if("Mouse"===_y.c.a.a()){this.b(n,8);this.b(n,11);this.b(n,1);this.b(n,28);this.b(n,6);this.b(n,3);this.b(n,15);this.b(n,9);this.b(n,2);this.b(n,37)}return n},bw:function(){if(this.a()){this.a().dispose();this.f(null)}_mcp.I.prototype.bw.call(this)},b:function(n,t){var r=null;var i=this.bl.b(t);if(i&&IMailComposeContextMenuProvider.isInstanceOfType(i)){_j.e.a(_a.a.a,"Getting context menu items for type '{0}', IsInitialized = {1}",Object.getType(i).getName(),i.e());i.e()||i.h();r=i;n.h(r.Q())}}};_mcp.bD=function(n){_mcp.bD.initializeBase(this,[n])};_mcp.bD.prototype={d:function(){var n=new _j.q;if("TouchNarrow"===_y.c.a.a()){var t;var f=this.bj.bc();var i=f.l();if(i)if(i.d.length>1){t=new _fm.j(_nbs.a.Fu,null,new _fm.f(i.d));n.c(t)}else if(i.d.length===1){var u=i.d[0].k;t=new _fm.d(_nbs.a.Fu,null,u);n.c(t)}var r=this.bj.bm();t=new _fm.d(_u.P.l,null,r.j());n.c(t);this.b(n,11);this.b(n,1);this.b(n,28);this.b(n,6);this.b(n,3);this.b(n,9)}return n}};_mcp.u=function(n,t,i){this.x=Function.createDelegate(this,this.R);this.y=Function.createDelegate(this,this.T);this.m=Function.createDelegate(this,this.C);this.t=Function.createDelegate(this,this.z);this.v=Function.createDelegate(this,this.P);this.u=Function.createDelegate(this,this.O);this.l=Function.createDelegate(this,this.Q);this.r=Function.createDelegate(this,this.K);this.p=Function.createDelegate(this,this.H);this.q=Function.createDelegate(this,this.I);this.s=Function.createDelegate(this,this.L);this.o=Function.createDelegate(this,this.G);this.w=Function.createDelegate(this,this.S);_mcp.u.initializeBase(this,[36,n]);this.A=t;this.j=i;this.bj.bb().U(this.w)};_mcp.u.a=function(n,t){if(t&&t.parentNode&&n){t.parentNode.replaceChild(n,t);return!0}return!1};_mcp.u.prototype={A:null,j:null,n:null,i:null,c:null,f:null,g:null,d:null,k:!1,a:function(){this.n||(this.n=new _j.g(this.o,_a.a.bN));return this.n},b:function(n){this.i=n;this.i.h(this.s);this.i.b(this.q);this.i.a(this.p);this.i.c(this.r)},bC:function(){this.U();this.bj.bb().be(this.w);var n;_a.h.a(n={val:this.d}),this.d=n.val;this.g=null;this.c=null;this.f=null;_j.Q.prototype.bC.call(this)},U:function(){this.i.k(this.s);this.i.e(this.q);this.i.d(this.p);this.i.f(this.r);this.i=null},G:function(){this.N();if(this.d)this.d.a(this.l,this.u,this.v,this.t,this.m);else if(this.j){var n=this;this.j.a(function(t){n.d=t.a();n.d.a(n.l,n.u,n.v,n.t,n.m)})}},N:function(){if(this.g)_mcp.u.a(this.c,this.g);else{var n=new _cmc.o(0,this.B("PollLoadingPlaceholder"),!0,7);this.bk.cG(n)}},z:function(n){var t=this.bk;if(t.h())n(t.h());else{var i=this;this.bj.bj().a("Attach",function(t){i.z(n)},this.y,!1)}},T:function(n){_j.e.c(_a.a.bN,"Error creating poll: cound not save draft");this.E()},P:function(n){if(n){_j.e.c(_a.a.bN,"Error creating poll: "+n);this.E()}},E:function(){var n=this.bj.ba;n.c(980,null,_nbs.a.sN,this.o)},R:function(n){n&&_j.e.c(_a.a.bN,"Error rehydrating poll: "+n);this.c&&this.f&&_mcp.u.a(this.f,this.c)},Q:function(n){this.g=n;this.d.d(this.a());this.c?_mcp.u.a(this.g,this.c):this.f&&_mcp.u.a(this.g,this.f);this.k=!0},O:function(n){if(n){this.g=n;_mcp.u.a(this.g,this.c)}else this.c&&this.c.parentNode&&this.c.parentNode.removeChild(this.c)},C:function(){this.k=!1;this.f=null;this.g=null;this.c=null},L:function(n){this.c=n.c().querySelector("div[id^='PollLoadingPlaceholder']")},I:function(n){if(this.d){this.f=this.d.b();var t=_mcp.u.a(this.f,this.g);this.k&&!t&&this.C()}},H:function(n){if(this.d){_mcp.u.a(this.g,this.f);this.f=null}},K:function(n){if(this.j){var t=this;this.j.a(function(i){var r=_mco.x.a(n.c());if(r&&r.length===1){t.f=r[0];t.c=t.M();_mcp.u.a(t.c,t.f);t.d=i.a();t.d.c(t.bj.Z.h(),r[0].id,t.l,t.x,t.m)}})}},M:function(){var n=document.createElement("div");n.innerHTML=this.B("PollLoadingPlaceholder");return n.children[0]},B:function(n){var t="800px";var u="190px";var r=Math.round(190/8).toString()+"%";return'<br/><div class="ms-border-color-themePrimary" id="'+n+'" style="width: '+t+"; max-width: 99.9%; max-height: "+u+";"+" box-sizing: border-box; overflow: hidden;"+" border-width: 1px; border-style: dashed;"+" display: inline-block;"+' -moz-user-select: none; -webkit-user-select: none; -ms-user-select: none;"'+' contenteditable="false"'+' unselectable="on"'+" iscontainer=1>"+"<div style=\"background-image: url('"+this.bj.bv.k("thinking32_blue.gif")+"');"+" background-repeat: no-repeat; background-position: center;"+" width: "+t+"; max-width: 100%; padding-bottom: "+r+"; position: relative;"+' -moz-user-select: none; -webkit-user-select: none; -ms-user-select: none;"'+' contenteditable="false"'+' unselectable="on"'+" hascontainer=1"+'"></div></div><br/>'},S:function(){this.k&&this.F()},F:function(){this.bk.k()||this.bk.bb(new _j.l);for(var t=this.bk.bv(),i=!1,n=0;n<this.bk.k().b();n++)if(this.bk.k().c(n).EmailAddress===t.EmailAddress){i=!0;break}i||this.bk.k().a(t)}};_mcp.K=function(n,t,i,r,u){this.W=Function.createDelegate(this,this.ch);_mcp.K.initializeBase(this,[n,t,i,r,u]);this.Z=!!i&&i.a().bw().Enabled;this.bj.bv.l(_mcp.K.a)};_mcp.K.a=function(n){n.a(_nbs.a.CI)};_mcp.K.prototype={Z:!1,N:!1,M:function(){return this.Z&&this.R()&&!this.bk.eS},be:function(){return this.M()&&this.x>0&&!this.bQ()},h:function(){if(this.M()){this.ce(_j.B.a(_g.a.a().a().bB.MailSendUndoInterval)?0:_g.a.a().a().bB.MailSendUndoInterval);_g.a.a().a().apcl("MailSendUndoInterval",this.W)}_mcp.s.prototype.h.call(this)},bw:function(){this.M()&&_g.a.a().a().rpcl("MailSendUndoInterval",this.W);this.bj.bv.l(_mcp.K.a);_mcp.s.prototype.bw.call(this)},U:function(){this.N=!1;if(this.be()){_j.e.a(_a.a.a,"Queueing delayed async send.");this.ci();this.N=!0}else{_j.e.a(_a.a.a,"Submitting send action with no delay.");_mcp.s.prototype.U.call(this)}},ci:function(){var n=this;_j.m.a().c(_a.a.a,"QueueAsyncSend",function(){n.bj.bv.m(_mcp.K.a);_j.e.a(_a.a.a,"Firing optimistic save for delayed send.");n.bj.bj().a("Save",function(){_j.e.a(_a.a.a,"Optimistic save for delayed send succeeded.");n.bn()},function(){_j.e.b(_a.a.a,"Optimistic save for delayed send failed! Continuing with delayed send anyway...")},!0);n.bn();var t=new _mcp.bU(n.x,n.bk,function(){n.cf();n.bj.bv.l(_mcp.K.a);_mcp.s.prototype.U.call(n);n.bj.bY.a(function(){n.t.a(ISendEvent,new _mcp.bq(n.bj))})});n.t.a(IDelayedSendEvent,t)})},bn:function(){if(this.bk.P()&&_g.i.isInstanceOfType(this.bk.P())){var n=this.bk.P();if(!n.bs){_h.c.A(n,!0);_j.e.a(this.bm(),"TryFlagDraftAsQueuedForSubmission - draft was successfully updated as queued for submission.")}}else _j.e.b(this.bm(),"TryFlagDraftAsQueuedForSubmission - no draft to update as queued for submission.")},cc:function(){if(this.N)_j.e.a(_a.a.a,"Skipping firing send event for delayed async send.");else{_j.e.a(_a.a.a,"Firing send event for immediate async send.");this.bX()}},cl:function(){if(this.M()){var n=this.bj.ba;n.b(1002);this.x>0&&n.a(1002,this.x.toString())}},ch:function(n,t){this.ce(_g.a.a().a().bB.MailSendUndoInterval);this.cl()}};_mcp.p=function(n){this.x=Function.createDelegate(this,this.H);this.y=Function.createDelegate(this,this.C);this.w=Function.createDelegate(this,this.B);this.u=Function.createDelegate(this,this.v);this.z=Function.createDelegate(this,this.M);this.A=Function.createDelegate(this,this.N);_mcp.p.initializeBase(this,[19,n]);this.q=new _j.g(this.A,this.bm());this.p=new _j.g(this.z,this.bm());this.s=n.a.bV};_mcp.p.prototype={q:null,p:null,s:null,r:null,m:null,t:!1,n:!1,a:function(){return this.q},l:function(){return this.p},f:function(){return this.r},G:function(n){if(n!==this.r){this.r=n;this.bv("DiscardConfirmDialogButtonData")}return n},F:function(n){if(n!==this.m){this.m=n;this.bv("CloseConfirmDialogButtonData")}return n},b:function(){return this.t},i:function(n){if(n!==this.t){this.t=n;this.bv("IsDiscardConfirmDialogShown")}return n},o:function(n){if(n!==this.n){this.n=n;this.bv("IsCloseConfirmDialogShown")}return n},k:function(){var i=this.bl;var t=i.a;var n=t.Z;t.bi().a("Discard");if(n.a()||!n.a()&&(n.h()||t.bj().c())){_j.e.a(_a.a.a,"Discard");this.E(n.d(),n.h())}},c:function(n,t){if(this.s.a(n)){_j.e.a(_a.a.a,"Resuming discard of {0}",_h.bb.a(t));this.E(n,t)}else _j.e.a(_a.a.a,"User had already discarded.")},j:function(){if(!this.bk.eO)return!0;_j.e.a(_a.a.a,"Comparing initial baseline to baseline.");if(!this.bk.eO.s(this.bk.eN()))return!0;_j.e.a(_a.a.a,"Checking dirty before showing discard confirmation.");return this.bj.bX()?!0:this.bk.bE()?!0:!1},d:function(n){this.bz("IsDiscardingCompose",n)},g:function(n){this.bM("IsDiscardingCompose",n)},bw:function(){this.i(!1);this.o(!1);this.G(null);this.F(null);var t;_a.h.a(t={val:this.q}),this.q=t.val;var n;_a.h.a(n={val:this.p}),this.p=n.val;this.s=null;_mcp.I.prototype.bw.call(this)},L:function(){_j.e.a(_a.a.a,"Checking dirty before showing discard confirmation.");return this.bj.bX()?!0:!1},E:function(n,t){this.C();var i=this.bl.a;var r=i.Z.bH()||i.Z.bE();this.s.b(n,t,i.bo,r)},N:function(){var n=this.bl.a;var t=n.Z;_j.e.a(_a.a.a,"User chose to discard");if(this.j()){this.K();_j.e.a(_a.a.a,"Toggle IsDiscardConfirmDialogShown flag to show the dialog. ");this.i(!0)}else{_j.e.a(_a.a.a,"User hit discard, we determined there's no need to show confirmation dialog, calling discard and navigating away. ");this.B()}},M:function(){_j.e.a(_a.a.a,"User chose to close");if(!this.bj.bh.p)if(this.L()){this.I();_j.e.a(_a.a.a,"Toggle IsCloseConfirmDialogShown flag to show the dialog.");this.o(!0)}else if(this.bj.bm().b()){_j.e.a(_a.a.a,"Addins are still running. Prompt to terminate them.");this.bj.bm().k(this.bj.bh,this.u)}else{_j.e.a(_a.a.a,"User hit close, we determined there's no need to show confirmation dialog, navigating away.");this.v()}},C:function(){_j.e.a(_a.a.a,"Toggle IsDiscardConfirmDialogShown flag to hide the dialog.");this.i(!1)},H:function(){_j.e.a(_a.a.a,"Toggle IsCloseConfirmDialogShown flag to hide the dialog.");this.o(!1)},K:function(){if(!this.r){_j.e.a(_a.a.a,"Creating discard confirm dialog.");var n=new _j.l;n.a(new _ff.d(new _j.g(this.w,this.bm()),_u.n.LT,_u.n.Lr,!0,!1));n.a(new _ff.d(new _j.g(this.y,this.bm()),_u.n.QS,_u.n.Lh,!1,!1));this.G(n)}},I:function(){if(!this.m){_j.e.a(_a.a.a,"Creating close confirm dialog.");var n=new _j.l;n.a(new _ff.d(new _j.g(this.u,this.bm()),_u.n.QU,_u.n.GT,!0,!1));n.a(new _ff.d(new _j.g(this.x,this.bm()),_u.n.Jn,_u.n.Lh,!1,!1));this.F(n)}},B:function(){_j.e.a(_a.a.a,"Discard and close");this.k();this.v();this.bj.bb().u("Discard");this.bj.bH()&&this.bj.bH().a("Discard")},v:function(){this.bk.fo(null);this.bj.bl().a(this.bj,!1);_j.e.a(_a.a.a,"Navigated away from compose");this.cg("IsDiscardingCompose")}};_mcp.bE=function(n,t,i,r){this.p=Function.createDelegate(this,this.d);this.g=Function.createDelegate(this,this.w);this.n=Function.createDelegate(this,this.x);this.o=Function.createDelegate(this,this.y);this.r=Function.createDelegate(this,this.v);_mcp.bE.initializeBase(this,[25,n]);this.f=t;this.i=new _j.g(this.r,_a.a.a);var u=n.a.Z;u.dT(this.i);this.k=r;this.l=!!i&&i.a().dj().Enabled;if(this.l){this.bk.gI(this.o);this.bk.gH(this.n)}};_mcp.bE.prototype={l:!1,i:null,f:null,m:!1,q:null,k:null,j:null,b:function(){return this.q},a:function(n){this.q=n;this.bv("EditorCallContext");return n},s:function(){if(this.k&&!this.j){var n=this;this.k.a(function(t){n.j=t})}return this.j},d:function(){this.a(new _cmc.N)},h:function(){if(!this.m){this.z();this.m=!0;_g.a.a().b().u(this.g);_g.a.a().b().A(this.g)}_mcp.I.prototype.h.call(this)},c:function(n,t){var i;if(n){var e=_g.a.a();var r=e.a().bX();var o=(r&1)>0;var u=(r&2)>0;var f=(r&4)>0;i=_j.h.b(t)?"<P><BR></P>":_a.A.e+t+_a.A.d;o&&(i='<strong id="OWAStrongID">'+i+"</strong>");u&&(i='<em id="OWAItalicID">'+i+"</em>");f&&(i='<span id="OWAUnderLineID" style="text-decoration:underline;">'+i+"</span>")}else i=_j.h.b(t)?"\r\n":t;return i},bw:function(){var n;_a.h.a(n={val:this.i}),this.i=n.val;this.A();this.m=!1;this.f=null;_g.a.a().b().x(this.g);_g.a.a().b().G(this.g);this.bk.hk(this.o);this.bk.hj(this.n);_mcp.I.prototype.bw.call(this)},v:function(){this.a(new _cmc.k(!1))},w:function(n,t){this.d()},z:function(){if(this.f)try{var n=this.f;if(!n.closed){var r=_j.w.b(n);var i=this;r.b("resize",function(n){i.d()},"MCEditorComponent")}}catch(u){var t=this.u(this.f);_j.e.d(this.bm(),u,"Projection window dump: {0}",t)}else _y.c.a.o(this.p)},A:function(){if(this.f){var n=_j.w.b(this.f);n.c("resize","MCEditorComponent")}else _y.c.a.q(this.p)},u:function(n){var t="";for(var i in n)t=t+i+",";return t},y:function(){this.bk.j()==="HTML"&&this.bk.dw()&&this.bk.fl(this.t(this.bk.dw()))},x:function(){this.bk.j()==="HTML"&&this.bk.y()&&this.bk.r(this.t(this.bk.y()))},t:function(n){var t=n;this.l&&this.s()&&(t=this.s().b(n));return t}};_mcp.bF=function(n){_mcp.bF.initializeBase(this,[n,null,null,null])};_mcp.bF.prototype={d:function(){}};_mcp.bG=function(n,t,i){this.n=Function.createDelegate(this,this.B);this.o=Function.createDelegate(this,this.C);this.l=Function.createDelegate(this,this.z);this.m=Function.createDelegate(this,this.A);this.t=Function.createDelegate(this,this.E);this.s=Function.createDelegate(this,this.w);_mcp.bG.initializeBase(this,[34,n]);this.p=t;this.c=i;this.d=this.bj.bf;this.f=this.bj.ba;this.j=_a.d.get_utcNow();this.g=new _j.q;this.y()};_mcp.bG.prototype={p:null,c:null,f:null,d:null,b:null,i:!1,u:"",r:!1,g:null,q:!1,j:null,a:function(){if(!this.r){if(this.c){var l=this.c.bB.GroupSuggestionDismissalCount;var h=this.c.bg();if(l>=5&&h&&h.c(30).b(this.j)>0)return}var t=this.bj.bb();if(t&&t.b(0)&&t.b(0).a()&&t.b(0).a().x.length>=2){var s=t.b(0).a();var o=!1;var a=s.x.length;var u=new _j.q;var i={};this.g.f();var v=_g.a.a().c();i[v.bB.LogonEmailAddress]=!0;for(var r=0;r<a;r++){var n=s.x[r];var f=n.k.a().EmailAddress;if(n.j.ba()){o=!0;this.bk.eS||_a.c.c(_a.a.bk,"GroupSuggestionOnCompose_ConversationAlreadyContainsGroup");n.j.a()&&n.j.a().b()===5&&_a.c.c(_a.a.bk,"GroupSuggestionOnCompose_HasGroupOnToLine");n.j.a()&&n.j.a().b()===2&&_a.c.c(_a.a.bk,"GroupSuggestionOnCompose_HasDLOnToLine");break}if(!(f in i)){var e=new _g.f;e.EmailAddress=f;u.c(e);i[f]=!0;this.g.c(n.k.a())}}if(u.d.length>=2&&!o){var c=t.r();this.g.c(c.d[c.d.length-1]);this.x(u.i())}else if(!this.i){this.k();_a.c.c(_a.a.bk,"GroupSuggestionOnCompose_ContainsGroupToSkipRequest")}}else if(!this.i){this.k();_a.c.c(_a.a.bk,"GroupSuggestionOnCompose_NotEnoughRecipientsToSkipRequest")}}},v:function(n,t){this.q=!0;if(this.f&&this.f.h(10307)&&this.b){this.b.c(t);this.b.d(n);this.b.e(this.g);this.b.f()}else{var i=this;this.p.a(function(r){i.b=r.d(i.s,i.t,i.g,n,t,i.bj.bh);if(i.q){i.f.d(10307,i.b,null);i.d.b(ICreateGroupInGroupSuggestionEvent,i.m);i.d.b(ICreateGroupCompleteInGroupSuggestionEvent,i.l)}})}this.bk.a()===2?_a.c.c(_a.a.bk,"GroupSuggestionOnCompose_FromReplyAll"):this.bk.a()?_a.c.c(_a.a.bk,"GroupSuggestionOnCompose_FromOthers"):_a.c.c(_a.a.bk,"GroupSuggestionOnCompose_FromNewMail")},w:function(){if(this.c){var t=this.c.bB.GroupSuggestionDismissalCount;var n=this.c.bg();n&&n.c(30).b(this.j)<=0&&(t=0);this.c.cy(t+1);this.c.cz(this.j);_h.f.a(this.c.u,_a.g.a)}this.k();this.r=!0;this.b&&this.b.b()?_a.c.c(_a.a.bk,"GroupSuggestionOnCompose_DismissUsageSuggesstion"):_a.c.c(_a.a.bk,"GroupSuggestionOnCompose_DismissCreationSuggesstion")},k:function(){this.q=!1;if(this.f&&this.f.h(10307)){this.f.b(10307);var n;_a.h.a(n={val:this.b}),this.b=n.val;this.d.c(ICreateGroupInGroupSuggestionEvent,this.m);this.d.c(ICreateGroupCompleteInGroupSuggestionEvent,this.l)}},A:function(n){this.i=!0},z:function(n){var u=this.bj.bb();if(u){var t=u.b(0);t.i(this.u);if(n.a()&&t){var r=n.c();r.a().Name=r.c();var e=t.n(r.a());e.I(!0);for(var f=n.b(),i=0;i<f.length;i++)t.i(f[i])}}this.i=!1},E:function(){var f=this.bj.bb();var u=f.b(0);var r=this.b.a();var n=new _g.f;n.Name=r.DisplayName;n.EmailAddress=r.SmtpAddress;n.MailboxType="GroupMailbox";var e=u.n(n);e.I(!0);var i=r.TopRelevantMembers;if(i)for(var t=0;t<i.length;t++)u.i(i[t].EmailAddress.EmailAddress);_a.c.c(_a.a.bk,"GroupSuggestionOnCompose_ClickReplaceWithGroupLink")},y:function(){var n=this;this.p.a(function(n){})},x:function(n){var t=new _mcp.bv(n);t.c(this.o);t.d(this.n);this.bj.bo.a(t,null,null,null)},C:function(n){n.V(this.o);n.U(this.n);var i=n;var t=i.e;if(!i.j&&t&&t.length>0){this.v(!0,t[0]);_a.c.c(_a.a.bk,"GroupSuggestionOnCompose_ShowExistGroupSuggestion")}else this.i||this.k()},B:function(n){n.V(this.o);n.U(this.n);this.k()},h:function(){this.a();if(this.e()){_j.e.b(_a.a.a,"MailComposeAtMentionComponent is already initialized, skipping redundant Initialize call.");return}_mcp.I.prototype.h.call(this);_a.c.c(_a.a.bk,"GroupSuggestionOnCompose_ComposeMail")},bw:function(){var n;_a.h.a(n={val:this.b}),this.b=n.val;this.d.c(ICreateGroupInGroupSuggestionEvent,this.m);this.d.c(ICreateGroupCompleteInGroupSuggestionEvent,this.l);_mcp.I.prototype.bw.call(this)}};_mcp.bI=function(n,t,i,r){this.k=Function.createDelegate(this,this.s);this.l=Function.createDelegate(this,this.t);this.j=Function.createDelegate(this,this.r);_mcp.bI.initializeBase(this,[6,n,i,r]);this.n=t};_mcp.bI.prototype={b:null,c:null,g:!1,d:!1,i:!1,n:null,o:function(n){if(n!==this.g){this.g=n;this.bv("IsHighImportance")}return n},a:function(){return this.d},q:function(n){if(n!==this.d){this.d=n;this.bv("IsNormalImportance")}return n},p:function(n){if(n!==this.i){this.i=n;this.bv("IsLowImportance")}return n},h:function(){var i=this.bk.X();this.f(i);_j.e.a(_a.a.a,"Importance component initialized and importance set to {0}",i);if("Mouse"===_y.c.a.a()||_y.c.a.a()==="TouchNarrow"){if(!this.b){var t=this.m(_mcp.q.b);t&&(this.b=new _fm.f(t))}}else if(!this.c){var n=this.m(_mcp.q.c);n&&(this.c=new _y.h(_nbs.a.jQ,null,n))}_mcp.q.prototype.h.call(this)},bw:function(){this.b=null;_mcp.q.prototype.bw.call(this)},bO:function(){var n=new _fm.j(_nbs.a.jQ,null,this.b);return[n]},bQ:function(){var t=this;var n=new _fm.l(_nbs.a.jQ,function(n){n(t.b)},1,null,!1,!1,null,null,!1);return[n]},bF:function(){return[this.c]},r:function(){var n=new _cmc.g(_a.a.a,"MailComposeSetImp",!1);_j.e.a(_a.a.a,"User sets high importance");this.f("High");this.bl.a.bi().a("Importance:High");n.b()},t:function(){_j.e.a(_a.a.a,"User sets normal importance");this.f("Normal");this.bl.a.bi().a("Importance:Normal")},s:function(){var n=_a.c.b(_a.a.a,"MailComposeSetImp");_j.e.a(_a.a.a,"User sets low importance");this.f("Low");this.bl.a.bi().a("Importance:Low");_a.c.a(n)},f:function(n){this.bl.a.Z.dV(n);this.o("High"===n);this.q("Normal"===n);this.p("Low"===n)},m:function(n){return[n(new _j.g(this.j,this.bm()),_nbs.a.Zd),n(new _j.g(this.l,this.bm()),_nbs.a.OH),n(new _j.g(this.k,this.bm()),_nbs.a.db)]}};_mcp.v=function(n,t,i,r){this.bi=Function.createDelegate(this,this.cm);this.Q=Function.createDelegate(this,this.bX);this.S=Function.createDelegate(this,this.cn);this.bh=Function.createDelegate(this,this.cl);this.br=Function.createDelegate(this,this.cD);this.I=Function.createDelegate(this,this.V);this.bd=Function.createDelegate(this,this.T);this.bg=Function.createDelegate(this,this.bY);this.y=Function.createDelegate(this,this.bc);this.P=Function.createDelegate(this,this.bW);this.L=Function.createDelegate(this,this.bQ);this.K=Function.createDelegate(this,this.bP);this.M=Function.createDelegate(this,this.bR);this.N=Function.createDelegate(this,this.bT);this.O=Function.createDelegate(this,this.bV);this.R=Function.createDelegate(this,this.cd);this.be=Function.createDelegate(this,this.bu);this.bn=Function.createDelegate(this,this.cu);this.bf=Function.createDelegate(this,this.bJ);this.bo=Function.createDelegate(this,this.cv);this.bp=Function.createDelegate(this,this.cw);this.bA=["bmp","gif","jpg","jpeg","png"];_mcp.v.initializeBase(this,[24,n]);this.n=_mco.b.e(i);this.ba=r;this.G=_a.o.a();this.X=t;this.z=i;_b.j.j()||this.bE(!1)};_mcp.v.prototype={o:null,A:null,n:!1,F:!1,E:!1,H:null,B:null,t:null,x:null,w:null,v:null,ba:null,l:null,m:null,p:null,r:null,s:null,G:null,q:null,X:null,z:null,C:null,u:!1,bE:function(n){if(n!==this.n){this.n=n;this.bv("IsLinkPreviewEnabled")}return n},bb:function(n){if(n!==this.u){this.u=n;this.bv("IsOneDriveLinkPreviewActivated")}return n},co:function(n){if(n!==this.o){this.o=n;this.cy()}return n},bZ:function(){this.v||(this.v={});return this.v},cq:function(n){this.A=n;this.bv("LinkPreviewResponse");if(this.A&&_zz.d.e(this.l)){var t=this.l.bX();this.bs(this.A,t?t:null)}return n},cs:function(n){if(n!==this.x){this.x=n;this.x&&_mco.b.a(this.x,null,this.bp,null,null)}return n},cr:function(n){if(n!==this.w){this.w=n;this.w&&_mco.b.a(this.w,null,this.bo,null,null)}return n},b:function(){return this.F},d:function(n){if(this.F!==n){this.F=n;this.bv("ShowYouTubePlayer")}return n},a:function(){return this.E},c:function(n){if(this.E!==n){this.E=n;this.bv("ShowOEmbedVideoPlayer")}return n},i:function(){return this.H},ct:function(n){this.H=n;this.bv("YouTubePlayerUrl");return n},g:function(){return this.B},bF:function(n){this.B=n;this.bv("OEmbedVideoPlayerHtml");return n},f:function(){this.t||(this.t=new _j.g(this.bf,_a.a.e));return this.t},bw:function(){var n;_a.h.a(n={val:this.t}),this.t=n.val;this.l=null;this.cC();this.r=null;this.s=null;this.q=null;this.v=null;_mcp.I.prototype.bw.call(this)},cy:function(){if(_mco.b.n()){_j.e.a(_a.a.e,"Link preview feature is disabled.  Skipping GetLinkPreview action for {0}",this.o.Url);this.bu();return}if(this.o){var i=1;var r=_a.c.b(_a.a.e,"GetComposeLinkPreview");var n=[];Array.add(n,this.o);_j.e.a(_a.a.e,"Preparing GetLinkPreview action for {0}",this.o.Url);this.o.Autoplay=!0;var u=new _mco.b(this.o);_j.e.a(_a.a.e,"Submitting GetLinkPreview action for {0}",this.o.Url);var t=this,f=this;this.bl.a.bo.a(u,function(u){_mco.b.q(u,t.bn,t.be,i,r,"GetComposeLinkPreview",n)},function(t){_mco.b.l(t,i,r,"GetComposeLinkPreview",n)},null)}},cu:function(n){this.cq(n)},bu:function(){this.bE(!1)},cw:function(n){this.ct(n);this.d(!!this.H)},cv:function(n){var t=this.p.g(n);t?this.bF(t):this.bF(n);this.c(!!this.B)},bJ:function(){this.c(!1)},j:function(n){this.m=n;this.m.v(this.R);this.m.b(this.O);this.m.a(this.N);this.m.c(this.M);this.m.g(this.K);this.m.h(this.L);this.m.i(this.P)},cC:function(){if(this.m){this.m.w(this.R);this.m.e(this.O);this.m.d(this.N);this.m.f(this.M);this.m.j(this.K);this.m.k(this.L);this.m.l(this.P);this.m=null}},cf:function(n){if(!this.n){_j.e.a(_a.a.e,"RTE: Skipping IsElementFromPreviewAnchor because previews are disabled");return!1}var t="LPNoLP";var i="a[id^='"+t+"']";return _b.j.a(n.id,t)||!!n.querySelector(i)},ce:function(n){if(!this.n){_j.e.a(_a.a.e,"RTE: Skipping IsElementFromPreviewAnchor because previews are disabled");return!1}var t=!1;var i="a[id^='LPlnk']";t=_b.j.a(n.id,"LPlnk")||!!n.querySelector(i);!t&&n.nodeName==="#text"&&n.parentNode&&n.parentNode.nodeName==="A"&&(t=_b.j.a(n.parentNode.id,"LPlnk"));return t},cd:function(n){var i=n.c();var t=n.d();if(_zz.g.isInstanceOfType(t))this.l=t;else{_j.e.c(_a.a.e,"HandleLinkPreviewOnLinkAdded: event source was not an instance of HtmlEditorBase");return}this.bG(i)},bG:function(n){if(n&&this.n){var t;var r,i;if(!(i=_cmc.j.a(n,r={val:t}),t=r.val,i))return;if(this.cf(n)||this.ce(n))return;if(_b.j.e(n.id))return;if(this.k()&&!this.k().t(n))return;if(t.toLowerCase().startsWith("http")){n.id=_b.j.f();_j.e.a(_a.a.e,"FindAndInsertLinkInPreviousWord: Trigger link preview");this.cz(n.id,t)}}},bO:function(n){if(n){var t=n.toLowerCase().split(".");if(t&&t.length>1)return Array.contains(this.bA,t[t.length-1])?!0:!1}return!1},bR:function(n){var t=n.d();if(_zz.g.isInstanceOfType(t))this.l=t;else{_j.e.c(_a.a.e,"EditorOnContentLoaded: event source was not an instance of HtmlEditorBase");return}this.Y(n.c())},bP:function(n){n.c()===1&&this.bH(n.e())},bQ:function(n){this.Y(n.c())},bV:function(n){var t=n.c();this.bI(t)},bW:function(n){if(!this.n||!this.z||!this.z.q()){_j.e.a(_a.a.e,"MailComposeLinkPreviewComponent: Skipping getting doc links because doc link previews are disabled");return}if(this.p){var t=new _a.k;var i=this.k().i();var r=this;Array.forEach(i,function(n){var i=n;if(i.a()===1&&!i.k()){var r=new _g.em;r.Url=i.m();r.ProviderType=_g.p.toString(i.f()==null?0:i.f());r.PermissionType=i.b()==null?0:i.b();t.c(r);i.p(!0)}});this.bk.hn(t)}},bT:function(n){var t=n.c();this.Y(t)},cz:function(n,t){if(!this.n){_j.e.a(_a.a.e,"MailComposeLinkPreviewComponent: Skipping link preview requests because previews are disabled");return}if(this.bO(t)){var i=this;_j.m.a().a(this.bm(),"InsertInlineImageTimerCallback",function(){if(!i.cb&&i.l&&i.l.Z()&&i.l.bc){var r=i.l.A().querySelectorAll("#"+n);if(r&&r.length>0&&r[0]){var f=document.createElement("img");try{f.src=t}catch(e){_j.e.a(_a.a.e,"Exception encountered when inserting image for {0}. Exception: {1}",t,e.message);return}var u=document.createElement("p");u.appendChild(f);i.l.bf(!0);r[0].parentNode&&r[0].parentNode.appendChild(u);i.l.be(3);i.l.bD()}}},10)}else{_j.e.a(_a.a.e,"Trigger link preview request for {0}",t);var r=new _g.cP;r.Id=n;r.Url=t;r.RequestStartTimeMilliseconds=_a.d.a().h();if(this.G.b()){var u=this;_j.m.a().c(this.bm(),"QueueGenerateLinkPreviewForIE",function(){u.bc(r)})}else this.bc(r)}},bs:function(n,t){_j.e.a(_a.a.e,"Adding link preview for {0}",n.Url);var r=!1;_mco.p.a(n)&&(r=!0);if(!this.k()){this.r=n;this.s=t;this.p&&this.bD();return}if(r){this.k().m(this.y);return}if(this.l&&this.l.Z()&&this.l.bc){this.l.bf(!0);this.k().f(n,this.y,t,this.bg,this.bd,this.I,null);this.l.be(3);this.l.bD();var i=this.k().a(n.Url);i&&i.a()&&this.bb(!0)}else _j.e.a(_a.a.e,"Ignore AddLinkPreview since the editor isn't active or initialized")},k:function(){if(!this.p){_j.e.a(_a.a.e,"MailComposeLinkPreviewComponent: Create LinkPreviewBuilder");var n=this;this.ba.a(function(t){n.cp(t.a(n.br,n.bh,!0,_y.c.a,n.X,n.bj.bo));n.p.d(n.bZ());n.bD()})}return this.p},cp:function(n){this.p=n;this.bv("LinkPreviewBuilder");return n},cD:function(n){this.cs(new _a.ci(n))},cl:function(n){this.cr(new _a.ci(n))},bD:function(){_j.e.a(_a.a.e,"MailComposeLinkPreviewComponent: LinkPreviewBuilderFactoryOnOnCreated");if(this.r&&this.s){_j.e.a(_a.a.e,"MailComposeLinkPreviewComponent: There was a deferred AddLinkPreview. Calling it now");this.bs(this.r,this.s);this.r=null;this.s=null}if(this.q){_j.e.a(_a.a.e,"MailComposeLinkPreviewComponent: There was a deferred InitializeLinkPreviewFromAnchors. Calling it now");this.bB(this.q);this.q=null}},bB:function(n){this.q=n;var e=!1;var a=!1;if(this.k())this.q=null;else return;for(var o=0;o<n.length;o++){var i=!1;var f=null;var t=n[o];if(_b.j.a(t.id,"LPUrlAnchor")){var r;var l,y;if(y=this.k().n(t,l={val:r}),r=l.val,y){var v,s;i=(s=this.cA(t,r,v={val:e}),e=v.val,s)}else _j.e.b(this.bm(),String.format("InitializeLinkPreviewFromAnchors: LPBorder was not found for found LPUrlAnchor id:{0}",t.id))}else if(_b.j.a(t.id,"LPImageAnchor"))i=this.cB(t);else if(_b.j.a(t.id,"LPlnk"))i=this.ci(t);else if(!a){this.bG(t);a=!0}var u;var c,h;if(i&&!this.u&&(h=_cmc.j.a(t,c={val:u}),u=c.val,h)){f=this.k().a(u);f&&f.a()&&this.bb(!0)}}e&&this.k().m(this.y)},cA:function(n,t,i){var r=null;i.val=!1;var c=this.C+"[id^='LPRemovePreview']";var h=t.querySelector(c);if(h){_j.e.a(_a.a.e,"Remove preview button already added. Skipping preview initialization.");return!1}this.Z(t);var f=!1;var o;this.k().q(t,o={val:f}),f=o.val;this.k().o(t);if(f){this.k().p(n);i.val=!0}this.bt(t);this.T(t);this.V(t);this.U(t);var u;var e,s;if(s=_cmc.j.a(n,e={val:u}),u=e.val,s){t.id=this.k().h(t.id,u);r=this.k().a(u);r&&(r.a()!==1||!r.c()||r.c().b()!=null||this.k().u(r,t,this.I))}return!0},cB:function(n){var s=String.format("[id^='{0}']","LPBestFitImageContainer");var e=_j.A.d(_j.k.o(n),s);if(e&&e.length>0){var t;var i;var o,r,u,f;if((r=this.k().n(n,o={val:t}),t=o.val,r)&&(f=_cmc.j.a(n,u={val:i}),i=u.val,f)){t.id=this.k().h(t.id,i);return!0}}return!1},ci:function(n){var t=n.id.indexOf("|");var r=t>-1?n.id.substring(0,t):n.id;var i=this.l.z.querySelectorAll("div[id*='"+r+"']");if(!i.length){n.setAttribute("previewremoved",!0);return!0}return!1},bc:function(n){this.co(n)},bY:function(n){this.bt(n);this.T(n);this.V(n);this.U(n);var t=n;if(this.G.b()){n.style.display="inline-block";t=window.document.createElement("p");t.appendChild(n)}this.Z(t);return t},bt:function(n){var t=this.k().e(n,"[id^='LPRemovePreviewContainer']");if(t){this.C=t.tagName;t.id="LPRemovePreview";t.style.marginLeft="10px";_j.k.b(t,"click",this.S);_j.k.d(t,_mcp.e.r().a())}},V:function(n){var f=n.querySelector("a[id^='LPUrlAnchor']");var i;var e,o;if(f&&(o=_cmc.j.a(f,e={val:i}),i=e.val,o)&&this.k().s(i)){var r=n.querySelector("[id^='LPOptionsContainer']");if(r&&_j.h.a(r.innerHTML)){var t=this.k().e(n,"[id^='LPOptionsContainer']");if(t){t.id="LPOptions";var u=_mcp.e.B().a();if(!_j.k.p(t,u)){_j.k.d(t,u);this.U(n);this.bb(!0)}}}}},U:function(n){var e=n.querySelector("a[id^='LPUrlAnchor']");var r=n.querySelector("[id^='LPMetadata']");var t;var o,s;if(r&&e&&(s=_cmc.j.a(e,o={val:t}),t=o.val,s)){var i=this.k().a(t);if(i&&i.a()){var f;var u;_j.h.a(f=this.k().b(i.b()==null?0:i.b()))?_j.h.a(u=this.cc(t))||(r.innerText=String.format(_nbs.a.Nh,u)):r.innerText=f}}},T:function(n){var i;if((i=n.querySelector("div[id^='LPDescription']"))&&!_j.h.a(i.getAttribute("altdesc"))){var t=this.k().e(n,"[id^='LPExpandDescriptionContainer']");if(t){t.id="LPExpandDescription";i.id.endsWith("_summary")&&_j.k.d(t,"ms-fcl-tp-b");_j.k.d(t,_mcp.e.O().a());_j.k.b(t,"click",this.Q)}}},Z:function(n){_j.e.a(_a.a.e,"InitializePreviewForEditor: InitializePreviewForEditor.");n.setAttribute("contenteditable",!1);_j.k.b(n,"click",this.bi)},bx:function(n){var t=[];this.W(t,n,this.C,"LPRemovePreview");this.W(t,n,"a","LPExpandDescription");this.W(t,n,"a","LPOptions");return t},W:function(n,t,i,r){for(var f=t.getElementsByTagName(i),u=0;u<f.length;u++)f[u].id===r&&Array.add(n,f[u])},bX:function(n){var i=n.b();var s=_b.j.b(i);var t=s.querySelector("div[id^='LPDescription']");if(t){var e=t.id.endsWith("_summary");if(e){t.id=t.id.substring(0,t.id.length-8);_j.k.f(i,"ms-fcl-tp-b")}else{t.id+="_summary";_j.k.d(i,"ms-fcl-tp-b")}this.ch(t,!e);var f=t.getAttribute("altdesc");if(!_j.h.a(f)){t.setAttribute("altdesc",t.innerHTML);t.innerHTML=f}var r="maxHeight";var u=t.getAttribute("altmaxheight");var o=u?u:"100%";t.setAttribute("altmaxheight",_j.k.h(t,r));_j.k.a(t,r,o)}},ch:function(n,t){var i=new _a.l;var r=_a.c.b(_a.a.e,"LinkPreviewExpandDescriptionAction");var u=_b.j.b(n).querySelector("a[id^='LPUrlAnchor']");i.b("U",_mco.b.b(u,"href",100));i.c("Summary",t);r.j=i.toString();_a.c.a(r)},cn:function(n){var t=new _cmc.g(_a.a.e,"RemoveLinkPreviewClickEvent",!1);if(!this.l){_j.e.c(_a.a.e,"RemovePreviewClicked: editor was null");return}this.l.eD(n);var l=n.b();var i=_b.j.b(l);var w=this.l.dP();if(i){var y=20;var u=null;u=_b.j.a(i.id,"LPBorder")?i:i.querySelector("[id^='LPBorder']");if(u){var r=u.getAttribute("id");_b.j.a(r,"LPBorder_YT")?t.a("T","Y",!0,!0):_b.j.a(r,"LPBorder_VT")?t.a("T","V",!0,!0):_b.j.a(r,"LPBorder_PT")?t.a("T","P",!0,!0):_b.j.a(r,"LPBorder_BVT")?t.a("T","BV",!0,!0):t.a("T","G",!0,!0);var s;var o=_b.j.h(i);var a,h;if(o&&(h=_cmc.j.a(o,a={val:s}),s=a.val,h)){var e=this.k().a(s);var v=e.g(r);var c=document.body.querySelector(String.format("[id^='{0}']",v));c&&c.setAttribute("previewremoved",!0);e.a()&&t.a("D",e.a(),!0,!0);t.a("U",_mco.b.d(o.href,y),!0,!0)}}var f=i.querySelector("div[id^='LPDescription']");var p=!!f&&!!f.id&&f.id.endsWith("_summary");t.a("S",p,!0,!0);t.j().length<1;_j.k.c(l,"click");this.l.le(i);t.b()}else t&&t.d("NullPreview",null)},bI:function(n){if(!this.n){_j.e.a(_a.a.e,"RTE: Skipping link preview cleanup because previews are disabled");return!1}for(var o=this.bx(n),h=0;h<o.length;h++){var s=o[h];var t=_b.j.b(s);if(t){t.removeAttribute("contenteditable");_j.k.c(t,"click");_j.k.c(s,"click mouseenter mouseleave");_j.k.e(s);this.k().r(t)}}for(var a=n.querySelectorAll(String.format("[id^='{0}']","LPBorder")),e=0;e<a.length;e++){var r=a[e];var i=r.querySelector("a[id^='LPUrlAnchor']");if(!i){var f=r.querySelectorAll("a[id^='LPImageAnchor']");f&&f.length===1&&(i=f[0])}var u;var v,c;if(i&&(c=_cmc.j.a(i,v={val:u}),u=v.val,c)){var l=this.k().a(u);l&&(r.id+=l.o())}}if(this.p){var y=this.k().i();var p=this;Array.forEach(y,function(t){t.s(n)})}return o.length>0},Y:function(n){if(!this.n){_j.e.a(_a.a.e,"RTE: Skipping link preview initialization because previews are disabled");return}if(!n){_j.e.a(_a.a.e,"RTE: Skipping link preview initialization because bodyElement is null");return}if(n.nodeType===3){_j.e.a(_a.a.e,"RTE: Skipping link preview initialization because bodyElement is text node");return}this.bB(this.ca(n))},bH:function(n){if(!this.n){_j.e.a(_a.a.e,"RTE: Skipping link preview bind because previews are disabled");return}if(n)for(var u=this.bx(n),i=0;i<u.length;i++){var t=u[i];var r=_b.j.b(t);if(r){this.Z(r);t.id==="LPRemovePreview"?_j.k.b(t,"click",this.S):t.id==="LPExpandDescription"&&_j.k.b(t,"click",this.Q)}}},ca:function(n){var r=[];if(!_j.D.a(n.children)&&n.children.length>0)for(var i=0;i<n.childNodes.length;i++){var t=n.childNodes[i];if(t.nodeType===1&&!_cmc.j.e(t)){var u=this;_j.A.b(t.getElementsByTagName("A"),function(n,t){Array.add(r,t)})}}return r},cm:function(n){if(!this.l){_j.e.c(_a.a.e,"PreviewClicked: editor was null");return}if(this.l.dP()){var i=n.b().parentNode;var t=_b.j.b(i);if(t){this.l.lp(t);this.bl.a.bf.a(_a.Y,new _a.Y(_nbs.a.Bv+t.textContent.replace(_nbs.a.Zt,""),!1,0,2))}}},cc:function(n){var t=this.k().a(n);return t?t.j():null}};_mcp.W=function(n,t){_mcp.W.initializeBase(this,[14,n]);this.d=t};_mcp.W.prototype={d:null,b:null,c:0,a:null,bq:function(){return _mcp.I.prototype.bq.call(this)||!this.b},h:function(){_mcp.I.prototype.h.call(this);this.a=this.j();var n=this.bl.a;this.b=n.bz();this.c=n.Z.a();_mcp.g.g(n.Z)&&!n.Z.bs()&&this.n()},bw:function(){this.a=null;this.b=null;_mcp.I.prototype.bw.call(this)},n:function(){this.b.f(_mcp.W.a);this.f()},j:function(){var n=this.bl.a.Z;var t=n.g()||n.P();return t&&n.br()?t:null},m:function(){if(_dg.a.isInstanceOfType(this.a))return this.a.z();else if(_dg.q.isInstanceOfType(this.a)){var n=this.a;return n.E().z()==="RecurringMaster"?n.P()?"RecurringMaster":"Occurrence":n.E().z()}else throw Error.argument("this.Item","Unsupported calendaring type:"+Object.getType(this.a).getName());},f:function(){if(this.a&&!_dg.s.isInstanceOfType(this.a)){this.b.a(6800);switch(this.m()){case"Occurrence":case"Exception":this.i();break;case"RecurringMaster":this.g();break}}},k:function(n){var t;switch(n){case 8:t=3200;break;case 3:t=3205;break;case 5:case 6:case 7:default:throw Error.argument("operation","Unsupported mail compose operation on an occurrence: "+n);}return t},l:function(n){var t;switch(n){case 8:t=3100;break;case 3:t=3105;break;case 5:case 6:case 7:default:throw Error.argument("operation","Unsupported mail compose operation on a series: "+n);}return t},g:function(){var n=this.l(this.c);this.b.a(n)},i:function(){var n=this;this.d.a(function(t){if(!n.bq()){var u=t.a();var r=u.a(n.a,null);var i=n.k(n.c);n.b.a(i,r)}})}};_mcp.L=function(n,t,i,r){this.p=Function.createDelegate(this,this.Z);this.q=Function.createDelegate(this,this.bb);this.H=Function.createDelegate(this,this.bn);this.C=Function.createDelegate(this,this.a);this.F=Function.createDelegate(this,this.P);this.t=Function.createDelegate(this,this.bs);this.E=Function.createDelegate(this,this.ba);this.K=Function.createDelegate(this,this.bp);this.I=Function.createDelegate(this,this.bo);this.k=Function.createDelegate(this,this.bd);this.G=Function.createDelegate(this,this.bg);this.r=Function.createDelegate(this,this.be);this.s=Function.createDelegate(this,this.bh);_mcp.L.initializeBase(this,[0,n]);this.i=n.a.bV;this.j=t;this.v=i;this.B(!0);this.x=r};_mcp.L.prototype={i:null,v:null,m:!1,g:!1,o:!1,z:null,A:null,n:null,j:null,x:!1,f:null,e:function(){return _mcp.I.prototype.e.call(this)},ck:function(n){if(n!==_mcp.I.prototype.e.call(this)){_mcp.I.prototype.ck.call(this,n);this.bv("IsInitialized")}this.bl.a.Z.ee(n);return n},d:function(){return this.m},U:function(n){if(n!==this.m){this.m=n;this.bv("IsSecondInitializationComplete")}return n},b:function(){return this.g},B:function(n){if(this.g!==n){this.g=n;this.by("CanLoadPopoutSuccessfully","ShouldHideSpinner")}return n},M:function(){return this.bk?this.bk.eW&&this.g||!this.bk.eW&&!this.g:!0},V:function(){if(this.f){this.f.a();this.f=null}},h:function(){this.z=_j.n.b(_a.a.a,517,"VM.MailCompose.FirstInit");var t=this.bl.a;var n=t.Z;n.apcl("IsEditorInitialized",this.s);n.apcl("IsUpgraded",this.r);if(!n.eO&&!n.h()){_j.e.a(_a.a.a,"Capture initial baseline for a non draft without existing initial baseline.");n.eO=_mcp.c.b(n);n.eY()||n.fa(!0)}if(n.gh()){_j.e.a(_a.a.a,"Finish 1st init for complete context");this.l();if(n.a()!==15){_j.e.a(_a.a.a,"Check begin upgrade for complete context");this.w()}}else{var o=t.bo;var r=n.h();var i=n.A();var s=n.gR();if(!r&&s){var e;var u=_g.a.a().c();e=_j.h.a(u.bB.SharePointUrl)?u.bB.UserEmailAddress||"":u.bB.LogonEmailAddress||"";var l=new _gg.Y("StoreId",s,e);var a=new _mcp.bd([l],"EwsId");var v=this;o.a(a,this.G,function(n){v.bf(n)},this.k);_j.e.a(_a.a.a,"Calling server to convert id, storeId={0}",s)}else if(r)if(n.cA()&&n.eY()){_j.e.a(_a.a.a,"The message was saving prior to popout, check for save result from main window");this.T()}else{_j.e.a(_a.a.a,"Load draft {0}",_h.bb.a(r));this.y(r)}else if((4===n.a()||13===n.a())&&n.eY()){_j.e.a(_a.a.a,"Loading draft without id for the popout from reading-pane case, check id from main window");this.T()}else if(i){t.ba.b(3400);t.ba.a(3400,null);if(n.gN()){var f=this;this.v.b(function(t){var u=t.a(i,n.cv(),n.cm(),n.dj());var r=t.b(200,u,n.cm());r.Y=n.d();o.a(r,f.I,function(n){f.S(n)},f.k);_j.e.a(_a.a.a,"Loading original calendar item with ID={0}, ChangeKey={1}",i.Id,i.ChangeKey)})}else{var h=t.bT.i(i);h.Y=n.d();var c=this;o.a(h,this.K,function(n){c.S(n)},this.k);_j.e.a(_a.a.a,"Loading original message item with ID={0}, ChangeKey={1}",i.Id,i.ChangeKey)}}else if(0===n.a()||11===n.a()){n.cN(!0);n.fe(!0);_j.e.a(_a.a.a,"Finish 1st init for new mail");this.l()}else{this.a("ErrorNoDraftOrOriginalItemId",null,null);throw Error.invalidOperation(String.format("Cannot perform operation {0} without either draft ID or original item ID",_j.t.c(_y.m,n.a())));}}_j.h.a(_g.a.a().c().bB.SharePointUrl)||t.ba.a(110,null);t.Z.a()!==16||t.Z.bR()||t.eb()},c:function(){this.X();this.A=_j.n.b(_a.a.a,517,"VM.MailCompose.SecondInit");var i=this.bl;var n=i.a;var u=n.Z;_j.e.a(_a.a.a,"Queue secondary init task.");_j.m.a().c(_a.a.a,"Delayed MailCompose Secondary Init",this.E);if(n.hN()&&!n.ev.a){var f=i.b(10);_j.e.a(_a.a.a,"Queue appbar setup task");var t=f;_j.m.a().c(_a.a.a,"SetupApplicationBarMenu",t.d||(t.d=Function.createDelegate(t,t.b)))}this.br();if(u.bC()){_j.e.a(_a.a.a,"Queue diagnostics save to trigger uploading of the diagnostics attachment");var e=this;_j.m.a().c(_a.a.a,"Diagnostics save:",function(){n.bj().a("Diagnostics",null,null,!1)})}if(_a.cu.a){_j.e.a(_a.a.a,"Queue GetMailTips if needed task");var r=this;_j.m.a().c(_a.a.a,"TriggerMailTipsIfNeeded",function(){r.bq()||n.dc().a(32)})}},a:function(n,t,i){var f=this.bl.a;var r=f.Z;if(r.bB()){var u=new _a.l;_j.h.a(i)||u.b("E",i);_y.j.a(r.bB(),null,n,t,this.Q(u.toString(),r.bB().j));r.x(null)}if(r.fk()){_y.j.a(r.fk(),null,n,t,i);r.bc(null)}this.L()},bw:function(){var n=this.bk;n.rpcl("IsEditorInitialized",this.s);n.rpcl("IsUpgraded",this.r);this.ck(!1);this.U(!1);this.B(!0);this.o=!1;this.V();_mcp.I.prototype.bw.call(this)},bn:function(n){if(this.bl&&this.bl.a&&this.bl.a.Z){var f=_j.n.b(_a.a.a,2,"VM.MailCompose.ProcessDraft");var e=this.bl.a.Z;var u=this.bj.bp();var t=n;var i=n.Y;_j.e.a(_a.a.a,"Got draft, checking pending discards for {0}",i);if(this.i.a(i))u&&u.c(i,t.j[0]);else if(i===this.bk.d()){var r=t.e;if(_g.bv.isInstanceOfType(r)){this.bk.dC(r);this.u(!0);this.R(t)}else _a.p.a&&r.bx()?this.bc(r,t):this.P(r,t);_a.br.a&&_j.m.a().c(_a.a.a,"SafeTriggerPolicyTipsIfNeededForOpenDraft",this.t)}else _j.e.a(_a.a.a,"Skipping get draft processing since action context {0} doesn't match current context {1}",i,this.bk);_j.n.a(f);_j.n.a(this.n)}},bc:function(n,t){var i=this;this.bj.du(function(){i.W();i.f.c(n,t)})},W:function(){if(!this.f){_j.e.a(_a.a.a,"Setting initializer component override");this.f=this.bj.cG().b();this.f.b(this.F,this.cG,this.C,this.bj.bo)}},P:function(n,t){this.bk.cC(n);this.u(!1);this.R(t)},R:function(n){if(this.bk.eY()&&this.bk.dB()){_j.e.a(_a.a.a,"Capture initial baseline for a loaded draft.");this.bk.eO=_mcp.c.b(this.bk)}_j.e.a(_a.a.a,"Finish 1st init for a loaded draft.");this.l();_j.m.a().c(_a.a.a,"SafeTriggerPolicyTipsIfNeededForOpenDraft",this.t)},bo:function(n){var u=this.bl;var f=u.a;var t=f.Z;var i=n.Y;if(i===t.d()&&!this.i.a(i)){var r=n;t.G(r.e());t.cM(!1);_j.e.a(_a.a.a,"Got original cal item, finish 1st init.");this.l();_j.e.a(_a.a.a,"Check begin upgrade on original cal item");this.w()}},bp:function(n){var u=this.bl;var f=u.a;var i=f.Z;var t=n.Y;if(t===i.d()&&!this.i.a(t)){var r=n;i.G(r.e);_j.e.a(_a.a.a,"Got original message, finish 1st init.");this.l();_j.e.a(_a.a.a,"Check begin upgrade on original message item");this.w()}},Z:function(n,t){this.bj.bl().a(this.bl.a,!1);_j.e.a(_a.a.a,"Navigate away on action failure")},bd:function(n){if(!this.bq()&&n.Y===this.bk.d()){this.bj.ba.b(3400);this.bj.be()}},l:function(){var o=_j.n.b(_a.a.a,2,"VM.MailCompose.ComponentInit");var n=this.bl;var f=n.a;var r=f.Z;var s=r.a();n.b(7).h();if(r.a()!==15){n.b(8).h();n.b(1).h();var i=n.b(11);i.h();if(this.bk.a()!==4&&!this.bk.y()||!this.bk.a()&&this.bk.y()){var t=this.bj.bN().c(this.j.b()&&this.bk.j()==="HTML",this.bk.y());if(i.a()){var e=i.b();e&&(t=t+e)}this.bk.r(t)}}r.br()&&n.b(14).h();var u=_y.c.a.a();if(u!=="Mouse"){if(u==="TouchNarrow"){n.b(5).h();n.b(6).h();n.b(3).h();n.b(9).h();n.b(22).h();n.b(16).h()}n.b(10).h()}else{n.b(22).h();n.b(25).h()}_j.n.a(o);_j.n.a(this.z);if(f.cK){_j.e.a(_a.a.a,"Finishing primary init, beginning secondary init because we are already in view.");this.c()}this.ck(!0)},ba:function(){var n=this.bl;var i=n.a;var t=i.Z;n.b(2);n.b(15);n.b(25);n.b(27);if(t.a()!==15){n.b(32);n.b(34)}n.n();t.eN()||t.gf();this.U(!0);_j.e.a(_a.a.a,"Finished secondary init.");_j.n.a(this.A)},y:function(n){this.n=_j.n.b(_a.a.a,517,"VM.MailCompose.LoadDraft");var i=this.bl.a;var t=i.Z;var e=i.bo;if(t.eY()){if(t.dB()){_j.e.a(_a.a.a,"Capture initial baseline since message was a clean new message before popout.");t.eO=_mcp.c.b(t)}t.bm()&&!t.m()&&this.u(!0)}else t.fS(!0);i.ba.b(3400);i.ba.a(3400,null);t.gi()&&i.ba.a(3480);var r=this.j.b()&&t.j()==="HTML"?_h.b.b():_h.b.i();var o="MailCompose";var u=i.bT.i(n,r,o);u.Y=t.d();var f=this;e.a(u,this.H,function(n){f.bi(n)},this.k);_j.e.a(_a.a.a,"Loading draft with ID={0}; Shape={1}; Layout={2}; ContextBodyType={3}",_h.bb.a(n),r.BodyType,_y.c.a.a(),t.j())},u:function(n){if(n!==this.o){var t=this.bl.a.ba;t.b(3440);n&&t.a(3440,null);this.bj.be();this.o=n}},bg:function(n){var i=n;var t=new _g.e(i.j().Id);this.bl.a.Z.H(t);this.y(t)},w:function(){var u=this.bl;var n=u.a.Z;var t=n.a();var i=1===t||2===t||3===t||12===t;if(!i||n.h()||n.m()){if(i&&n.h()&&n.m()&&_a.o.a().G){var r=this;_j.m.a().a(_a.a.a,"MailComposeInitializerComponent.BeginUpgradeIfNecessary",function(){r.cb||r.bj.be()},1e3)}}else this.bj.bK().b()},T:function(){var n=this.bl.a.Z.d();if(this.x){_j.e.a(_a.a.a,"Processing save result on main window for popout projection compose window {0}",n);var t=window.self.windowServiceEndPoint;t.getSaveResultForPopout(n,_a.V.b,this.q)}else{_j.e.a(_a.a.a,"Calling main window to process save result {0}",n);_g.k.b.getSaveResultForPopout(n,_a.V.b,this.q)}},bb:function(n){var t=this.bl.a.Z;if(n){var i=JsonParser.deserialize(n);_j.e.a(_a.a.a,"Resume loading draft after main window successfully saved item: {0}",i.Id);t.bm()&&!t.m()&&t.cN(!0);this.y(i)}else{_j.e.a(_a.a.a,"Save failed on the main window for this popout, show failure message.");this.B(!1);this.a("ErrorSaveFailedOnMainWindow",null,null)}},bh:function(n,t){var r=this.bl.a;var i=r.Z;i.eW&&this.Y();this.bv("ShouldHideSpinner")},be:function(n,t){var r=this.bl.a;var f=r.Z;if(f.m()){var i=this.bj.bK();if(i.f()){var u=r.cd()?r.cd().toString():"";_y.j.a(i.f(),null,null,null,u);i.l(null)}}},Y:function(){var t=this.bl.a;var n=t.Z;if(n.fk()){n.fk().n(new _a.D("OneCompose"));this.j.a().h()&&this.j.a().h().Enabled&&n.fk().n(new _a.D("PE"));var i=t.cd()?t.cd().toString():"";_y.j.a(n.fk(),null,"",null,i);n.bc(null)}this.L()},Q:function(n,t){var i="";i=_j.h.a(n)?t:_j.h.a(t)?n:n+"|"+t;return i},X:function(){var i=this.bl.a;var n=i.Z;if(n.bB()){var t=n.bB().j;i.cd()&&(t=this.Q(i.cd().toString(),t));_y.j.a(n.bB(),null,"",null,t);n.x(null)}},L:function(){var i=this.bl.a;var t=i.Z;if(t.gS()){var n=null;switch(t.a()){case 0:n="MailComposeNewLoad";break;case 1:n="MailComposeReplyLoad";break;case 2:n="MailComposeReplyAllLoad";break;case 3:n="MailComposeForwardLoad";break;case 4:n="MailComposeEditDraftLoad";break}if(n){_a.H.b(n);t.bd(!1)}}},bf:function(n){this.O(n,"ConvertIdAction")},bi:function(n){this.O(n,n.l)},O:function(n,t){var i=this;this.N(n,t,function(t){t.g(n,_nbs.a.MZ,_nbs.a.DY,_nbs.a.MZ,_bms.E.BC,i.p)})},S:function(n){var t=this;this.N(n,n.l,function(i){i.f(n,t.p)})},N:function(n,t,i){var r=t+"_UnknownError";if(this.bq()){_j.e.a(_a.a.a,"MailComposeInitializerComponent.HandleActionFailure: viewModel is null or disposing, aborting logic. ErrorCode = {0}",r);return}var s=this.bl;var e=s.a;var h=e.Z;var f=n.Y;f!==h.d()||this.i.a(f)||i(e.bo);var u=r;u=_g.R.a(n.I)?_g.R.b(n.I)||r:n.I.ExceptionName||r;var o=n.I.FaultMessage||n.I.message;_j.n.a(this.n);this.a(u,n.O(),o)},bs:function(){_mcp.I.a(this.bj,32)},br:function(){this.bj&&this.bj.Z.l()===1&&!this.bj.bq()&&this.bj.bf.a(_a.bd,new _a.bd("MCompose"))}};_mcp.g=function(n,t,i){_mcp.g.initializeBase(this,[4,n]);this.k=t;this.i=i};_mcp.g.f=function(){_mcp.g.b||(_mcp.g.b=new _a.e("LocationViewModel",ILocationViewModel,_mcp.g));return _mcp.g.b};_mcp.g.e=function(){_mcp.g.a||(_mcp.g.a=new _a.e("IsMeetingForwardOnBehalfOf",Boolean,_mcp.g));return _mcp.g.a};_mcp.g.g=function(n){switch(n.a()){case 4:return n.bs();case 8:case 3:return!0;case 5:case 7:case 6:return!1;default:return!1}};_mcp.g.prototype={k:null,i:null,g:null,a:function(){return this.eB(_mcp.g.c)},n:function(n){this.eA(_mcp.g.c,n);return n},d:function(){return this.eB(_mcp.g.d)},f:function(n){this.eA(_mcp.g.d,n);return n},b:function(){return this.eB(_mcp.g.f())},l:function(n){this.eA(_mcp.g.f(),n);return n},j:function(){return this.eB(_mcp.g.e())},o:function(n){this.eA(_mcp.g.e(),n);return n},c:function(){return this.g},p:function(n){if(n!==this.g){this.g=n;this.bv("MeetingCalendarTimePeriod")}return n},h:function(){var n=this.bl.a.Z;var i=this.bl.a.dH;if(n.bF()){var e=this;this.k.a(function(t){e.l(t.a(n.fx(),null,!1))})}else this.l(null);if(n.br()){if(n.bu()){var o=this;this.i.a(function(t){var i=t.a();o.p(i.a(n,null))})}if(n.bj()){var t=2;var s=_pc.a.n(n.n());var r=i.e(s,_bc.e.a,!0,t,!1,!1);this.n(r);this.o(!!n.bt()&&!!n.bt().Mailbox&&!!n.n()&&!!n.n().Mailbox&&!_g.n.a(n.n().Mailbox,n.bt().Mailbox));if(this.j()){var f=_pc.a.n(n.bt());var u=i.e(f,_bc.e.a,!0,t,!1,!1);this.f(u)}else this.d()&&this.f(null)}}else this.m();_j.e.a(_a.a.a,"Meeting component initialized, IsMeeting={0}, IsMeetingForward={1}",n.br(),n.bj());_mcp.I.prototype.h.call(this)},bw:function(){this.m();if(this.b()){this.b().dispose();this.l(null)}_mcp.I.prototype.bw.call(this)},m:function(){if(this.a()){this.a().dispose();this.n(null)}if(this.d()){this.d().dispose();this.f(null)}}};_mcp.q=function(n,t,i,r){_mcp.q.initializeBase(this,[n,t]);this.bV=r;this.bx=i};_mcp.q.a=function(n,t){return new _fm.g(n,t,null,1,null,null,!1,!1,!1,!1)};_mcp.q.c=function(n,t){return new _y.h(t,n)};_mcp.q.b=function(n,t){return new _fm.d(t,null,n,!0)};_mcp.q.prototype={bV:null,bx:null,cL:null,cI:null,cl:null,Q:function(){return this.cL},P:function(){return this.cI},O:function(){return this.cl},dH:function(){return this.bV.a()==="Mouse"&&!!this.bx&&!this.bj.bk()},h:function(){if(_y.c.a.a()==="Mouse"||_y.c.a.a()==="TouchNarrow"){this.dH()&&(this.cI=this.bQ());this.cL=this.bO()}else this.cl=this.bF();_mcp.I.prototype.h.call(this)},ca:function(){},ce:function(){},cy:function(){},bw:function(){this.cL=null;this.cI=null;this.cl=null;_mcp.I.prototype.bw.call(this)},bt:function(){if(_y.c.a.a()==="Mouse"||_y.c.a.a()==="TouchNarrow"){this.dH()&&this.ce();this.ca()}else this.cy()}};_mcp.bK=function(n,t,i,r){this.g=Function.createDelegate(this,this.v);this.f=Function.createDelegate(this,this.u);this.n=Function.createDelegate(this,this.s);this.k=Function.createDelegate(this,this.w);this.m=Function.createDelegate(this,this.r);this.o=Function.createDelegate(this,this.x);this.p=Function.createDelegate(this,this.A);_mcp.bK.initializeBase(this,[9,n,i,r]);this.j=t};_mcp.bK.prototype={j:null,d:null,c:null,b:null,l:null,a:function(){return this.c},z:function(n){if(this.c!==n){this.c=n;this.bv("DialogViewModel")}return n},h:function(){this.d||(this.d=new _j.g(this.p,this.bm()));this.q();_mcp.q.prototype.h.call(this)},bw:function(){var t;_a.h.a(t={val:this.b}),this.b=t.val;var n;_a.h.a(n={val:this.d}),this.d=n.val;this.c=null;this.j=null;_mcp.q.prototype.bw.call(this)},bO:function(){if(!this.bk.R()&&!this.bV.b()&&!this.bj.bk()){var n=_mcp.q.b(this.d,_nbs.a.PQ);return[n]}return null},bQ:function(){if(!this.bk.R()&&!this.bV.b()){var n=_mcp.q.a(this.d,_nbs.a.PQ);return[n]}return null},bF:function(){if(!this.bk.R()&&!this.bV.b()){var n=new _y.h(_nbs.a.PQ,this.d);return[n]}return null},A:function(){_j.e.a(_a.a.a,"User chose to show message options");this.b||(this.b=new _mcp.P);this.b.t(this.bk);if(!this.c){var t=new _bc.l;t.G(this.j);this.z(t);this.c.q(_nbs.a.Ux);this.l=[new _ff.d(new _j.g(this.o,this.bm()),_u.P.X,null,!0,!1),new _ff.d(new _j.g(this.m,this.bm()),_u.R.BF,null,!1,!1)];this.c.n.m(this.l)}this.c.s(this.b);if("TouchNarrow"===_y.c.a.a()){var n=this.bl.a.bQ();this.b.u(n);n.b().e(this.k)}this.c.f(!0)},x:function(){if(this.c.B){_j.e.a(_a.a.a,"User tried to click OK button more than once.");return}var n=this.bj.Z;if(n.C()!==this.b.d){this.bl.a.bi().a("Sensitivity:"+this.b.d);"Normal"!==n.C()&&this.y();n.el(this.b.d);"Normal"!==n.C()&&this.q()}n.Z()!==this.b.e&&this.bl.a.bi().a("RequestDeliveryReceipt");n.ba()!==this.b.f&&this.bl.a.bi().a("ReadReceiptRequested");n.dY(this.b.e);n.ec(this.b.f);if(this.b.b&&!n.o()||this.b.c&&!n.t()){this.c.y(!0);this.bj.du(this.n)}else this.s();this.b.b!==n.o()&&this.bl.a.bi().a("EncryptMessage");this.b.c!==n.t()&&this.bl.a.bi().a("SignMessage")},s:function(){this.c.y(!1);var n=this.bj.Z;var u=this.bl.a;var t=this.bj.bc();var i=t.a();if(n.o()!==this.b.b){n.eo(this.b.b);this.bv("SmimeEncryptMessage");_j.e.a(_a.a.k,"SmimeEncryptMessage option is changed to {0} by user.",this.b.b)}if(n.t()!==this.b.c){n.eq(this.b.c);this.bv("SmimeSignMessage");_j.e.a(_a.a.k,"SmimeSignMessage option is changed to {0} by user.",this.b.c)}var r=this.b.b||this.b.c;r&&u.fC();i&&i.bv(n.K());if(this.b.k&&!r&&t.g())if(t.b()){_j.e.a(_a.a.k,"Waiting to move attachments because the attachment well is currently in progress.");this.c.y(!0);i.J(this.f)}else this.u(null,null);else if(!this.b.k&&r){this.bj.bk()&&this.bj.bK().i()&&!n.bl()&&this.bj.bK().a().a();if(t.g())if(t.b()){_j.e.a(_a.a.k,"Waiting to move attachments because the attachment well is currently in progress.");this.c.y(!0);i.J(this.g)}else this.v(null,null);else this.i()}else this.i()},u:function(n,t){if(this.t(n,t)){_j.e.a(_a.a.k,"Started MoveAttachmentsFromClientToServer due to user turned off S/MIME for current message.");if(n){n.D(this.f);this.c.y(!1)}var i=this.bj.bc().a();if(this.bj.Z.h())i.bm();else{var r=this;this.bj.bj().a("Attach",function(){i.bm()},null,!1)}this.i()}},v:function(n,t){if(this.t(n,t)){_j.e.a(_a.a.k,"Started MoveAttachmentsFromServerToClient due to user turned on S/MIME for current message.");if(n){n.D(this.g);this.c.y(!1)}this.bj.bc().a().bn();this.i()}},t:function(n,t){return!n&&!t?!0:t==="IsInProgress"&&!n.k()},i:function(){_j.e.a(_a.a.a,"User hit OK on message options dialog, setting Sensitivity="+this.bk.C()+"; DeliveryReceipt="+this.bk.Z()+"; ReadReceipt="+this.bk.ba()+"; SmimeEncryptMessage="+this.bk.o()+"; SmimeSignMessage="+this.bk.t());this.r()},r:function(){if(this.c.B){_j.e.a(_a.a.a,"User tried to close dialog when busy.");return}var t=this.bl.a.Z;var i=this.bj.bz();if(t.K()&&t.z()){_a.F.a(_u.R.HB,1);i.a(750)}else i.b(750);this.bj.bb().bc().c(!t.K());var n=this.bj.bc();if(n.a()){n.a().D(this.f);n.a().D(this.g)}"TouchNarrow"===_y.c.a.a()&&this.b.g.b().f(this.k);_j.e.a(_a.a.a,"Close message options dialog");this.c.o.a()},w:function(n,t){_mcp.d.isInstanceOfType(this.bl.a.bQ().a())?this.c.f(!0):this.c.f(!1)},y:function(){var t=this.bl.a;var n=t.bz();switch(t.Z.C()){case"Personal":n.b(8900);break;case"Confidential":n.b(8901);break;case"Private":n.b(8902);break}this.bj.be()},q:function(){var t=this.bl.a;var n=t.bz();switch(t.Z.C()){case"Personal":n.a(8900,null);break;case"Confidential":n.a(8901,null);break;case"Private":n.a(8902,null);break}this.bj.be()}};_mcp.t=function(n,t,i,r){this.N=Function.createDelegate(this,this.bc);this.Y=Function.createDelegate(this,this.bu);this.U=Function.createDelegate(this,this.bo);this.W=Function.createDelegate(this,this.bg);this.X=Function.createDelegate(this,this.bs);this.S=Function.createDelegate(this,this.bh);this.R=Function.createDelegate(this,this.H);this.V=Function.createDelegate(this,this.br);this.E=Function.createDelegate(this,this.bi);this.T=Function.createDelegate(this,this.bn);_mcp.t.initializeBase(this,[2,n,i,r]);this.t=new _j.g(this.T,this.bm());var e=this;this.K=new _j.g(function(){e.C("Upconvert")},this.bm());var s=this;this.u=new _j.g(function(){s.C("ShowOriginalMessage")},this.bm());var h=this,o=this;this.L=new _j.u(function(){h.C("UpconvertOnFormat")},this.bm(),this.bl.a.Z,"BodyType",function(){return o.bl.a.Z.j()==="HTML"});var f=this;this.B=new _j.g(function(){f.C("UpconvertOnMoreOptions")},this.bm());var u=this;this.A=new _j.g(function(){u.bl.a.Z.ej(function(n){n.bm().H()});u.C("UpconvertAndShowApps")},this.bm());this.r=n.a.bV;this.F=t};_mcp.t.prototype={r:null,F:null,t:null,K:null,L:null,u:null,A:null,B:null,w:!1,x:!1,p:!1,v:!1,G:!1,o:null,q:null,z:!1,b:function(){return this.t},j:function(){return this.A},y:function(n){this.w!==n&&(this.w=n);return n},i:function(){return this.x},I:function(n){if(this.x!==n){this.x=n;this.Z(n)}return n},g:function(){return this.p},M:function(n){if(this.p!==n){this.p=n;this.Z(n)}return n},k:function(){return this.v},c:function(){return this.s().q()},m:function(n){this.s().j(n);return n},s:function(){this.q||(this.q=this.bb());return this.q},h:function(){var n=_y.c.a;"Mouse"!==n.a()||n.b()||n.x(this.E);_mcp.q.prototype.h.call(this)},d:function(n){this.q=n},a:function(n,t){n.P(!0);var i=this.bk.l();this.bj.bm().G();if(i===3){this.bj.bf.a(_a.bw,new _a.bw);this.bp(t)}this.s().f(n,t);i===1&&this.bj.bf.a(_y.bR,new _y.bR);this.bj.bf.a(IExtensibilityShowHideEvent,_mcp.X.a)},f:function(n){this.bl.a.bL&&(this.z=!0);if(!this.z){_j.e.a(_a.a.a,"Checking dirty before prompting user for before unload confirmation.");this.bl.a.bX()&&n.a(_nbs.a.Kt)}this.z=!0;_j.m.a().a(_a.a.a,"ResetSkipBeforeUnloadConfirmationFlag",this.V,100)},n:function(){var t=!0;var u=this.bl;var n=u.a;var i=n.Z;var r=n.bg();var o=n.bj();var e=i.d();var s=i.a();if(this.r.a(e))_j.e.a(_a.a.a,"User had chose to discard, simply navigate away.");else if(i.bm()&&this.r.g(u,!1))_j.e.a(_a.a.a,"User had navigated away on an unused response, the unused response was discarded.");else if(this.ba())t=!1;else if(r.b()){_j.e.a(_a.a.a,"We're sending the message, can't exit yet.");t=!1}else if(r.n()){_j.e.a(_a.a.a,"We're resolving the recipients before sending, can't exit yet.");r.l();t=!1}else if(i.R()){var f=n.bp();f.a().a();t=!1}else if(n.bm().b()){_j.e.a(_a.a.a,"Addins are still running on the message, invalid to navigate");n.bm().k(n.bh,this.R);t=!1}else if(i.a()===15)_j.e.a(_a.a.a,"Navigate away if the current operation is ReplyToBotMessage.");else{_j.e.a(_a.a.a,"Checking dirty before navigating away from compose.");if(n.bX()||n.bE){this.G=!1;_j.m.a().a(_a.a.a,"NavigatingAwaySaveTimeout",this.S,1e4);this.cj();if(o.a("ReadingPaneExit",this.X,this.W,!1)){this.M(!0);_j.e.a(_a.a.a,"Save is in progress or failed, can't exit yet.");t=!1}}}return t},l:function(){this.be(this.bj.Z);this.bj.eu(!1)},bb:function(){return new _y.bm},bw:function(){var r;_a.h.a(r={val:this.L}),this.L=r.val;var u;_a.h.a(u={val:this.t}),this.t=u.val;var f;_a.h.a(f={val:this.K}),this.K=f.val;var n;_a.h.a(n={val:this.u}),this.u=n.val;var t;_a.h.a(t={val:this.B}),this.B=t.val;var i;_a.h.a(i={val:this.A}),this.A=i.val;_y.c.a.E(this.E);this.q=null;_mcp.q.prototype.bw.call(this)},bO:function(){if(this.bj.bk()){var n=new _fm.d(_u.n.LM,null,this.t);return[n]}return null},bQ:function(){return null},bF:function(){return null},br:function(){this.z=!1},bi:function(){_y.c.a.E(this.E);this.r.g(this.bl,!0)},Z:function(n){var t=this.bl.a;t.eN(_u.P.r);t.ey(n);t.ex(n)},bn:function(){var t=this.bj;var n=t.Z;var f=n.d();_j.m.a().j(_a.a.a,"MailComposePopOut");if(this.w){_j.e.a(_a.a.a,"Skipped pop out because another pop out is in progress.");return}if(this.bd()){t.bi().a("UpconvertOnPopOut");n.x(this.o=_y.j.b(_a.a.a,"MailComposeReadingPanePopOut",!0));this.y(!0);var e=!1;try{var s=this.bl.a.ba;s.f(_mcp.t.b);t.be();var i=t.bj();_j.e.a(_a.a.a,"Checking dirty before popping out from reading pane.");var u=t.bX();var r=t.Z.dl();var o=t.ep();if(!n.h()||u||o.a()||r){this.I(!0);(n.h()&&!r||u||i.f())&&n.fa(!1);_j.e.a(_a.a.a,"Set WasCleanNewMessageBeforePopout = {0}",n.dB());this.v=!1;_j.m.a().a(_a.a.a,"PopoutSaveTimeout",this.U,1e4);n.fX(!0);this.cj();t.bB.get_saveForPopoutMap()[f]=new _y.gD;this.bf();i.a("Popout",this.Y,this.N,!1)}else{if(n.bH())n.fa(!1);else if(n.bE())n.fa(!1);else if(i.f())n.fa(!1);else if(n.eO){_j.e.a(_a.a.a,"Comparing initial baseline with baseline.");n.eO.s(n.eN())||n.fa(!1)}else n.fa(!1);n.fX(!1);_j.s.b(t.bB,"PopoutManager");_j.s.b(t.bB.get_saveForPopoutMap(),"PopoutManager.SaveForPopoutMap");delete t.bB.get_saveForPopoutMap()[f];this.bf()}_j.e.a(_a.a.a,"MailComposeNavigationComponent::OpenComposeWindow - setting composeConductor.HasNavigatedFromReadingPaneToPopoutCompose = true");this.s().s(!0);e=!0}finally{if(!e){this.y(!1);this.I(!1);_y.j.a(this.o,null,_mcp.t.a.toString(4));n.x(null);this.o=null}}}},bd:function(){var r=this.bl;var n=r.a;var u=n.Z;var t=u.d();var i=this.bj.bg();if(i.b()){_j.e.a(_a.a.a,"Skipped navigating away because send is in progress.");return!1}if(this.ba()||this.r.a(t)){_j.e.a(_a.a.a,"Skipped navigating away because attachment is currently uploading or user had discarded");return!1}if(n.bm().b()){_j.e.a(_a.a.a,"Skipped navigating away because addins are still running.");n.bh.g(0,_nbs.a.mH,null,!1,_nbs.a.aM,null);return!1}return!0},ba:function(){var n=this.bl.a;var t=n.bc();if(t.b()){if(!n.bh.p){_j.e.a(_a.a.a,"Show attachment in progress error dialog");n.bh.g(0,_u.R.Dp,null)}return!0}return!1},bf:function(){var r=this.bl.a;var n=r.Z;var t=new _mcp.b;this.F&&t.ek(this.F.b());t.p(0);t.e(!1);if(n.a()===11||n.a()===12){t.c(13);t.ei(n.bN());t.eh(n.bM())}else t.c(4);t.H(n.h());t.i(n.j());var i=this.bb();t.ho(!0);t.cN(n.m());t.et(n.L());t.ce(n.bm());t.fS(n.bH());t.fR(n.bE());t.dU(n.cr());t.fa(n.dB());t.fX(n.cA());t.fW(n.d());t.v(n.u());t.x(n.bB());t.fz(n.ct());t.cb(n.Y());t.fj=n.bR();t.dX(n.dk());n.bB()&&n.bB().e()==="MailComposeReadingPanePopOut"&&n.x(null);n.m()||n.a()!==3||n.dE()||!n.g().be()||t.U(n.g().be().e);i.a(t);if(!n.cA()){this.H();this.y(!1)}},bu:function(n){this.I(!1);if(this.v){_j.e.a(_a.a.a,"Popout was cancelled by timer, skipping save succeeded processing for popout.");if(this.o){_y.j.a(this.o,null,_mcp.t.a.toString(3));this.o=null}}else{var i=n.Y;var t=this.bl.a;if(i in t.bB.get_saveForPopoutMap()){var u=_mcp.bj.a(n);var r=t.bB.get_saveForPopoutMap()[i];if(r.a.length){var f=JsonParser.serialize(u);t.bB.pushSaveResultToPopout(f,r.a);delete t.bB.get_saveForPopoutMap()[i]}else r.b=u}if(t.Z.d()===i){_j.e.a(_a.a.a,"Save succeeded for popout, navigating away from the main window.");this.H();this.y(!1)}else _j.e.a(_a.a.a,"Skipped navigating away since contextId={0}; viewModelId={1}",i,t.Z.d())}},bs:function(n){this.p&&this.M(!1);if(this.G){_j.e.a(_a.a.a,"Navigation away was cancelled by timer, skipping navigating from compose.");return}this.H()},bg:function(n){if(this.p){_j.e.a(_a.a.a,"Save failed, reset IsSavingForNavigatingAway flag to false");this.M(!1)}},H:function(){var n=this.bl.a;this.a(n,!1);_j.e.a(_a.a.a,"Navigated away from reading-pane compose")},C:function(n){this.bj.bi().a(n);var o=this.bl;var r=o.a;var t=r.Z;if(!t.m()&&!t.h()&&!t.L()){_j.e.a(_a.a.a,"upgrade is still in progress, need to wait till it is completed. ContextId={0}",t.d());r.bh.g(0,_nbs.a.kq);return}if(this.bd()){var f=this.s();if(IInlineComposeConductorViewModel.isInstanceOfType(f)){var i=_a.c.b(_a.a.a,"MailComposeUpConvert");i.j=n;var u=new _a.l;u.b("O",n);i.j=u.toString();t.x(i);t.es(!0);var s=f;if(r.bE){var e=this;this.bj.bj().a("RehydrateUpgrade",function(){e.bj.bK().b()},null,!1)}else{this.bj.bK().a().a();this.be(t)}}}},bc:function(n){if(this.w){this.y(!1);this.I(!1);var f=this.bl;var i=f.a;var t;t=n?n.Y:i.Z.d();if(t in i.bB.get_saveForPopoutMap()){var r=i.bB.get_saveForPopoutMap()[t];r.a.length>0&&i.bB.pushSaveResultToPopout(null,r.a);delete i.bB.get_saveForPopoutMap()[t]}}if(this.o){var u=this.v?2:1;_y.j.a(this.o,null,_mcp.t.a.toString(u));this.o=null}},bo:function(){_j.e.a(_a.a.a,"Attempt to popout expired since save did not come back in time");if(this.x&&!this.cb){this.v=!0;this.bc(null);var t=this.bl;var n=t.a.ba;this.cj();n.a(84);this.bj.be()}},bh:function(){_j.e.a(_a.a.a,"Attempt to navigate away expired since save did not come back in time");if(this.p&&!this.cb){this.G=!0;this.bg(null);var n=this.bj.ba;this.cj();n.a(86);this.bj.be()}},bp:function(n){var t=new _mcp.bw;t.Name="MailComposeNavigation";t.Result=n;n&&!this.bq()&&(t.Recipients=this.bj.bb().B());window.parent.postMessage(t,"*")},be:function(n){var t=this.s();t.g(!1);t.m(n)}};_mcp.t.a=function(){};_mcp.t.a.prototype={popoutSaveFailed:1,popoutSaveExpired:2,popoutSaveSucceededExpired:3,popoutEncounteredException:4};_mcp.t.a.registerEnum("_mcp.t.a",!1);_mcp.bL=function(n,t,i,r){this.z=Function.createDelegate(this,this.F);this.C=Function.createDelegate(this,this.R);this.p=Function.createDelegate(this,this.H);this.q=Function.createDelegate(this,this.K);this.A=Function.createDelegate(this,this.L);this.E=Function.createDelegate(this,this.S);this.B=Function.createDelegate(this,this.N);_mcp.bL.initializeBase(this,[28,n,i,r]);this.i=new _j.g(this.B,this.bm());this.j=new _j.g(this.E,this.bm());this.g=new _j.g(this.A,this.bm());this.y=t;this.bj.Z.bk()&&this.G();if(_a.g.b){var u=this.bj.Z.bL();if(u){var f=this.bj.bz();f.a(10213,u.a(9))}}};_mcp.bL.prototype={i:null,j:null,g:null,o:null,v:null,m:null,x:null,u:null,w:null,n:null,t:null,l:null,f:null,b:null,c:null,y:null,k:null,d:0,r:function(){return!!this.bj.br.OmeSettings},s:function(){var n=this.bj.br.OmeSettings;return(n&3)==3||(n&5)==5},a:function(){return this.b},M:function(n){if(this.b!==n){this.b=n;this.bv("DialogViewModel")}return n},h:function(){this.bj.br.WasLoadedFromServer||this.bj.bf.b(_a.cx,this.q);_mcp.q.prototype.h.call(this)},bw:function(){this.bj.bf.c(_a.cx,this.q);var r;_a.h.a(r={val:this.b}),this.b=r.val;var u;_a.h.a(u={val:this.c}),this.c=u.val;this.k&&(this.k.length=0);this.bl.a.bQ().b().f(this.p);var i;_a.h.a(i={val:this.i}),this.i=i.val;var n;_a.h.a(n={val:this.j}),this.j=n.val;var t;_a.h.a(t={val:this.g}),this.g=t.val;_mcp.q.prototype.bw.call(this)},bO:function(){if(!_y.c.a.i()&&!this.bj.bk()){this.v=new _fm.d(_nbs.a.co,null,this.j);this.o=new _fm.d(_nbs.a.tt,null,this.i);this.m=new _fm.d(_nbs.a.RD,null,this.g);this.ca();return[this.v,this.o,this.m]}return null},bQ:function(){if(!_y.c.a.i()){this.u=new _fm.g(this.j,_nbs.a.co,null,1,null,null,!1,!1,!1,!1);this.x=new _fm.g(this.i,_nbs.a.tt,null,1,null,null,!1,!1,!1,!1);this.w=new _fm.g(this.g,_nbs.a.RD,null,1,null,null,!1,!1,!1,!1);this.ce();return[this.u,this.x,this.w]}return null},bF:function(){if(!_y.c.a.i()&&this.r()){this.t=new _y.h(_nbs.a.co,this.j);this.n=new _y.h(_nbs.a.tt,this.i);this.l=new _y.h(_nbs.a.RD,this.g);this.f=this.bj.Z.bk()?this.l:this.s()?this.t:this.n;return[this.f]}return null},ce:function(){var t=this.r();var n=this.bj.Z.bk();var i=this.s();this.u.b(t&&i&&!n);this.x.b(t&&!i&&!n);this.w.b(t&&n)},ca:function(){if(this.o&&this.m){var t=this.r();var n=this.bj.Z.bk();var i=this.s();this.v.a(!t||!i||n);this.o.a(!t||i||n);this.m.a(!t||!n)}},cy:function(){if(this.r()){this.l||this.n||(this.cl=this.bF());var n=this.bk.bk()?this.l:this.s()?this.t:this.n;if(this.f&&this.f!==n){this.bj.ev.K(this.f,n);this.f=n}else this.bj.bI().b()}},N:function(){this.bj.Z.cd(!0);this.bt();var n=this.bj.bz();this.d=10206;n.a(this.d,null)},L:function(){this.bj.Z.cd(!1);this.bj.Z.bL()&&this.bj.Z.cO(null);this.bt();var n=this.bj.bz();n.b(this.d)},S:function(){_j.e.a(_a.a.a,"User chose to show message options");this.c||(this.c=new _mcp.ba(this.bj.br.OmeSettings));if(!this.b){var t=new _bc.l;t.G(this.y);this.M(t);this.b.q(_nbs.a.Wa);this.k=[new _ff.d(new _j.g(this.C,this.bm()),_u.P.X,null,!1,!1),new _ff.d(new _j.g(this.z,this.bm()),_u.R.BF,null,!1,!1)];this.b.n.m(this.k)}this.b.s(this.c);if("TouchNarrow"===_y.c.a.a()){var n=this.bl.a.bQ();this.c.m(n);n.b().e(this.p)}this.b.f(!0)},F:function(){if(this.b.B){_j.e.a(_a.a.a,"User tried to close dialog when busy.");return}"TouchNarrow"===_y.c.a.a()&&this.c.b.b().f(this.p);_j.e.a(_a.a.a,"Close message options dialog");this.b.o.a()},G:function(){var i=this.bj.bz();var u=this.bj.Z.bk();if(u){var n=this.bj.Z.bL();var f=!!n;var t="";if(f){var r=_a.d.a().t;t=n.G(r).a(1);this.d=10214}else this.d=10206;i.a(this.d,t)}else i.b(this.d)},H:function(n,t){_mcp.d.isInstanceOfType(this.bl.a.bQ().a())?this.b.f(!0):this.b.f(!1)},R:function(){if(this.b.B){_j.e.a(_a.a.a,"User tried to click OK button more than once.");return}var n=!0;switch(this.c.a){case 0:break;case 1:n=this.I();break}if(n){this.c.i("");this.bj.Z.cd(!0);this.G();this.bt();this.F()}},I:function(){for(var n="",h=0,s=0,o=0,c,t=!0,l=this.c.k(),a=l.length,r=0;r<a;++r){var u=l[r];var i;if(_j.h.a(u.a)){n=_u.n.Gy;t=!1;break}else if(isNaN(i=Number.parseInvariant(u.a))){n=_u.n.Ok;t=!1;break}switch(u.b){case 7:h=i;break;case 6:s=i-1;break;case 5:o=i;break}}if(t){var f,e;c=(e=this.T(o,s,h,f={val:n}),n=f.val,e);_j.h.a(n)&&this.bj.Z.cO(c.q())}if(!_j.h.a(n)){this.c.i(n);t=!1}return t},T:function(n,t,i,r){var u=new _a.d(n,t,i,23,59,0,0,_a.d.a().t);r.val="";t<0||t>11||_a.d.r(t,n)<i?r.val=_u.n.j:u.k(_a.d.a())<0&&(r.val=_u.n.Nw);return _j.h.a(r.val)?u:null},K:function(n){if(!this.bq()){var t=this.bl.a;this.bt();t.bf.c(_a.cx,this.q)}}};_mcp.bM=function(n,t){this.c=Function.createDelegate(this,this.d);_mcp.bM.initializeBase(this,[13,n]);this.b=new _j.g(this.c,this.bm());this.b.c(t.f().a().a())};_mcp.bM.prototype={b:null,a:function(){return this.b},d:function(){_j.e.a(_a.a.a,"OpenFilePicker on PAL.");var n=this.bj.bc();if(!n){_j.e.c(_a.a.a,"Unable to open file picker, attachment component is null.");return}if(!n.a()){_j.e.c(_a.a.a,"Unable to open file picker, attachment well ViewModel is null.");return}n.a().bZ();_j.e.a(_a.a.a,"OpenFilePicker on PAL end.")},bw:function(){var n;_a.h.a(n={val:this.b}),this.b=n.val;_mcp.I.prototype.bw.call(this)}};_mcp.bO=function(n,t){this.g=Function.createDelegate(this,this.j);this.f=Function.createDelegate(this,this.i);_mcp.bO.initializeBase(this,[13,n]);var i;i=t.b(t.f())?t.f().a():this;var u=this;this.c=new _j.u(this.f,this.bm(),i,"CameraAvailable",function(){return t.b(t.f())&&t.f().a().c()});var r=this;this.d=new _j.u(this.g,this.bm(),i,"GalleryAvailable",function(){return t.b(t.f())&&t.f().a().e()})};_mcp.bO.prototype={c:null,d:null,a:function(){return this.c},b:function(){return this.d},i:function(){_j.e.a(_a.a.a,"User chose to attach from camera");var n=this.bl.b(5);if(!n){_j.e.c(_a.a.a,"Unable to open camera, attachment component is null.");return}if(!n.a()){_j.e.c(_a.a.a,"Unable to open camera, attachment well ViewModel is null.");return}n.a().bo(n.i());_j.e.a(_a.a.a,"Attach from camera end")},j:function(){_j.e.a(_a.a.a,"User chose to attach from gallery");var n=this.bl.b(5);if(!n){_j.e.c(_a.a.a,"Unable to open gallery, attachment component is null.");return}if(!n.a()){_j.e.c(_a.a.a,"Unable to open gallery, attachment well ViewModel is null.");return}n.a().M(n.i());_j.e.a(_a.a.a,"Attach from gallery end")},bw:function(){var t;_a.h.a(t={val:this.c}),this.c=t.val;var n;_a.h.a(n={val:this.d}),this.d=n.val;_mcp.I.prototype.bw.call(this)}};_mcp.f=function(n,t,i){this.dI=Function.createDelegate(this,this.ey);this.dJ=Function.createDelegate(this,this.cP);this.dK=Function.createDelegate(this,this.dU);this.dL=Function.createDelegate(this,this.dV);this.dl=Function.createDelegate(this,this.eN);this.di=Function.createDelegate(this,this.eI);this.dj=Function.createDelegate(this,this.eK);this.dQ=Function.createDelegate(this,this.eR);this.bD=Function.createDelegate(this,this.eJ);this.dP=Function.createDelegate(this,this.eO);this.cz=Function.createDelegate(this,this.eH);this.dk=Function.createDelegate(this,this.eM);this.cM=Function.createDelegate(this,this.eo);this.dO=Function.createDelegate(this,this.eL);this.dR=Function.createDelegate(this,this.eS);this.dh=Function.createDelegate(this,this.ex);this.dN=Function.createDelegate(this,this.eF);this.dT=Function.createDelegate(this,this.dD);this.dM=Function.createDelegate(this,this.eE);this.dS=Function.createDelegate(this,this.eU);_mcp.f.initializeBase(this,[1,n,t,i]);this.dn={};this.dZ()&&(this.cf=new _fp.h(_a.g.a,i.h()));this.bo=this.ds(0);this.bn=this.ds(1);this.bp=this.ds(2);this.ci=new _j.g(this.dS,this.bm());this.cr=new _j.g(this.dM,this.bm());this.bP=new _j.g(this.dT,this.bm());this.cd=new _j.g(this.dN,this.bm());this.cp=new _j.g(this.dh,this.bm());this.cA=new _j.g(this.dR,this.bm());this.bY=new _j.g(this.dO,this.bm());this.ch=new _j.q;this.er()};_mcp.f.d=function(n,t){n.bb(t)};_mcp.f.b=function(n,t){n.bV(t)};_mcp.f.e=function(n,t){n.cT(t)};_mcp.f.c=function(n,t){n.dK(t)};_mcp.f.a=function(n,t){n.dJ(t)};_mcp.f.prototype={bo:null,bn:null,bp:null,ci:null,cr:null,bP:null,cd:null,cp:null,cA:null,bY:null,cw:null,cn:null,cm:null,cu:null,bA:null,bT:null,bR:null,ct:null,cq:null,cv:null,cs:null,dc:null,cR:null,db:null,cQ:null,br:null,bE:null,cY:!1,bs:!1,bu:null,co:null,cO:null,cD:null,dA:!1,dC:!1,da:!1,cZ:!1,ch:null,bZ:null,bB:null,cT:null,cU:null,cE:null,cS:null,cF:!0,T:function(n){this.bz("ResolveOperationSucceeded",n)},I:function(n){this.bM("ResolveOperationSucceeded",n)},R:function(n){this.bz("ResolveOperationCanceled",n)},H:function(n){this.bM("ResolveOperationCanceled",n)},U:function(n){this.bz("UpdateContext",n)},be:function(n){this.bM("UpdateContext",n)},dn:null,cf:null,m:function(){return this.cf},cW:function(n){if(this.br!==n){this.br=n;this.bv("FromPersonaViewModel")}return n},N:function(){return this.br&&this.br.bX?this.br.bX.a():null},eC:function(){return!!this.bx&&this.bx.a().K().Enabled&&_y.c.a.a()==="Mouse"},dZ:function(){return!!this.bx&&this.bx.a().cY().Enabled},Z:function(){var n=(this.bo.E()+this.bn.E()+this.bp.E()).trim();return n===""?n:n.substring(0,n.length-1)},n:function(){if(!this.bE){var n=this;this.bj.dx.a(function(t){if(n.bq()){_j.e.a(_a.a.a,"get_FromFindRecipientViewModel: viewModel is null or disposing, aborting logic.");return}var i=t.a(null,null,0,0,!0);i.z(!0);i.bF(!1);i.cH(100);i.bG(0);i.cF("PersonaDetailedView");i.ch();i.M(!0);i.bJ(new _j.g(n.cM,_a.a.a));n.bV.b()&&i.bI(new _j.g(n.cM,_a.a.a));_y.c.a.a()!=="Mouse"&&i.cy(new _j.g(n.cM,_a.a.a));i.T(n.dk);n.bE=i;if(n.da){n.dD();n.da=!1}else if(n.cZ){n.dz();n.cZ=!1}})}return this.bE},x:function(){return this.cY},K:function(n){if(this.cY!==n){this.cY=n;this.bv("ShouldHighlightFromAsInvalid")}return n},c:function(){return this.bo},g:function(){return this.bn},o:function(){return this.bp},eZ:function(){var n=this.bl.a.Z.z()&&(!!this.br&&this.br.eZ()||!!this.bE&&this.bE.co());return n||this.bo.eZ()||this.bn.eZ()||this.bp.eZ()},v:function(){return this.bs},eT:function(n){this.bs=n;this.bv("IsReadWrite");return n},cN:!1,ba:function(){return this.cN},bb:function(){return this.dA},cX:function(n){this.dA=n;this.bv("IsPeoplePickerShown");return n},w:function(){return this.bY},z:function(){return this.ci},bc:function(){return this.bP},q:function(){var n=this.bl.a.Z;return!!n.n()&&!!n.n().Mailbox&&!_a.K.a(n.n().Mailbox.EmailAddress)},dm:!1,cc:!1,cB:function(){this.dc||(this.dc=new _y.h(_nbs.a.qT,this.bP));return this.dc},dv:function(){this.cR||(this.cR=new _y.h(_nbs.a.PV,this.cd));return this.cR},dy:function(){this.db||(this.db=new _y.h(_nbs.a.LK,this.ci));return this.db},du:function(){this.cQ||(this.cQ=new _y.h(_nbs.a.SV,this.cr));return this.cQ},ea:function(){return!this.bl.a.Z.R()},dw:function(){return this.bl.a.Z.R()},X:function(){return this.dq(this.bs?this.bo.a.I:this.bo.b.b())||this.dq(this.bs?this.bn.a.I:this.bn.b.b())||this.dq(this.bs?this.bp.a.I:this.bp.b.b())},p:function(){return this.bo.f()||this.bn.f()||this.bp.f()},Y:function(){return this.bo.g()&&this.bn.g()&&this.bp.g()},dY:function(){return this.bl.a.Z.R()||this.bl.a.dA()},bW:null,A:function(){return this.bW},bG:function(){if(!this.bA){var n=this.es();this.bA=this.bj.bR.b(1,_bc.e.a,n,2,!1,!0,!1,0,0,this.bx,null,!0,this.bj.bq());this.bA.c(!1);this.bW=new _j.l;this.bW.m(this.bA.a().d())}return this.bA},bH:function(){if(this.bA&&this.bW){var t=this.bA.a().x.length;var n=this.F()-t;if(n>0)return String.format(_u.n.FJ,n)}return""},bJ:function(){return null},y:function(){return this.dx()?!1:this.cF},L:function(n){if(this.dx())return n;if(this.cF!==n){if(n){if(this.F()<=0)return n;this.f();this.bo.d.l(this.bk.f());this.bn.d.l(this.bk.k());this.bp.d.l(this.bk.b())}this.cF=n;this.bv("ShowAggregatedHeader");this.eg()}return n},bI:function(){return!1},dx:function(){return!this.bj.bk()},eb:function(){return this.bj.bk()},G:function(n){return this.cC(n).a.G},V:function(n,t){this.cC(t).a.bE(n)},bf:function(n){this.cC(n).a.E()},d:function(n){this.cC(n).bh()},b:function(n){return this.cC(n).a},bi:function(){this.bo.I();this.bn.I();this.bp.I()},bh:function(n){this.cD=n},et:function(n,t,i){if(this.bu){this.bu.c(this.co);this.bu.a(i);this.co=i;this.bu.d(t);this.bu.e(n);this.cX(!0);this.bl.a.bM(this.bu)}else{var r=this;this.bj.dJ.a(function(u){if(r.bq()){_j.e.a(_a.a.a,"BuildAndLaunchRichPeoplePickerViewModel: viewModel is null or disposing, aborting logic.");return}r.bu=u.a(n,t,r.bj.bq());r.bu.a(i);r.bu.b(r.cz);r.co=i;r.cX(!0);r.bl.a.bM(r.bu)})}},eq:function(){this.dp(0);this.dp(1)},a:function(){return this.ch},eu:function(n,t,i,r){var u=null;this.cT=n;this.cU=r;this.cE=t;this.cS=i;r&&(u=this.ee(this.cU));if(!this.bB&&u){var f=this;this.bj.dK.a(function(t){if(!f.bq()){f.bB=t.a();f.ef(n,u)}})}else if(u){this.bB.a(this.cO);this.ef(n,u)}},ef:function(n,t){this.bB.d(this.cz);this.bB.c(this.cT);this.bB.b(this.cS);this.cO=n;t.a.H().cG(this.bB);this.cX(t.q=!0);t.a.H().cJ()},ee:function(n){var t=null;n===_u.n.PT?t=this.bo:n===_u.n.Pu?t=this.bn:n===_u.n.Rg&&(t=this.bp);return t},h:function(){var n=this.bl.a.Z;var t=n.F();this.eT(!t||!!t.a()||t.o()||t.b());this.bZ=new _mcp.j(n.V(),this.dY(),this.bx);if(n.bQ()&&n.bQ().b()>0){this.bo.V(n.bQ(),this.bs,_u.n.PT);n.er(null)}else{var u,f;var e=(f=this.bZ.m(u={val:n}),n=u.val,f);this.bo.F(e,n.bo(),this.bs,_u.n.PT)}this.bn.F(n.k(),n.bh(),this.bs,_u.n.Pu);this.bk.fz(this.bk.ct()||!this.dY()&&(this.bj.fm()||this.bj.bk()?!!n.k()&&n.k().b()>0:!0));this.bZ.o(this.bs?this.bo.a:this.bo.b,this.bs?this.bn.a:this.bn.b);_y.c.a.i()&&this.ej(!0);this.eq();var i=_g.a.a().c();if(!_j.h.a(i.bB.SharePointUrl)&&!_j.h.a(i.bB.LogonEmailAddress)){var r=new _g.N;r.Mailbox=this.dr(i.bB.LogonEmailAddress);n.cH(r)}("Mouse"===_y.c.a.a()||n.n()||_g.a.a().a().bB.AlwaysShowFrom||n.b()&&n.b().b()>0||_g.a.a().a().bB.AlwaysShowBcc)&&this.bX();this.ek(n);if(this.eb()){this.bo.y(this.bj.Z.f());this.bn.y(this.bj.Z.k());this.bp.y(this.bj.Z.b());this.L(this.F()>0)}_mcp.q.prototype.h.call(this);this.dZ()&&this.cf.e(this.B())},eQ:function(){if(this.bW){this.bW.g();this.bW=null}if(this.bA){if(this.bA.a()){this.bA.h(!0);var n;_a.h.a(n={val:this.bA}),this.bA=n.val}this.bA=null}},f:function(){this.bX();var n=this.bk;this.dd();this.dB(n,this.bo,this.dP,_mcp.f.e);this.dB(n,this.bn,_mcp.f.d,_mcp.f.c);this.dB(n,this.bp,_mcp.f.b,_mcp.f.a);this.cg("UpdateContext")},S:function(n){var u=this.bG().a().x.length;var i=u-1;if(n<i)this.bG().a().r(n+1,i-n);else if(n>i)for(var t=u;t<=n;t++)this.bG().a().a(this.bW.x[t]);var r=!1;this.bG().a().x.length<this.bW.x.length&&(r=!0);this.bG().c(r);this.bv("RecipientsTruncatedString")},M:function(n,t){var r=_a.K.a(n);if(r){this.n().d("");var e=this.dr(n);var o=_pc.a.a(e,!1);var f=this.bl.a.bR.c;var i=f.a(o,4,!0,2,this.bj.bq(),!1,!1);i.H(this.cA);i.b(!0);i.cw=!0;this.cW(i);this.ew()}else{this.n().d(n);this.cW(null)}if(t&&_a.cu.a){var u=this.bl.a.dc();u.a(1)}this.K(!r);this.f()},F:function(){this.bX();return this.bo.h()+this.bn.h()+this.bp.h()},s:function(){this.bX();return this.bo.h()},E:function(){this.bX();return this.bn.h()},C:function(){this.bX();return this.bp.h()},bg:function(n){this.L(!1);this.bX();this.dd();this.ev();this.dC=n;this.ez()},B:function(){var n=new _j.q;this.bo.a?n.h(this.bo.a.g()):this.bo.b&&n.h(this.bo.b.g());this.bn.a?n.h(this.bn.a.g()):this.bn.b&&n.h(this.bn.b.g());this.bp.a?n.h(this.bp.a.g()):this.bp.b&&n.h(this.bp.b.g());return n.i()},u:function(n){this.cf&&this.cf.c(n)},bw:function(){var c;_a.h.a(c={val:this.br}),this.br=c.val;if(this.bu){this.bu.c(this.co);this.bu.f(this.cz);this.bu.dispose();this.bu=null;this.co=null}if(this.eC()&&this.bB){this.bB.f(this.cz);this.bB.a(this.cT);this.bB.e(this.cS);this.bB.dispose();this.bB=null;this.cO=null;this.cE=null}this.eh();if(this.bE){this.bE.V(this.dk);this.bE.dispose();this.bE=null}this.eQ();this.eh();this.eP();this.ch.f();var h;_a.h.a(h={val:this.bo}),this.bo=h.val;var s;_a.h.a(s={val:this.bn}),this.bn=s.val;var l;_a.h.a(l={val:this.bp}),this.bp=l.val;var y;_a.h.a(y={val:this.ci}),this.ci=y.val;var v;_a.h.a(v={val:this.cr}),this.cr=v.val;var a;_a.h.a(a={val:this.bP}),this.bP=a.val;var o;_a.h.a(o={val:this.cd}),this.cd=o.val;var i;_a.h.a(i={val:this.cp}),this.cp=i.val;var t;_a.h.a(t={val:this.cA}),this.cA=t.val;var n;_a.h.a(n={val:this.bY}),this.bY=n.val;var r;_a.h.a(r={val:this.cw}),this.cw=r.val;var e;_a.h.a(e={val:this.cn}),this.cn=e.val;var f;_a.h.a(f={val:this.cm}),this.cm=f.val;var u;_a.h.a(u={val:this.cu}),this.cu=u.val;this.bZ=null;this.cD=null;_mcp.q.prototype.bw.call(this)},bO:function(){var n=new _j.q;if(!this.bk.R()&&!this.bj.bZ()){this.ct=new _fm.d(_nbs.a.LK,null,this.ci);_g.a.a().a().bB.AlwaysShowBcc&&this.ct.a(!0);n.c(this.ct);this.cq=new _fm.d(_nbs.a.SV,null,this.cr);_g.a.a().a().bB.AlwaysShowBcc||this.cq.a(!0);n.c(this.cq)}if(this.bk.bJ()||this.bk.K()){var i=this.bl.b(1);this.bT=new _fm.d(_nbs.a.qT,null,this.bP);n.c(this.bT);this.bP.c(!this.bk.K());this.bR=new _fm.d(_nbs.a.PV,null,this.cd);this.bT.a(this.bk.z());this.bR.a(!this.bk.z());n.c(this.bR)}if(!this.bk.R()&&!_y.c.a.i()&&!this.bj.bk()&&_y.c.a.a()!=="TouchNarrow"){var t=new _fm.d(_nbs.a.io,null,this.bY);n.c(t)}return n.i()},bQ:function(){var n=new _j.q;if(this.bk.bJ()||this.bk.K()){this.cv=_mcp.q.a(this.bP,_nbs.a.qT);n.c(this.cv);this.cs=_mcp.q.a(this.cd,_nbs.a.PV);n.c(this.cs);this.bP.c(!this.bk.K());this.cv.b(!this.bk.z());this.cs.b(this.bk.z())}if(!this.bk.R()&&!_y.c.a.i()){var t=_mcp.q.a(this.bY,_nbs.a.io);n.c(t)}return n.i()},bF:function(){var n=new _j.q;_g.a.a().a().bB.AlwaysShowBcc?n.c(this.du()):n.c(this.dy());if(this.bk.bJ())if(_g.a.a().a().bB.AlwaysShowFrom){n.c(this.dv());this.cc=!1}else{n.c(this.cB());this.cc=!0}else this.cc=!1;_a.g.b||n.c(new _y.h(_nbs.a.io,this.bY));return n.i()},cy:function(){var n=this.bk;var t=this.bj.ev;if(t){var u=n.z()?this.dv():this.cB();var f=n.z()?this.cB():this.dv();t.K(f,u);var i=n.Y()?this.du():this.dy();var r=n.Y()?this.dy():this.du();t.K(r,i)}},ca:function(){if(this.bT&&this.bR){this.bT.a(this.bk.z());this.bR.a(!this.bk.z())}if(this.ct&&this.cq){this.ct.a(this.bk.Y());this.cq.a(!this.bk.Y())}},ce:function(){if(this.cv&&this.cs){this.cv.b(!this.bk.z());this.cs.b(this.bk.z())}},ez:function(){this.bo.c?this.bo.C():this.dV(!0)},dV:function(n){n?this.bn.c?this.bn.C():this.dU(!0):this.cP(!1)},dU:function(n){n?this.bp.c?this.bp.C():this.cP(!0):this.cP(!1)},cP:function(n){if(this.dC)if(n){_j.e.a(_a.a.a,"Force resolve completed");this.cg("ResolveOperationSucceeded")}else{_j.e.a(_a.a.a,"Force resolve cancelled");this.cg("ResolveOperationCanceled")}},W:function(){this.bX();this.dd();this.bo.B();this.bn.B();this.bp.B()},bX:function(){if(!this.dm){this.dm=!0;var n=this.bl.a.Z;this.bp.F(n.b(),n.N(),this.bs,_u.n.Rg);if(n.b()&&0<n.b().b()||!_j.h.a(n.N())||_g.a.a().a().bB.AlwaysShowBcc){n.cb(!0);_j.e.a(_a.a.a,"Showing BCC field due to: BccCount={0}, HasBccQueryString={1}, AlwaysShowBcc={2}",n.b()?n.b().b():0,!_j.h.a(n.N()),_g.a.a().a().bB.AlwaysShowBcc)}this.dp(2);_j.e.a(_a.a.a,"Recipient component initialized, ShouldValidate={0}, From={1}, ToCount={2}, CcCount={3}, BccCount={4}",!0,!n.n()||!n.n().Mailbox?"<not set>":n.n().Mailbox.EmailAddress,n.f()?n.f().b():0,n.k()?n.k().b():0,n.b()?n.b().b():0);this.ek(n);if(this.ei(n)){_j.e.a(_a.a.a,"Showing From field due to: From={0}, AlwaysShowFrom={1}",!n.n()||!n.n().Mailbox?"<not set>":n.n().Mailbox.EmailAddress,_g.a.a().a().bB.AlwaysShowFrom);this.n()?this.dz():this.cZ=!0}else if(_g.a.a().a().bB.AlwaysShowFrom&&n.F()&&!n.F().b()){var t=this.bl.a.ba;t.b(4525);t.a(4525);this.bj.be()}}},bd:function(){this.bo.G();this.bn.G();this.bp.G()},r:function(){_j.e.a(_a.a.k,"MailComposeRecipientComponent.GetAllEmailAddresses");var f=this.bl.a.Z;var n=new _j.q;var r=this.bs?this.bo.a.I:this.bo.b.b();var i=this.bs?this.bn.a.I:this.bn.b.b();var t=null;this.bs&&this.bp.a?t=this.bp.a.I:!this.bs&&this.bp.b&&(t=this.bp.b.b());if(r){_j.e.a(_a.a.k,"MailComposeRecipientComponent.GetAllEmailAddresses: Adding to addresses");n.h(r.d())}if(i){_j.e.a(_a.a.k,"MailComposeRecipientComponent.GetAllEmailAddresses: Adding cc addresses");n.h(i.d())}if(t){_j.e.a(_a.a.k,"MailComposeRecipientComponent.GetAllEmailAddresses: Adding bcc addresses");n.h(t.d())}_j.e.a(_a.a.k,"MailComposeRecipientComponent.GetAllEmailAddresses: Adding from address");var u=f.bv();n.c(u);return n},eS:function(){if(this.br){_j.e.a(_a.a.a,"User selected from persona");this.br.A(!0);this.cD&&this.cD()}else _j.e.a(_a.a.a,"User tries to select from persona, but it is null")},eL:function(){this.bl.a.bi().a("ResolveRecipients");this.bg(!1)},ex:function(){_j.e.a(_a.a.a,"User chose to delete from persona");this.cW(null);this.n().W(!0)},eo:function(){this.M(this.n().c(),!0)},eM:function(n,t){this.ep()},ds:function(n){return new _mcp.B(this.bl.a.bR,this,this.bx,this.bl,this.dn,this.cf,n,this.bj.Z.a(),this.bj.bq())},ei:function(n){return n.bJ()&&!this.bj.bk()&&(!!n.n()||_g.a.a().a().bB.AlwaysShowFrom||this.eG())},eg:function(){!this.cF&&_g.a.a().a().bB.AlwaysShowFrom&&this.dD()},eO:function(n,t){if(this.bZ){var i;this.bZ.l(t,i={val:n}),n=i.val}else n.s(t)},eJ:function(n,t){this.ch.f();this.dE(this.bo);this.dE(this.bn);this.dE(this.bp)},dE:function(n){n.a?this.ch.c(n.a):n.b&&this.ch.c(n.b)},er:function(){this.bo.apcl("ReadWriteRecipientWellViewModel",this.bD);this.bn.apcl("ReadWriteRecipientWellViewModel",this.bD);this.bp.apcl("ReadWriteRecipientWellViewModel",this.bD);this.bo.apcl("ReadOnlyRecipientWellViewModel",this.bD);this.bn.apcl("ReadOnlyRecipientWellViewModel",this.bD);this.bp.apcl("ReadOnlyRecipientWellViewModel",this.bD)},eP:function(){this.bo.rpcl("ReadWriteRecipientWellViewModel",this.bD);this.bn.rpcl("ReadWriteRecipientWellViewModel",this.bD);this.bp.rpcl("ReadWriteRecipientWellViewModel",this.bD);this.bo.rpcl("ReadOnlyRecipientWellViewModel",this.bD);this.bn.rpcl("ReadOnlyRecipientWellViewModel",this.bD);this.bp.rpcl("ReadOnlyRecipientWellViewModel",this.bD)},eI:function(n,t){this.L(!1);this.bo.f()||this.bn.f()||this.bp.f()||(this.bV.b()?this.bl.a.ba.b(97):this.bl.a.ba.b(65));this.bo.g()&&this.bn.g()&&this.bp.g()||this.bl.a.ba.b(70);_y.c.a.i()&&this.ej(!1);if(t&&t.c===2){var i=this.bl.a.dc();i.b();_a.br.a&&_j.m.a().c(_a.a.I,"TriggerPolicyTipsIfNeeded",this.dQ)}},eN:function(n,t){this.bZ&&this.bZ.n(n,t)},ev:function(){this.bo.a&&this.bo.a.bo();this.bn.a&&this.bn.a.bo();this.bp.a&&this.bp.a.bo()},eH:function(){this.cX(!1);var n=this.ee(this.cU);n&&(n.q=!1);this.cE&&this.cE()},eh:function(){this.cV(0);this.cV(1);this.cV(2)},dp:function(n){var t=this.cV(n);if(t){t.ci(this.ed(n));t.ek(this.dj);t.G.e(this.di);n||t.G.e(this.dl)}return t},cV:function(n){var t=null;switch(n){case 0:t=this.bo.a;break;case 1:t=this.bn.a;break;case 2:t=this.bp.a;break}if(t){t.cs(this.ed(n));t.ew(this.dj);t.G.f(this.di);n||t.G.f(this.dl)}return t},ed:function(n){switch(n){case 0:return this.dL;case 1:return this.dK;case 2:return this.dJ;default:throw Error.notImplemented("a new recipient type has been introduced and mail compose recipient component does not work with it");}},eK:function(){this.bj.be()},eU:function(){var t=_a.c.b(_a.a.a,"MailComposeShowBcc",!0);this.bl.a.bi().a("ShowBcc");_j.e.a(_a.a.a,"User chose to show bcc");this.bX();var n=this.bl.a.Z;if(!n.Y()){n.cb(!0);this.bv("ShowBccButton");this.bj.be();this.bt()}_a.c.a(t)},eE:function(){var t=_a.c.b(_a.a.a,"MailComposeHideBcc",!0);this.bl.a.bi().a("HideBcc");_j.e.a(_a.a.a,"User chose to hide bcc");this.bX();var n=this.bl.a.Z;if(n.Y()){n.cb(!1);this.bv("ShowBccButton");this.bj.be();this.bt()}_a.c.a(t)},ek:function(n){if("Mouse"!==_y.c.a.a()){var f=this.bl;var u=f.a;var r=u.ev;if(r){var i=r.a;if(i)if(n.bJ()){if(!this.cc)for(var t=0;t<i.length;t++)if(_nbs.a.LK===i[t].b){r.w(this.cB(),t+1);this.cc=!0}}else if(this.cc){u.ev.t(this.cB());this.cc=!1}}}},dd:function(){var i=this.bl.a.Z;var n=null;if(i.z()){var t=null;this.br?t=this.br.bX.a():this.bE&&!_j.h.a(this.bE.c())&&(t=this.dr(this.bE.c()));n=new _g.N;n.Mailbox=t;i.cH(n);this.q()||this.bl.a.ba.b(66)}return n},eG:function(){var t=!1;if(this.bV.b()){var n=_g.a.a().c();t=n.e().b()>0||!!n.a()&&n.a().b()>0||n.b().b()>1}return t},es:function(){var n=new _j.l;if(this.bk){this.bk.f()&&n.m(this.bk.f().d());this.bk.k()&&n.m(this.bk.k().d());this.bk.b()&&n.m(this.bk.b().d())}return n},dr:function(n){var t=new _g.f;t.MailboxType="Mailbox";t.RoutingType="SMTP";t.EmailAddress=n;return t},ew:function(){var t=_mcp.B.b;var n=[];(t&4)==4&&Array.add(n,new _fm.d(_u.n.Ng,null,new _j.g(this.dI,_a.a.a)));(t&2)==2&&Array.add(n,new _fm.d(_u.n.MQ,null,new _j.g(this.dh,_a.a.a)));this.br.cs&&(t&1)==1&&Array.addRange(n,this.br.cs);this.br.be(n)},dz:function(){var t=this.bl.a.Z;var n=null;var i=_g.a.a().c();n=_j.h.a(i.bB.SharePointUrl)||_j.h.a(i.bB.LogonEmailAddress)?null!==t.n()&&t.n().Mailbox?t.n().Mailbox.EmailAddress:_mco.a.g(null)||i.bB.UserEmailAddress:i.bB.LogonEmailAddress;var u=this.bj.ce();u.a()||u.h();var r;var e,f;(f=u.c(n,e={val:r}),r=e.val,f)&&(n=r);this.M(n,!1);t.ea(!0);var o=this.dd();t.eN()&&t.eN().z(o);this.bt()},ey:function(){var n=this.br.bX.a().EmailAddress;this.cW(null);this.n().d(n);this.n().W(!0)},ep:function(){var n=this.n().L();if(n&&n.a()&&n.a().a()){var t=n.a().a().EmailAddress;_j.e.a(_a.a.a,"User selected from={0}",t);this.M(t,!0)}else _j.e.b(_a.a.a,"User selected from but the SelectedResultItem persona is invalid")},dD:function(){if(!this.n()){this.da=!0;return}var t=_a.c.b(_a.a.a,"MailComposeShowFrom",!0);this.bl.a.bi().a("ShowFrom");var n=this.bl.a.Z;if(n.z())_j.e.a(_a.a.a,"Skip show from since it is already shown");else{_j.e.a(_a.a.a,"User chose to show from");this.L(!1);this.cN=!0;this.dz();this.bj.be();this.bt()}_a.c.a(t)},eF:function(){this.L(!1);var t=_a.c.b(_a.a.a,"MailComposeHideFrom",!0);this.bl.a.bi().a("HideFrom");var n=this.bl.a.Z;if(n.z()){n.ea(!1);this.cN=!1;this.bj.be()}else _j.e.a(_a.a.a,"Skip hide from since it is already hidden");this.bt();this.bl.a.ba.b(750);_a.c.a(t)},dB:function(n,t,i,r){var u=this.bs?t.a:t.b;if(u){i(n,u.b());if(_rw.d.isInstanceOfType(u)){var f=u;f.H()&&r(n,f.H().c())}}},ej:function(n){var e=this.bl.a.Z;var i=!1;var u=e.bv();if(u){var t=this.bs?this.bn.a.I:this.bn.b.b();if(t)for(var r=0;r<t.x.length;r++){var f=t.x[r];if(u.EmailAddress.toLowerCase()===f.EmailAddress.toLowerCase()){i=!0;break}}}if(n&&i){this.bl.a.ba.b(4450);this.bl.a.ba.a(4450)}else n||i||this.bl.a.ba.b(4450)},dq:function(n){if(!n||!n.x.length)return!1;for(var t=0;t<n.x.length;t++){var i=n.x[t];if(i&&i.MailboxType==="GroupMailbox")return!0}return!1},dt:function(n){var t=this.bo.z(n)||this.bn.z(n)||this.bp.z(n);t&&n.a.dj(t)},ec:function(){if(!this.cw){var n=this;this.cw=new _j.g(function(){n.dt(n.bo)},_a.a.a)}return this.cw},dX:function(){if(!this.cn){var n=this;this.cn=new _j.g(function(){n.dt(n.bn)},_a.a.a)}return this.cn},dW:function(){if(!this.cm){var n=this;this.cm=new _j.g(function(){n.dt(n.bp)},_a.a.a)}return this.cm},eD:function(){if(!this.cu){var n=this;this.cu=new _j.g(function(){n.bk.fz(!0);n.bj.be();n.bl.a.bi().a("ShowCc")},_a.a.a)}return this.cu},cC:function(n){switch(n){case 0:return this.bo;case 1:return this.bn;case 2:return this.bp;default:throw Error.argument();}},eR:function(){_mcp.I.a(this.bj,1)}};_mcp.F=function(n){_mcp.F.initializeBase(this,[31,n])};_mcp.F.d=function(n,t){for(var i=0;i<n.length;i++)if(n[i]===t||t&&n[i]&&n[i].toLowerCase()===t.toLowerCase())return!0;return!1};_mcp.F.c=function(n){var t=_g.a.a().c();t?Array.add(n,t.bB.UserEmailAddress):_j.e.b(_a.a.a,"SessionSettings is null.")};_mcp.F.b=function(n,t){t.bB.From&&t.bB.From.Mailbox&&t.bB.From.Mailbox.EmailAddress&&Array.add(n,t.bB.From.Mailbox.EmailAddress)};_mcp.F.a=function(n,t){if(t)for(var i=0;i<t.b();i++)Array.add(n,t.a(i).EmailAddress)};_mcp.F.prototype={a:function(n){if(!n)throw Error.argumentNull("originalMessage");var u=[];var t=[];_mcp.F.c(t);_mcp.F.b(t,n);_mcp.F.a(t,n.m());_mcp.F.a(t,n.p());for(var f=this.bj.bb().r(),r=0;r<f.d.length;r++){var i=f.d[r];if(i&&!_mcp.F.d(t,i.EmailAddress)){Array.add(u,i);Array.add(t,i.EmailAddress)}}return u}};_mcp.B=function(n,t,i,r,u,f,e,o,s){this.M=Function.createDelegate(this,this.ba);this.L=Function.createDelegate(this,this.Z);this.O=Function.createDelegate(this,this.bc);this.N=Function.createDelegate(this,this.bb);this.w=Function.createDelegate(this,this.be);this.u=Function.createDelegate(this,this.X);this.v=Function.createDelegate(this,this.bd);this.p=Function.createDelegate(this,this.Y);this.K=Function.createDelegate(this,this.W);_mcp.B.initializeBase(this);this.o=n;this.n=t;this.m=i;this.e=r;this.H=u;this.A=f;this.r=e;this.x=o;this.s=s};_mcp.B.prototype={o:null,m:null,j:null,a:null,b:null,d:null,n:null,i:null,k:null,t:null,e:null,H:null,A:null,s:!1,U:function(){return!!this.m&&this.m.a().K().Enabled&&_y.c.a.a()==="Mouse"},S:function(n){if(this.a!==n){this.a=n;this.bv("ReadWriteRecipientWellViewModel")}return n},q:!1,Q:function(){this.j||(this.j=new _j.g(this.K,_a.a.bc));return this.j},l:0,bg:function(n){if(n!==this.b){this.b=n;this.bv("ReadOnlyRecipientWellViewModel")}return n},E:function(){return this.a?this.R(!0):""},bf:function(n){if(n!==this.d){this.d=n;this.bv("AggregatedRecipientWellViewModel")}return n},g:function(){return this.c&&_rw.c.h(this.a)},c:!1,f:function(){return this.c&&!!this.a&&this.a.S},bh:function(){this.c&&this.a&&this.a.eh()},r:0,x:0,V:function(n,t,i){this.k=n;this.c=t;this.a?this.a.l(null):this.S(this.P(null));var r=this.a.H();if(r){r.d("");r.bB(this.k)}else this.a.apcl("FindRecipientViewModel",this.p);this.i=i},F:function(n,t,i,r){this.c=i;this.t=t;if(this.c){this.a?this.a.l(n):this.S(this.P(n));var u=this.a.H();if(u){_j.h.a(t)||u.d(t);this.a.dU()}else this.a.apcl("FindRecipientViewModel",this.p);this.i=r;this.a.G&&this.a.G.e(this.v)}else this.b?this.b.l(n):this.bg(this.T(n))},C:function(){this.a&&this.a.cm()},B:function(){this.a&&!this.q&&this.a.bv()},I:function(){if(this.a&&this.a.H().by())if(this.a.H().cn()){this.a.dc(!0);this.a.dc(!1)}else{this.a.de(!0);this.a.de(!1)}},h:function(){var n;n=this.c?this.a?!this.a.H()||_j.h.a(this.a.H().c())?this.a.I.x.length:this.a.I.x.length+1:0:this.b?this.b.b().x.length:0;return n},G:function(){if(this.a){var n=this.R(!1);n!==""&&_j.e.a(_a.a.a,"{0} Well Invalid Recipients are: {1} \n",this.i,n)}},R:function(n){var e="";if(this.a)for(var o="",f="",u,t,i=0,s=this.a.G.x.length;i<s;i++){u=this.a.G.x[i];if(u&&!u.l){t=this.a.I.x[i];if(t){f=_j.h.b(t.Name)?"":t.Name;var r=null;if(n)r=String.format("{0}, ",f);else{o=_j.h.b(t.EmailAddress)?"":t.EmailAddress;r=String.format("( {0} , {1} ),",f,o)}e+=r}}}return e},bw:function(){if(this.a){this.a.G&&this.a.G.f(this.v);this.a.ed(this.u);this.a.rpcl("SelectedRecipient",this.w);this.a.x(!1);this.a.h(!0);var i;_a.h.a(i={val:this.a}),this.a=i.val}if(this.b){this.b.h(!0);var r;_a.h.a(r={val:this.b}),this.b=r.val}if(this.d){this.d.h(!0);var n;_a.h.a(n={val:this.d}),this.d=n.val}var t;_a.h.a(t={val:this.j}),this.j=t.val;this.n=null;_j.Q.prototype.bw.call(this)},P:function(n){var t=this.o.a(_mcp.B.b,_pe.c.b,n,!0,!0,this.H,this.A,this.r,this.x,this.s,!0);t.dK(this.u);t.apcl("SelectedRecipient",this.w);return t},T:function(n){return this.o.b(_mcp.B.a,_bc.e.a,n,2)},y:function(n){this.bf(this.o.b(_mcp.B.a,_bc.e.a,n,2,!1,!0,!1,n?n.b():0,0,this.m,null,!1,this.s));return this.d},be:function(n,t){if(this.e){var i=n;var r=this.e.a;if(i.K!==i.bn){r.ba.f([10210,10211]);i.bn=null}}},X:function(n){if(this.e){var t=this.e.a;switch(n){case 1:t.ba.a(10210);break;case 0:t.ba.a(10211);break}}},Y:function(n,t){var r=n;var i=r.H();if(this.k&&this.k.x.length>0){i.d("");i.bB(this.k)}_j.h.b(this.t)||i.d(this.t);r.rpcl("FindRecipientViewModel",this.p)},W:function(){if(this.c&&!_a.g.b)if(this.U()){_j.e.a(_a.a.a,"User chose to launch the new people picker");_a.z.a.c("VM.PeoplePicker.Launched",_a.d.a());var t;_a.n.b(_a.a.bc,"LaunchV2PeoplePicker",!0,(t=new _a.O,t.b=!0,t));this.l=0;this.n.eu(this.N,this.O,this.L,this.i)}else{_j.e.a(_a.a.a,"User chose to launch rich people picker");this.a.bv();_a.z.a.c("VM.PeoplePicker.Launched",_a.d.a());var n;_a.n.b(_a.a.bc,"PeoplePicker",!0,(n=new _a.O,n.b=!0,n));this.n.et(this.a.G,this.i,this.M)}},Z:function(n){this.a&&this.a.H().N(n)},bb:function(n){var t=n;if(t.a()){_a.K.a(_g.n.c(t.a()))||t.a().RoutingType==="MAPIPDL"?this.a.y(t):this.a.bf(t);this.l++}},bc:function(){if(this.l>0){var n=new _cmc.g(_a.a.bc,"CloseV2ToPicker",!1);n.a("sc",this.l,!0,!0);n.b()}},ba:function(n){_y.c.a.a()!=="TouchNarrow"&&this.a.p();var t=this;n.o(function(n){var i=n;i.l?t.a.y(i.k):t.a.bf(i.k)})},z:function(n){var u=this.a.G;var r=null;if(this!==n)for(var t=0;t<u.x.length;t++){var i=u.x[t];if(i.x){r=i;this.a.bh(i);break}}return r},bd:function(n,t){this.e&&this.e.a&&this.e.a.fv(t,this.r)}};_mcp.z=function(n,t,i,r,u){this.T=Function.createDelegate(this,this.I);this.R=Function.createDelegate(this,this.bu);this.S=Function.createDelegate(this,this.bA);this.W=Function.createDelegate(this,this.bf);this.Z=Function.createDelegate(this,this.bg);this.V=Function.createDelegate(this,this.bD);this.U=Function.createDelegate(this,this.bB);this.m={};_mcp.z.initializeBase(this,[8,n,r,u]);this.H=t;this.u=new _j.g(this.U,this.bm());this.y=new _j.g(this.V,this.bm());this.B=n.a.bV;this.bb=i};_mcp.z.prototype={bb:null,n:null,B:null,H:null,u:null,y:null,s:!1,x:!1,A:null,z:null,w:null,o:null,d:function(){return this.u},j:function(){return this.y},c:function(){return this.s},K:function(n){if(n!==this.s){this.s=n;this.bv("IsSaving")}return n},bE:function(n){if(n!==this.w){this.w=n;this.bv("DraftSavedTime")}return n},r:function(){return this.bl&&this.bl.a&&this.bl.a.Z?this.bl.a.Z.d():null},t:!1,g:function(){return this.t},l:function(n){this.t=n;return n},q:!1,f:function(){return this.q},b:function(n,t){var i=this.bl;var f=i.b(5);var u=i.a.bh;var r=i.a.Z;_j.e.a(_a.a.a,"UserInitiatedSave - SaveStart");i.a.bi().a("Save");this.cj();if(!r.bI()){_j.e.a(_a.a.a,"Save not supported for the current operation {0}",r.a());return}if(f.b()){_j.e.a(_a.a.a,"Skip save and show attachment in progress dialog");u.p||u.g(0,_u.R.Dp,null);return}this.q=!0;this.a("Save",n,t,!1)},h:function(){this.Y();_mcp.q.prototype.h.call(this)},Y:function(){if(this.bj.cH()&&!this.o){_j.e.a(_a.a.a,"Setting save component override");this.o=this.bj.cG().d();var u=this.bj.bb();var o=this.bj.bc();var f=u,e=u,t=u,n=u,r=o,i=o;this.o.b(this.Z,this.W,f.k||(f.k=Function.createDelegate(f,f.s)),e.j||(e.j=Function.createDelegate(e,e.E)),t.i||(t.i=Function.createDelegate(t,t.C)),n.l||(n.l=Function.createDelegate(n,n.f)),r.c||(r.c=Function.createDelegate(r,r.k)),i.d||(i.d=Function.createDelegate(i,i.m)),_cmc.h.b,this.cG)}},X:function(){if(this.o){this.o.a();this.o=null}},a:function(n,t,i,r){if(this.o&&!this.o.c()){_j.e.a(_a.a.a,"saveComponentOverride.IsReadyForSmimeOperation() == false.  Save ignored.");return!0}var h=this.bl;var o=h.a;var u=o.Z;var c=o.ba;var f=u.d();var a=this.bl.b(5);var s=this.bj.bg();if(s.b()&&!r){_j.e.a(_a.a.a,"Send is in progress, this {0} save is ignored. ContextId={1}",n,f);return!0}if(this.B.a(f)){_j.e.a(_a.a.a,"User already discarded, clearing all save processors to ignore save effects. ContextId={0}",f);this.m={};return!1}var e=this.bj.bb();n==="AutoSave"&&this.bx&&this.bx.a().dP().Enabled||e.W();if(_g.a.a().bB.MaxRecipientsPerMessage<e.F()){c.a(800,null);this.bj.be();return!0}e.f();u.bD().a();this.m[n]=new _mcp.bY(t,i);if(!this.s||r){this.A=_mcp.c.b(u);this.K(!0)}else{this.x=!this.A.t(u);return!0}if(!u.m()&&!u.h()&&!u.L()){_j.e.a(_a.a.a,"Save was attempted during upgrade, remembering this save attempt and waiting for upgrade completion to resume this save. ContextId={0}",f);return!0}this.L(n);this.z=n;_j.m.a().j(_a.a.a,"MailComposeSave");_j.e.a(_a.a.a,"Started new task runner context before starting save.");try{this.o?this.o.d(n):this.bg(n);return!0}catch(l){this.bf(l);throw l;}},L:function(n){_a.H.a(_a.a.a,"MailComposeSave",5);this.n=_y.j.b(_a.a.a,"MailComposeSave",!0);this.n&&this.bk.eS&&this.n.n(_mcp.z.a)},i:function(){this.s=!1;this.x=!1;_j.e.a(_a.a.a,"ResumeSave");var i=this.m;for(var r in i){var n={key:r,value:i[r]};var t=n.value;this.a(n.key,t.a,t.b,!0);break}},bw:function(){this.s=!1;this.x=!1;this.q=!1;this.t=!1;this.m=null;this.A=null;this.X();var t;_a.h.a(t={val:this.u}),this.u=t.val;var n;_a.h.a(n={val:this.y}),this.y=n.val;_mcp.q.prototype.bw.call(this)},cx:function(n){return _db.h.c(n.I,40,50,60,700,88,89,43,57)},cH:function(n){if("ReadingPaneExit"in this.m||"Popout"in this.m){var u=this.bl.a;var t=u.ba;var f=this.cx(n);var e=new _y.cv;var i=e.a(f,null);t.f(_mcp.t.b);"ReadingPaneExit"in this.m?t.a(87,i):t.a(85,i);if(f===50){var r=this;u.cO.a(function(n){if(!r.bq()){n.a(t);r.bj.be()}})}else this.bj.be()}else"Save"in this.m&&_mcp.I.prototype.cH.call(this,n)},bO:function(){if(this.bk.a()!==8&&!this.bk.R()&&!_y.c.a.i()){var n=new _fm.d(_nbs.a.ES,null,this.bj.bj().d());return[n]}return null},bQ:function(){if(this.bk.a()!==8&&!this.bk.R()&&!_y.c.a.i()){var n=_mcp.q.a(this.u,_nbs.a.ES);return[n]}return null},bF:function(){return null},bg:function(n){_j.e.a(_a.a.bl,"Setup save action, OriParentFolderId={0}",this.bk.g()&&this.bk.g().bB.ParentFolderId&&_g.b.a?_g.b.a.idToName(this.bk.g().bB.ParentFolderId):"null");var t=this.bj.bT.h(this.bj,0);if((_mco.a.isInstanceOfType(t)||_mco.c.isInstanceOfType(t))&&("Attach"===n||"Popout"===n)&&this.bk.R()){var i=t;i.bm=new _g.E(new _g.r("internalsubmission"))}this.bj.bo.a(t,this.S,this.R,null);_j.e.a(_a.a.a,"Save action submitted")},bB:function(){this.bl.a.bi().a("Save");this.b(null,null)},bD:function(){_j.e.a(_a.a.a,"User chose to close and save");if(this.bj.bX()){_j.e.a(_a.a.a,"User hit close, the form is dirty, attempt to save and navigate away.");var n=this;this.b(function(){n.I()},null)}else if(this.bj.bm().b()&&this.bj.bh&&!this.bj.bh.p){_j.e.a(_a.a.a,"Addins are still running, prompting the user to terminate them");this.bj.bm().k(this.bj.bh,this.T)}else this.I()},bf:function(n){this.K(!1);this.q=!1;var t=n.toString();_y.j.a(this.n,null,t,null,this.G(this.z,n.message));this.n=null;_a.H.b("MailComposeSave");_j.e.b(_a.a.a,"Save failed due to an error before action was submitted: {0}",t)},be:function(n){var t=n.Y;var r=!1;if(this.B.a(t)){this.r()===t&&(this.m={});this.v(n);var u=_mcp.bj.a(n);if(u&&this.bl&&this.bl.a){_j.e.a(_a.a.a,"Resume discard for context {0}",t);this.bl.a.bp().c(t,u)}r=!0}else if(t===this.r()){if(this.t){this.t=!1;_j.e.a(_a.a.a,"User issued send while save was in progress, now the save had come back, resume the send and cancel any pending saves. ContextId={0}",t);this.m={};this.v(n);var i=null;_db.e.isInstanceOfType(n)?i=n.F:_mco.c.isInstanceOfType(n)&&(i=n.bn);i&&this.bl.a.Z.H(i);var f=this.bj.bg();f.g();r=!0}else if(this.x){_j.e.a(_a.a.a,"Saving new content per user's request. ContextId={0}",t);this.i();r=!0}}else _j.e.a(_a.a.a,"Skipping default save processing due to ContextId={0}; viewModelId={1}",t,this.r());return r},bA:function(n){var u=n.Y;_j.e.a(_a.a.a,"Save action returned success, ContextId={0}",u);if(!this.be(n)&&u===this.r()){var f=this.bl;var o=f.a;this.bs(n);this.bd();var i=!1;var t=null;if("Attach"in this.m){if("AutoSave"in this.m){t=this.m.AutoSave;t&&t.a(n)}t=this.m.Attach}else if("Popout"in this.m){t=this.m.Popout;var r=o.bl();if(r&&r.k()&&"ReadingPaneExit"in this.m){t&&t.a(n);t=this.m.ReadingPaneExit}}else if("ReadingPaneExit"in this.m)t=this.m.ReadingPaneExit;else if("AutoSave"in this.m){t=this.m.AutoSave;i=!0}else if("Save"in this.m){t=this.m.Save;i=!0}else if("RehydrateUpgrade"in this.m){t=this.m.RehydrateUpgrade;i=!0}else"Diagnostics"in this.m&&(i=!0);t&&t.a&&t.a(n);if(i){var e=f.b(5);e.A()}this.m={}}_y.j.a(this.n,null,"",this.bc(n),this.G(this.z,""));this.n=null},bd:function(){var i="";var t=this.m;for(var n in t){var r={key:n,value:t[n]};i+=r.key+":"}_j.e.a(_a.a.a,"ProcessorKeys:{0}",i)},bu:function(n){var f=n.Y;_j.e.a(_a.a.a,"Save action returned a failure, ContextId={0}",f);if(!this.be(n)&&f===this.r()){this.bd();var t=!1;var c=this.m;for(var s in c){var i={key:s,value:c[s]};var h=i.value;if(h.b){h.b(n);if((i.key==="ReadingPaneExit"||i.key==="Popout")&&!t){this.ba(n);t=!0}}else if(!t){this.ba(n);t=!0}}t||this.v(n);this.m={}}var r;var u;var e,o;this.dg(n.I,e={val:r},o={val:u},"SaveFailure_UnknownError"),r=e.val,u=o.val;_y.j.a(this.n,null,r,this.bc(n),this.G(this.z,u));this.n=null},bs:function(n){var i=n.Y;if(i===this.r()){this.bG(n);this.bl.a.Z.cK(!1);this.bl.a.eW()}this.cg("MailSaveSucceeded");if(i===this.r()){var r=_a.d.a();var t=r.a(0);this.bE(this.bl.a.Z.bG()?String.format(_nbs.a.qB,t):String.format(_nbs.a.dZ,t))}_a.br.a&&this.bj&&this.bj.dd().a(this.q?4:2);this.v(n)},ba:function(n){_j.e.a(_a.a.a,"SaveActionFailed: Error: {0}",n.I.message);n.Y===this.r()&&this.cH(n);this.bl&&this.bl.a&&this.bl.a.bL&&this.bl.a.P(!1);this.v(n)},v:function(n){if(n.Y===this.r()){this.K(!1);this.q=!1}_a.H.b("MailComposeSave")},bc:function(n){var t=null;_db.e.isInstanceOfType(n)&&n.Q?t=n.Q.correlationId:_mco.c.isInstanceOfType(n)&&n.Q&&(t=n.Q.correlationId);return t},G:function(n,t){var i=new _a.l;i.b("Ctx",n||"");i.b("Err",t||"");return i.toString()},bG:function(n){var t=this.bl.a.Z;t.fo(this.A);if(this.q){t.fR(!0);this.q=!1;_j.e.a(_a.a.a,"Explicit save recorded. ContextId={0}",t.d())}if(_mco.a.isInstanceOfType(n)){var u=n;var r=u.F;u.k.bZ(r);t.H(r);t.dP(u.k);_j.e.a(_a.a.a,"Updated context from create action.");this.H.N(r)}else if(_mco.c.isInstanceOfType(n)){var i=n;var o=i.bn;i.f.bZ(o);t.H(o);t.dP(i.f);_j.e.a(_a.a.a,"Updated context from update action.")}else if(_mco.f.isInstanceOfType(n)){var a=n;var l=a.F;t.H(l);_j.e.a(_a.a.a,"Updated context from create response action. ")}else if(_mcp.w.isInstanceOfType(n)){var v=n;var p=v.e.i();t.H(p);_j.e.a(_a.a.a,"Updated context from create response from modern group action. ")}else if(_mcp.M.isInstanceOfType(n)){var y=n;var h=y.F;t.H(h);_j.e.a(_a.a.a,"Updated context from create approval response action. ")}if(_db.e.isInstanceOfType(n)&&t.P()){var c=n;var e=c.bW;var f=t.P().ex();if(e&&f){var s=0;var w=this;f.o(function(n){var t=n;t.f(e[s]);s++});_j.e.a(_a.a.a,"Attachment IDs have been updated.")}}},I:function(){this.bj.bl().a(this.bj,!1);_j.e.a(_a.a.a,"Navigated away from compose")}};_mcp.r=function(n,t){this.k=Function.createDelegate(this,this.q);this.j=Function.createDelegate(this,this.v);this.i=Function.createDelegate(this,this.u);_mcp.r.initializeBase(this,[18,n]);this.d=t.b()};_mcp.r.a=function(n,t){return new _fm.d(n,null,t,!0)};_mcp.r.prototype={d:!1,g:0,a:function(){return this.eB(_mcp.r.c)},p:function(n){this.eA(_mcp.r.c,n);return n},n:function(){var i=!1;if(this.d){var t=_g.a.a();var n=t.c().bB.UserEmailAddress.toLowerCase();i=n.startsWith("outlook_"+t.bB.HexCID)||n.endsWith("@shadow.outlook.com")}return i},h:function(){if(!this.a()){var n=this.d?[_mcp.r.a(_u.R.Nv,null)]:this.m(_mcp.r.a);if(n){this.p(new _fm.f(n));this.a().bP(new _j.g(this.i,this.bm()));this.a().u=this.j}}_mcp.I.prototype.h.call(this)},b:function(n){if(n&&n.Mailbox){var r=n.Mailbox.EmailAddress;if(r!==_g.a.a().c().bB.UserEmailAddress&&!_mco.a.f(n)){var t=_g.a.a().a().S();if(t){if(t.g(r))return;t.b()===1&&t.a(0)===""&&t.p(0)}var i=new _a.k;i.c(r);i.A(t);i.b()>_mcp.r.b&&i.p(i.b()-1);_g.a.a().a().bu(i);_h.f.a(_g.a.a().a().u,_a.g.a);this.s(r)}}},c:function(n,t){t.val=null;var r=_g.a.a().c().bB.UserEmailAddress;if(this.n()&&n===r){var i=this.o(r);t.val=i.length>0?i[0]:t.val}return!_j.h.a(t.val)},bw:function(){if(this.a()){this.a().dispose();this.p(null)}_mcp.I.prototype.bw.call(this)},v:function(){if(this.d&&!this.g){this.g=1;_j.m.a().a(this.bm(),"SendAsContextMenu",this.k,2e3);var n=new _mcp.bt;var i=this,r=this,t=this;this.bj.bo.a(n,function(t){_g.a.a().c().h(new _a.k(n.e));_g.a.a().c().g(new _a.k(n.f));_g.a.a().c().j(new _a.k(n.i))},function(n){_j.e.b(_a.a.a,"Fail to load alias list for consumer, use the alias list in userConfiguration instead.")},function(n){t.q()})}},s:function(n){if(!this.d&&this.a()){for(var r=_mcp.r.a(n,new _j.g(this.f(n),this.bm())),t=this.a().p,i=t.x.length-1;i>0;i--)if(_fm.i.isInstanceOfType(t.x[i])){t.s(i+1,r);var u=t.x.length-i-1;u>_mcp.r.b&&t.n(t.x.length-1);return}t.a(new _fm.i);t.a(r)}},u:function(){if(this.a()&&this.a().t){var f=this.a().t;var r=_g.a.a().a().S();var e=r.m(f.j);if(e){for(var n=this.a().p,t=n.x.length-1;t>0;t--)if(n.x[t].j===f.j){n.n(t);var u=n.x.length;_fm.i.isInstanceOfType(n.x[u-1])&&n.n(u-1);break}var i=new _a.k;r.b()>0?i.A(r):i.c("");_g.a.a().a().bu(i);_h.f.a(_g.a.a().a().u,_a.g.a)}}},m:function(n){var t=[];var i=_g.a.a().c().bB.UserEmailAddress;this.n()||Array.add(t,n(i,new _j.g(this.f(i),this.bm())));if(this.d){var r=this.r(t,n,i);this.l(t,n,r)}else{this.l(t,n,null);this.t(t,n)}return t},l:function(n,t,i){for(var r,f=_g.a.a().c().e(),e=f?f.b():0,u=0;u<e;u++){r=f.a(u).EmailAddress;i&&Array.contains(i,r)||Array.add(n,t(r,new _j.g(this.f(r),this.bm())))}},r:function(n,t,i){for(var f=this.o(i),e=f,o=e.length,r=0;r<o;++r){var u=e[r];Array.add(n,t(u,new _j.g(this.f(u),this.bm())))}return f},o:function(n){var o=new _a.k;if(this.d){for(var f,e,u=_g.a.a().c().b(),s=u?u.b():0,t=_g.a.a().c().a(),h=t?t.b():0,i=0;i<s;i++){f=u.a(i);n!==f&&o.c(f)}for(var r=0;r<h;r++){e=t.a(r);n!==e&&o.c(e)}}return o.f()},t:function(n,t){var i=_g.a.a().a().S();var r=i?i.b():0;if(r===1&&i.a(0)===""){i.p(0);r=0}if(r>0){var f;Array.add(n,new _fm.i);for(var u=0;u<r;u++){f=i.a(u);Array.add(n,t(f,new _j.g(this.f(f),this.bm())))}}},f:function(n){var t=this;return function(){_j.e.a(_a.a.a,"User chose from={0}",n);t.bl.a.bb().M(n,!0)}},q:function(){if(this.g===1&&!this.bq()){this.g=2;var n=this.m(_mcp.r.a);if(n&&this.a()&&this.a().p){this.a().p.g();this.a().p.m(n)}}}};_mcp.h=function(n,t,i,r){this.v=Function.createDelegate(this,this.U);this.u=Function.createDelegate(this,this.E);this.t=Function.createDelegate(this,this.C);this.o=Function.createDelegate(this,this.V);this.k=Function.createDelegate(this,this.O);this.l=Function.createDelegate(this,this.P);this.m=Function.createDelegate(this,this.Q);this.n=Function.createDelegate(this,this.R);this.w=Function.createDelegate(this,this.X);_mcp.h.initializeBase(this,[35,n]);this.q=t;this.s=i;this.p=r;this.j=_mcp.h.d("ms-font-color-neutralSecondary ms-bg-color-themeLighterAlt",["color","background-color"]);this.r=_mcp.h.d("ms-font-color-neutralDark ms-bg-color-themeLight",["color","background-color"])};_mcp.h.d=function(n,t){var i=_mcp.h.a("SPAN");i.style.display="none";document.body.appendChild(i);var e=i;e.setAttribute("class",n);for(var o="",f=t,s=f.length,r=0;r<s;++r){var u=f[r];o+=String.format("{0}: {1};",u,_j.k.h(e,u))}document.body.removeChild(i);return o};_mcp.h.a=function(n){return window.document.createElement(n)};_mcp.h.prototype={q:null,s:null,p:null,d:null,c:null,i:null,g:null,j:null,r:null,a:function(){this.i||(this.i=new _j.g(this.w,_a.a.a));return this.i},h:function(){if(this.e()){_j.e.b(_a.a.a,"MailComposeSendAvailableTimeComponent is already initialized, skipping redundant Initialize call.");return}this.L();this.N();this.g=new _mcp.bp(_y.c.a,this.p);_mcp.I.prototype.h.call(this)},b:function(n){this.c=n;this.c.b(this.n);this.c.a(this.m);this.c.c(this.l);this.c.g(this.k)},bw:function(){var t;_a.h.a(t={val:this.g}),this.g=t.val;var n;_a.h.a(n={val:this.i}),this.i=n.val;this.Y();_mcp.I.prototype.bw.call(this)},Y:function(){if(this.c){this.c.e(this.n);this.c.d(this.m);this.c.f(this.l);this.c.j(this.k);this.c=null}},R:function(n){var t=n.c();this.F(t)},Q:function(n){var t=n.c();this.y(t)},P:function(n){var t=n.d();if(_zz.g.isInstanceOfType(t)){this.d=t;this.y(n.c())}else{_j.e.c(_a.a.a,"EditorOnContentLoaded: event source was not an instance of HtmlEditorBase");return}},O:function(n){n.c()===1&&this.B(n.e())},B:function(n){if(n)for(var u=n.querySelectorAll(String.format("div[id^='SAContainer']","SAContainer")),t=0;t<u.length;t++){var r=u[t];r.setAttribute("contenteditable",!1);var i=r.querySelector(String.format("a[id^='ATRemove']","ATRemove"));i&&_j.k.b(i,"click",this.o)}},y:function(n){for(var r=n.querySelectorAll(String.format("div[id^='SAContainer']","SAContainer")),t=0;t<r.length;t++){var i=r[t];i.setAttribute("contenteditable",!1);this.x(i)}},F:function(n){for(var r=n.querySelectorAll(String.format("div[id^='SAContainer']","SAContainer")),i=0;i<r.length;i++){var u=r[i];u.removeAttribute("contenteditable");var t=u.querySelector(String.format("a[id^='ATRemove']","ATRemove"));if(t){_j.k.c(t,"click");_j.k.c(t,"mouseleave");_j.k.c(t,"mouseleave");_j.k.e(t)}}},L:function(){if(!_mcp.h.b){var t=this.q.a().b().Enabled?"http://outlook.live.com":"http://outlook.office.com";var n=_mcp.h.a("a");n.style.textDecoration="none";n.style.color="inherit";n.href=t;n.innerText=_nbs.a.Fr;_mcp.h.b=n}},N:function(){if(_j.h.a(_mcp.h.c))for(var i=this.s.bB.TimeZone.split(" "),r=i.length,n=0;n<r;++n){var t=i[n];!_j.h.a(t)&&t.match(_mcp.h.e)&&(_mcp.h.c+=t.charAt(0))}},M:function(n){var f=this.f(1,null);var e=_mcp.h.a("tr");var r=_mcp.h.a("td");var o=this.f(5,null);r.appendChild(o);for(var i=0;i<n.length;){var u=n[i].a().d();this.G(r,u);i=this.H(r,n,u,i)}var t=this.f(0,null);e.appendChild(r);f.appendChild(e);t.appendChild(f);t.appendChild(this.K());t.setAttribute("contenteditable",!1);this.x(t);return t},G:function(n,t){var r=String.format("{0}, {1} {2}",_a.d.q(t.r()),_a.d.P(t.f()),t.F().j());var i=this.f(2,r);n.appendChild(i)},H:function(n,t,i,r){for(var u=r;u<t.length&&!t[u].a().k(i);){var h=t[u].a();var f;var o,e;u=(e=this.T(t,o={val:f},u,n),f=o.val,e);var s=String.format("{0} - {1} ({2})",h.a(0),f.a(0),_mcp.h.c);this.I(s,n)}return u},T:function(n,t,i,r){var u=i;var e;do{var f=n[u];e=f.a();t.val=f.b();this.A(r,e,t.val);u++}while(u<n.length&&_a.d.g(t.val,n[u].a())&&t.val.L(n[u].a())>=0);return u},A:function(n,t,i){var r=_mcp.h.a("div");r.style.display="none";r.setAttribute("itemprop","actionOption");r.setAttribute("itemscope","");r.setAttribute("itemtype","http://schema.org/Event");var f=_mcp.h.a("div");r.style.display="none";f.setAttribute("itemprop","startDate");f.setAttribute("content",_a.d.d(t.q()));r.appendChild(f);var u=_mcp.h.a("div");r.style.display="none";u.setAttribute("itemprop","endDate");u.setAttribute("content",_a.d.d(i.q()));r.appendChild(u);n.appendChild(r)},I:function(n,t){var i=this.f(3,n);t.appendChild(i)},K:function(){var n=this.f(4,null);n.appendChild(_mcp.h.b);return n},f:function(n,t){var r=null;var i=null;switch(n){case 0:r="SAContainer";i="div";break;case 1:i="table";break;case 2:i="div";break;case 3:i="div";break;case 4:i="div";break;case 5:r="ATRemoveContainer";i="div";break;default:throw Error.notImplemented("Type not implemented for "+n);}var u=_mcp.h.a(i);r&&(u.id=r);this.W(u,n,t);return u},W:function(n,t,i){switch(t){case 0:n.style.margin="5px 0px";n.setAttribute("itemscope","");n.setAttribute("itemtype","http://schema.org/EmailMessage");break;case 1:n.style.borderTopWidth="1px";n.style.borderTopStyle="dotted";n.style.borderTopColor="#c8c8c8";n.style.borderBottom=n.style.borderTop;n.style.paddingBottom="20px";n.style.width="100%";n.setAttribute("itemscope","");n.setAttribute("itemprop","potentialAction/availableTimes");n.setAttribute("itemtype","http://schema.org/ChooseAction");break;case 2:n.style.marginTop="15px";n.style.padding="0px 10px";n.style.textAlign="center";n.style.whiteSpace="nowrap";n.innerText=i;break;case 3:_j.k.d(n,"ms-font-color-themePrimary");_j.k.d(n,"ms-bg-color-themeLighterAlt");n.style.backgroundColor="#EFF6FC";n.style.fontWeight="600";n.style.color="#0078D7";_j.k.a(n,"max-width","300px");n.style.padding="8px 0px";n.style.marginTop="10px";n.style.marginRight="auto";n.style.marginLeft=n.style.marginRight;_j.k.a(n,"text-align","center");n.innerText=i;break;case 4:n.style.color="#0078D7";n.style.marginTop="10px";n.style.marginLeft="auto";n.style.marginRight="auto";n.style.textAlign="center";break;case 5:n.style.styleFloat="right";break;default:throw Error.notImplemented("Type not implemented for "+t);}},x:function(n){var t=this.z(n);if(t){t.id="ATRemove";t.style.marginRight="10px";t.style.marginTop="10px";t.className=_mcp.e.r().a();_j.k.b(t,"click",this.o)}},V:function(n){var i=n.b();var t=this.S(i);_a.c.c(this.bm(),"AvailableTimeRemovedFromEditor");_j.k.c(i,"click");if(t){t.innerHTML="";t.id="";this.d.bf(!0);this.d.eD(n)}},S:function(n){for(var t=null,i=n,r=0;r<10;r++){if(!i)break;if(i.id==="SAContainer"){t=i;break}i=i.parentNode}t&&t.parentNode&&t.parentNode.tagName==="P"&&t.parentNode.getAttribute("contentEditable")&&t.parentNode.getAttribute("contentEditable").toUpperCase()==="FALSE"&&(t=t.parentNode);return t},z:function(n){var t=null;var r=n.querySelectorAll("div[id^='ATRemoveContainer']");if(r.length>0){t=_mcp.h.a("a");t.style.fontFamily="'wf_segoe-ui_normal', 'Segoe UI', 'Segoe WP', Tahoma, Arial, sans-serif";t.style.fontWeight="normal";t.style.position="relative";t.style.styleFloat="right";t.style.cursor="pointer";t.style.padding="8px";t.style.cssText+="float: right";t.style.cssText+=this.j;_j.k.b(t,"mouseenter",this.t);_j.k.b(t,"mouseleave",this.u);_j.k.a(t,"-moz-user-select","none");_j.k.a(t,"-khtml-user-select","none");_j.k.a(t,"-webkit-user-select","none");_j.k.a(t,"-ms-user-select","none");var i=r[0];i.appendChild(t);i.parentNode.style.position="relative"}return t},C:function(n){if(n.b()){var t=n.b();t.style.cssText+=this.r}},E:function(n){if(n.b()){var t=n.b();t.style.cssText+=this.j}},X:function(){if(this.g){_a.c.c(this.bm(),"AvailableTimeButtonClicked");this.g.p(this.v)}},U:function(n){var i=new _cmc.g(this.bm(),"AvailableTimeInsertedToEditor",!1);var t=null;if(n&&n.length>0){i.a("N",n.length,!0,!0);var e=(n[0].b().e(n[0].a())/6e4).toString();i.a("D",e,!0,!0);if(this.d){var r=this.M(n);var f=new _cmc.bd(r,this.d.z,null);if(this.d.ff(f,13,!0)){var u=_mcp.h.a("BR");_j.k.B(u,r)}else t="ErrorOnInsertingInEditor"}else t="NullEditor"}else t="NoTimesSelected";t?i.d(t,null):i.b()}};_mcp.s=function(n,t,i,r,u){this.bO=Function.createDelegate(this,this.L);this.bs=Function.createDelegate(this,this.ct);this.bt=Function.createDelegate(this,this.cu);this.bA=Function.createDelegate(this,this.cB);this.bH=Function.createDelegate(this,this.cL);this.ba=Function.createDelegate(this,this.cA);this.C=Function.createDelegate(this,this.cz);this.O=Function.createDelegate(this,this.cy);this.bo=Function.createDelegate(this,this.F);this.bp=Function.createDelegate(this,this.bf);this.br=Function.createDelegate(this,this.bg);this.bI=Function.createDelegate(this,this.cN);this.bJ=Function.createDelegate(this,this.cO);this.bx=Function.createDelegate(this,this.cd);this.B=Function.createDelegate(this,this.cn);this.bu=Function.createDelegate(this,this.bh);this.bF=Function.createDelegate(this,this.cF);this.bE=Function.createDelegate(this,this.cE);this.bD=Function.createDelegate(this,this.cD);this.bB=Function.createDelegate(this,this.cC);this.bG=Function.createDelegate(this,this.cI);_mcp.s.initializeBase(this,[7,n]);this.bb=this.p=new _j.g(this.bG,this.bm());this.H=new _j.g(this.bB,this.bm());this.I=new _j.g(this.bD,this.bm());this.K=new _j.g(this.bE,this.bm());this.z=new _j.g(this.bF,this.bm());this.bc=n.a.bV;this.bd=t;this.Q=i;this.t=u};_mcp.s.prototype={bc:null,bd:null,Q:null,t:null,T:null,S:null,A:!1,G:null,s:null,u:null,y:null,V:!1,bi:!1,x:0,r:null,p:null,z:null,I:null,H:null,K:null,w:0,i:function(){return this.r?this.r.c():null},a:function(){return this.p},c:function(n){this.p=n;return n},bb:null,d:function(){return this.bb},o:function(){return this.I},f:function(){return this.H},E:!1,n:function(){return this.E},b:function(){return this.A},v:function(n){if(n!==this.A){this.A=n;this.bv("IsSending");var t=this.bl.a;t.ex(this.A);t.eN(_u.P.P);t.ey(this.A)}return n},j:function(){return this.R()&&this.bi},m:function(){return this.x},ce:function(n){this.x=n>=0?n:0;return n},R:function(){var n=this.bk.a()===2&&this.bk.eS;return(_g.a.a().bB.AsyncSendEnabled&&!this.bk.eS||n)&&this.bj.bv.a()==="Mouse"&&!this.bj.bq()&&!this.bk.K()&&!!this.bj.bY&&!!this.bj.ci&&this.bk.l()!==3&&this.bk.a()!==15},be:function(){return!1},cq:function(){return!!this.Q&&this.Q.a().b().Enabled},k:function(){return this.u},Y:function(){if(this.bj.cH()&&!this.r){_j.e.a(_a.a.a,"Setting send component override");this.r=this.bj.cG().e();var n=this.bj.bb();var s=this.bj.bc();var f=n,e=n,o=n,i=n,t=n,u=s,r=s;this.r.d(this.bj.r(),this.bu,this.B,this.bx,this.bJ,this.bI,this.br,this.bp,this.bj.bo,this.bl.a.bR,f.t||(f.t=Function.createDelegate(f,f.r)),this.dF,this.bo,e.k||(e.k=Function.createDelegate(e,e.s)),o.j||(o.j=Function.createDelegate(o,o.E)),i.i||(i.i=Function.createDelegate(i,i.C)),t.l||(t.l=Function.createDelegate(t,t.f)),u.c||(u.c=Function.createDelegate(u,u.k)),r.d||(r.d=Function.createDelegate(r,r.m)),_cmc.h.b,this.cG);this.bv("InvalidRecipientsDialogViewModel")}},X:function(){if(this.r){this.r.a();this.r=null;this.bv("InvalidRecipientsDialogViewModel")}},h:function(){this.Y();var n=this.bj.bb();if(n){n.I(this.O);n.H(this.B);n.T(this.O);n.R(this.B)}_mcp.I.prototype.h.call(this)},g:function(){_j.e.a(_a.a.a,"ResumeSend() called by external mail-compose component.");this.bh()},bh:function(){var i=this.bj;var n=this.bk;var t=i.bj();i.dd().d();i.el().a();if(t.c()){t.l(!0);_j.e.a(_a.a.a,"Send deferred due to in progress save.")}if(n.m()||n.h()||n.L()||n.a()===15){if(!t.g()){this.bj.bb().f();_j.e.a(_a.a.a,"Send without pending saves, OriParentFolderId={0}",n.g()&&n.g().bB.ParentFolderId&&_g.b.a?_g.b.a.idToName(n.g().bB.ParentFolderId):"null");this.U()}}else{var r=n.d();_j.e.a(_a.a.a,"Send was attempted during upgrade for context {0}, keeping the IsSending state and waiting for upgrade to finish. Upgrade component will resume send.",r)}},U:function(){var t=this.bj;var r=this.bk;if(r.a()===15)this.cP();else{var n=t.bT.h(t,1);_j.e.a(_a.a.a,"Submitting send action");var i=_g.k.a;_bc.k.isInstanceOfType(i)?_mco.c.isInstanceOfType(n)?n.cd(this.C):_mco.a.isInstanceOfType(n)&&n.bF(this.C):this.bZ();t.bo.a(n,this.bg(),this.bf(),this.ba);_j.e.a(_a.a.a,"Send action submitted")}},cP:function(){var n=new _gg.jD;var i=_g.c.a(this.bk.g().bV().f(),_g.c.Z());n.Provider=i?i.bB.Value:"";n.ConversationId=this.bk.bi().Id;n.InReplyToItemId=this.bk.A().Id;n.Body=this.bk.dc().bB.Value;var t=this.bk.g();n.BotAddress=new _g.f;n.BotAddress.Name=t&&t.bB.From&&t.bB.From.Mailbox?t.bB.From.Mailbox.Name:"";var r=new _mco.B(n);this.bj.bo.a(r,this.bg(),this.bf(),this.ba);_j.e.a(_a.a.a,"ReplyToBotMessage action submitted")},bw:function(){this.bj.bb().I(this.O);this.bj.bb().H(this.B);var r;_a.h.a(r={val:this.p}),this.p=r.val;var u;_a.h.a(u={val:this.z}),this.z=u.val;var i;_a.h.a(i={val:this.H}),this.H=i.val;var n;_a.h.a(n={val:this.I}),this.I=n.val;var t;_a.h.a(t={val:this.K}),this.K=t.val;this.v(!1);this.X();this.T=null;this.S=null;_mcp.I.prototype.bw.call(this)},cn:function(){var i=this.bl.a.ba;var t=this.bj.bb();var n=null;this.v(!1);if(t.p()){this.P();n="InvalidRecipients";this.t.a(_a.Y,new _a.Y(_u.R.Uu,!1,0,2))}if(t.q()){this.P();n="InvalidSendAddress"}this.bj.be();this.l();n=n||"CancelSend_UnknownError";this.q(n,null,null)},l:function(){var n=this;_j.m.a().a(_a.a.a,"ExitResolvingRecipientsMode",function(){n.E=!1},2e3)},cx:function(n){var t;var i=_a.b.l(n.I);if(i==="ErrorSendAsDenied")t=80;else{var u,r;i==="ErrorRightsManagementPermanentException"&&(r=this.cQ(n.I,u={val:t}),t=u.val,r)||(t=i==="ErrorSubmissionQuotaExceeded"?47:i==="ErrorAccountSuspend"?90:i==="ErrorExceededMaxRecipientLimit"?91:i==="ErrorExceededMessageLimit"?92:i==="ErrorExceededHourlyMessageLimit"?101:i==="ErrorMessageBlocked"?93:i==="ErrorMessageSubmissionBlocked"?94:i==="ErrorAccountSuspendShowTierUpgrade"?98:i==="ErrorExceededMaxRecipientLimitShowTierUpgrade"?99:i==="ErrorExceededMessageLimitShowTierUpgrade"?100:_db.h.c(n.I,45,55,62,700,88,89,46,58))}return t},cf:function(){this.s=_y.j.b(_a.a.a,"MailComposeSend",!0)},bg:function(){return this.T||this.bH},bf:function(){return this.S||this.bA},cO:function(n){this.T=n},cN:function(n){this.S=n},cQ:function(n,t){var u=n.MessageXml;if(u)for(var f=Sys.Net.XMLDOM(u),r=0;r<f.firstChild.childNodes.length;r++){var i=f.firstChild.childNodes[r];if(i.nodeType===1&&_a.Z.b(i)==="Value"&&_a.Z.c(i,"Name")==="HResult"&&-2147168383===Number.parseInvariant(_a.Z.a(i))){t.val=48;return!0}}t.val=-1;return!1},cC:function(){if(this.p.b){this.w=2;this.p.a()}},cD:function(){if(this.p.b){this.w=1;this.p.a()}},cE:function(){if(this.p.b){this.w=3;this.p.a()}},cI:function(){if(this.r&&!this.r.e()){_j.e.a(_a.a.a,"saveComponentOverride.IsReadyForSmimeOperation() == false. Exiting SendStart().");return}_a.H.a(_a.a.a,"MailComposeSend",5);this.V=!0;this.be()||this.cf();if(this.w){this.bj.bi().a(_mcp.bf.toString(this.w));this.w=0}(_mcp.D.isInstanceOfType(this.bj)||IGroupInlineComposeViewModel.isInstanceOfType(this.bj))&&this.bk.hq(!0);if(this.R()){this.u=_y.j.b(_a.a.a,"MailComposeSendAsync",!0);if(IGroupInlineComposeViewModel.isInstanceOfType(this.bj)){var n=this.bj;_g.i.isInstanceOfType(this.bk.g())&&n.b()&&(this.y=_y.j.b(_a.a.a,"MailComposeSendAsyncQuickQuickness",!0))}}_j.e.a(_a.a.a,"SendStart");this.cj();this.bk.t()?this.r.f():this.bk.a()===15?this.L():this.cd();this.bj.bi().a("Send")},cd:function(){_j.e.a(_a.a.a,"User chose to send, start force resolve recipients");this.E=!0;this.bj.bb().bg(!0)},cy:function(){if(this.A){_j.e.a(_a.a.a,"Skip send since another send is in progress");return}this.v(!0);this.E=!1;_j.m.a().j(_a.a.a,"MailComposeSend");_j.e.a(_a.a.a,"Started new task runner context before starting send.");this.bR(!0)},L:function(){_mco.z.a(this.bj.ba,"compose");this.bk.gs(!1);if(this.bj.Z.bq()){this.bk.cG(new _cmc.J);this.bk.hs(_cmc.J.a(this.bk.di()))}if(this.r)this.r.b();else{this.bh();if(this.R()&&!this.bk.dn()){var n=this.bQ();if(!n){_j.e.a(_a.a.a,"Navigating away after submitting action for send via notification");this.bk.gs(!0);this.bi=!0;this.ca();this.bZ();this.cc()}}}},cc:function(){this.bX()},bX:function(){var n=this;this.bj.bY.a(function(){n.t.a(ISendEvent,new _mcp.bq(n.bj))})},bQ:function(){var n=!1;if(this.bj.ci.c()){var i=this;this.bj.ci.a(function(t){t.a()>0&&(n=!0)})}if(!n&&this.bj.bY.c()){var t=this;this.bj.bY.a(function(t){t.a()>0&&(n=!0)})}return n},bZ:function(){if(IGroupInlineComposeViewModel.isInstanceOfType(this.bj)&&_g.i.isInstanceOfType(this.bk.g())&&this.bk.cs()){var n=this.bj;if(n.b()&&n.g()){var u=this.bk.g();var r=_cmc.j.c(n.b().bB,n.g(),this.bk.n()||this.bk.bt(),this.bk.bt(),"sentitems");var f="MC:"+r.InternetMessageId;this.t.a(_a.bV,new _a.bV(f,this.bk));_h.c.B(r,u.bB.InternetMessageId,n.p()?u:null);var i="OMC:"+n.b().bB.ConversationId.Id;var t=n.A().c[i];if(t)t.d.c(n.g().bB.InternetMessageId);else{t=new _cmc.bC(n.g().bB.InternetMessageId);this.t.a(_a.bV,new _a.bV(i,t))}if(this.y){_y.j.a(this.y);this.y=null}}}},bR:function(n){var s=!0;try{var t=!1;var o,e;var r=n?(e=this.bj.bm().I(this.bd,this.bt,o={val:t}),t=o.val,e):!0;var h=t;var u,f;var i=r?(f=this.cw(u={val:t}),t=u.val,f):!1;_j.e.a(_a.a.a,"CheckValidationAndStartSendingMessage runOnSendEvents={0}, extensionsAllowSending={1}, waitingForAppsToComplete={2}, isPendingValidationDecision={3}, isValidToSend={4}",n,r,h,t,i);r&&i?t?_j.e.a(_a.a.a,"waiting for a pending validation decision, once decided, send will resume"):this.L():h||i||this.v(!1);s=!1}finally{if(s){this.v(!1);_j.e.b(_a.a.a,"Send failed due to an unhandled exception thrown before the action was submitted");this.F("SendFailure_UnhandledException",null,null)}}},cw:function(n){n.val=!1;var h=this.bl;var i=h.a;var t=i.bb();var o=i.bc();var s=i.ba;var c=h.b(23);if(this.bc.a(i.Z.d())){_j.e.a(_a.a.a,"User had already discarded, skipping send.");this.q("UserAlreadyDiscarded",null,"User has already discarded, skipping send");return!1}else if(t.q()){_j.e.a(_a.a.a,"Not valid to send since sender's address is invalid");s.a(66,null);this.bj.be();this.q("InvalidSendAddress",null,"Sender's address is invalid, not valid to send");return!1}else if(!i.Z.R()&&t.Y()){_j.e.a(_a.a.a,"Not valid to send since no recipients were specified");s.a(70,null);this.bj.be();this.q("NoRecipients",null,"No recipients were specified, not valid to send");return!1}else if(t.p()){_j.e.a(_a.a.a,"Not valid to send since invalid recipients are present, IsFromRecipientInvalid={0}, HasInvalidRecipients={1}",t.q(),t.p());t.bd();this.P();this.bj.be();this.q("InvalidRecipients",null,"Invalid recipients are present, not valid to send");return!1}else if(o.b()){_j.e.a(_a.a.a,"Not valid to send since attachment is in progress");var f=i.bh;f.p||f.g(0,_u.R.Dp,null,!1,null,null,null,f.z);this.q("AttachmentInProgress",null,"Attachment is in progress, not valid to send");return!1}else if(_g.a.a().bB.MaxRecipientsPerMessage<t.F()){s.a(800,null);this.bj.be();this.q("MaxRecipients",null,"Max recipients exceeded, not valid to send");return!1}else if(_a.br.a&&c.c()){_j.e.a(_a.a.a,"Not valid to send since policy violation detected");var l=i.bh;l.g(0,c.b(),null,!1,null,null,null,l.z);this.q("PolicyTipViolation",null,"PolicyTip violation detected, not valid to send");return!1}else if(_j.h.a(this.bj.Z.u())&&!this.bk.eS){_j.e.a(_a.a.a,"Not valid to send since the subject is empty.");n.val=!0;var u=i.bh;u.p||u.h(2,[_nbs.a.TO],this.bs,!1,_nbs.a.UT,_nbs.a.JA,_nbs.a.LM,u.z,null);return!1}else if(this.bj.bm().b()){_j.e.a(_a.a.a,"Not valid to send while addins are still running.");this.bj.bm().L(this.bj.bh,this.bO);n.val=!0;return!1}else if(o&&o.a()&&this.bj.da)if(this.G)return this.bP();else{n.val=!0;var r=this;this.bj.da.a(function(n){r.G=n.a(r.bj.bh,r.p);r.bP()?r.L():r.v(!1)})}else if(this.bk.K())if(this.bk.z()){_a.F.a(_u.R.HB,0);this.q("SmimeSendAs",null,"User attempted to send an S/MIME message using the SendAs (From) feature");return!1}else if(t.X()){_a.F.a(_u.n.NK,0);this.q("SmimeModernGroups",null,"User attempted to send an S/MIME message to modern groups.");return!1}else if(this.bk.q()){var e=new _j.q;var a=this;this.bk.q().o(function(n){_dg.d.isInstanceOfType(n)||_dg.i.isInstanceOfType(n)||_g.D.isInstanceOfType(n)||e.c(n.bB.Name)});if(e.d.length>0){_a.F.a(String.format(_u.n.Qh,e.d.join(", ")),0);this.q("SmimeCloudAttachment",null,"User attempted to send an S/MIME message with cloud attachments.");return!1}}return!0},bP:function(){var n=this.bj.bc();try{if(this.G.a(this.bj.Z,n.a().a())){this.q("ForgottenAttachment",null,"Forgotten attachment detected, not valid to send");return!1}}catch(t){_j.e.d(_a.a.a,t,"An exception has been caught for FAD check; keep sending",this.G,this.bj.Z,n.a().a())}return!0},cL:function(n){var u=this.bj;var t=this.bk;var i=n.Y;_j.e.a(_a.a.a,"Send action succeeded, ContextId={0}",i);this.cM();var r=!1;var o=_g.k.a;_bc.k.isInstanceOfType(o)&&(r=!0);t.bJ()&&!r&&this.bj.ce()&&this.bj.ce().b(t.n());this.bj.bH()&&this.bj.bH().f(t.eT);if(t.eX&&t.eX.length>0){var s=this.bl.a.ba;s.a(742,t.eX);_j.e.a(_a.a.a,"Showing infobar message for Bcc forking failed");this.v(!1);u.bo.d(n);this.F(_j.t.c(_bc.C,742),null,null)}else{if(i===t.d()||t.a()===15){t.fo(null);if(this.bk.cs()){_j.e.a(_a.a.a,"skip navigating away from compose for send via notification since the navigation was already done at send time, raise send succeeded event instead");var f=this;this.bj.bY.a(function(){f.t.a(ISendSucceededEvent,new _mcp.cb(u))});this.bk.gl()}else{_j.e.a(_a.a.a,"Context match, navigating away from compose at the end of send success. ContextId={0}",i);this.ca()}}else _j.e.a(_a.a.a,"Context does not match, skipping navigating away from compose.");this.cg("MailSendSucceeded");var e=this.bY();this.cp(e)}this.t.a(_a.Y,new _a.Y(_nbs.a.Ck,!1,0,2))},ca:function(){this.bj.bl().a(this.bj,!0)},cB:function(n){var u=this.bl.a;var t=u.Z;var o=n.Y;_j.e.a(_a.a.a,"Send action failed, ContextId={0}",o);var i;var r;var s,f;this.dg(n.I,s={val:i},f={val:r},"SendFailure_UnknownError"),i=s.val,r=f.val;if(o===t.d()){t.eX&&t.eX.length>0&&this.P();this.v(!1);_j.e.a(_a.a.a,"Context match. Showing infobar message for ResponseCode={0}",i);this.cH(n);var e=this.cx(n);if(this.bk.cs()){_j.e.a(_a.a.a,"Raise send failed event for send via notification");t.hp(e);var h=this;this.bj.ci.a(function(){h.t.a(ISendFailedEvent,new _mcp.ca(u))});t.gl()}this.cv(n,e)}else if(t.a()===15){this.cm();_j.e.b(_a.a.a,"Could not send ReplyToBotMessage request, error={0}",r)}else _j.e.a(_a.a.a,"Context does not match. Skip showing infobar message for ResponseCode={0}",i);this.F(i,this.cr(n),r);u.bo.d(n);this.bV("SendFailed")},cv:function(n,t){switch(t){case 92:case 100:_j.e.b(_a.a.a,"Got Wascl verdict {0}, save a draft to prevent data loss.",t);this.bj.bj().a("AutoSave",null,null,!1);break;case 90:case 98:_mco.a.isInstanceOfType(n)?_mcp.d.b=n.N.Body.AccountRecoveryFlowUrl:_mco.c.isInstanceOfType(n)&&(_mcp.d.b=n.N.Body.AccountRecoveryFlowUrl);_j.e.b(_a.a.a,"Got Wascl verdict {0}, set account recovery flow url to {1}.",t,_mcp.d.b);break;case 91:case 99:case 93:case 94:_j.e.b(_a.a.a,"Got Wascl verdict {0}.",t);break}},P:function(){var n=this.bl.a.ba;var t=this.bl.a.bb();if(this.cq()){n.b(97);n.a(97,t.Z())}else n.a(65,null)},cm:function(){var n=this.bl.a.ba;if(n){n.a(45,null);this.bj.be()}},cA:function(n){this.bW();this.co();this.bV("Send")},cr:function(n){var t=null;_db.e.isInstanceOfType(n)&&n.Q?t=n.Q.correlationId:_mco.c.isInstanceOfType(n)&&n.Q&&(t=n.Q.correlationId);return t},cF:function(){if(this.bl.a.db()&&this.p.b){this.w=0;this.p.a()}},cM:function(){var t=this.bj.bb();var n=this.bj.bc();_j.e.a(_a.a.a,"Check to see if we have attachments to set permissions for");n&&n.a()&&n.a().x()&&n.a().bw(t.B())},bY:function(){var t;if(this.bk){var u=this.bk.j()==="HTML"?"html":"text";var i;i=this.bk.a()===1||this.bk.a()===2||this.bk.a()===3?this.bk.m()?"yes":"no":"na";var n=new _a.l;n.b("BT",u);n.b("U",i);this.bk.fg!==-1&&n.a("S",this.bk.fg);n.a("O",this.bk.a());n.a("M",this.bk.l());n.a("D",this.x);n.c("GR",this.bk.fn);_j.h.a(this.bk.fm)||n.b("P",this.bk.fm);this.bj&&this.bk.eS&&n.b("CS",this.bj.bD());t=n.toString();if(this.bj&&this.bj.bc()&&this.bj.bc().a()){var r=this.bj.bc().a().bT();_j.h.a(r)||(t+="|"+r)}}else t=null;return t},F:function(n,t,i){var r=this.bY();n==="ErrorSendAsDenied"&&(r+="|"+this.cs());if(this.s){_j.h.a(i)||(this.s.m=i);_y.j.a(this.s,null,n,t,r);this.s=null}if(this.u){_j.h.a(i)||(this.u.m=i);_y.j.a(this.u,null,n,t,r);this.u=null}this.bT(n,t,r);this.bW()},cp:function(n){if(this.s){_y.j.a(this.s,null,null,null,n);this.s=null}this.bT(null,null,n)},bW:function(){if(this.V){_a.H.b("MailComposeSend");this.V=!1}},q:function(n,t,i){if(this.s){this.s.r="MailComposeInvalidToSend";this.s.n(new _a.D(this.bj.bD()))}if(this.u){this.u.r="MailComposeInvalidToSend";this.u.n(new _a.D(this.bj.bD()))}this.F(n,t,i)},co:function(){this.bj.bb()&&this.bj.bb().u("Send")},bV:function(n){this.bj.bH()&&this.bj.bH().a(n)},bT:function(n,t,i){if(this.y){if(this.bk.cs()){_j.e.c(this.bm(),"Quick quickness should have been enabled during async send.");i+="|ErrorNoQuickQuicknessForAsyncSend"}else i+="|NoQuickQuicknessForSyncSend";_y.j.a(this.y,null,n,t,i);this.y=null}},ct:function(n,t){n?this.L():this.q("NoSubject",null,'No subject was specified, and user chose "Don\'t Send"')},cz:function(n){_mco.a.isInstanceOfType(n)&&n.bx(this.C);_mco.c.isInstanceOfType(n)&&n.bY(this.C);if(this.bl&&this.bl.a){var t=this.bl.a.Z;t&&t.bJ()&&this.bj.ce().b(t.n())}},cs:function(){var n=new _a.l;if(this.bk){n.c("IFS",this.bk.z());this.bk.z()&&this.bk.n()&&n.b("F",this.bk.n().Mailbox.EmailAddress)}return n.toString()},cu:function(n){if(n)this.bR(!1);else{this.v(!1);this.q("CancelledByOnSendEvent",null,"Cancelled by on send event, don't send")}}};_mcp.bQ=function(n,t){_mcp.bQ.initializeBase(this,[21,n]);this.a=t};_mcp.bQ.prototype={a:null,h:function(){if(!this.e()&&this.a.a().a().e()===2&&this.a.m().a().a()){var n=this.bl.b(5);n&&n.a()&&n.a().bD()}_mcp.I.prototype.h.call(this)}};_mcp.o=function(n,t,i,r,u){this.p=Function.createDelegate(this,this.B);this.s=Function.createDelegate(this,this.C);this.w=Function.createDelegate(this,this.z);_mcp.o.initializeBase(this,[11,n,i,r]);this.d=new _j.g(this.w,this.bm());this.u=t;this.o=_a.o.a();this.j=_a.bm.a();this.c=u};_mcp.o.a=function(n,t){return t?n.bB.SignatureHtml:n.bB.SignatureText};_mcp.o.prototype={u:null,c:null,d:null,k:null,f:null,v:!0,r:!0,o:null,j:null,i:null,n:null,m:null,g:!1,b:function(){return this.q()?this.f:this.k},a:function(){return this.bk.gj()&&!this.bk.dn()&&this.A()&&!this.x()?!0:!1},x:function(){return this.q()?this.v:this.r},q:function(){return this.bk.j()==="HTML"&&this.u.b()},h:function(){var n=_g.a.a().a();n.apcl("SignatureText",this.s);if(!this.e()){this.t();!this.c||this.f||this.k||this.c.apcl("CurrentStatus",this.p);_mcp.q.prototype.h.call(this)}},t:function(){var u=_g.a.a().a();var i=this.y(u,!0);if(_j.h.a(i)){_j.e.a(_a.a.a,"No html signature.");this.f=null}else{var e=String.format('<{0} id="{1}">',"DIV","Signature");var f=String.format("</{0}>","DIV");var n=_mcp.o.f+e+i.replace(_mcp.o.e," ")+f;_j.e.a(_a.a.a,"Computed html signature. OriSig={0}, FormattedSig={1}",i,n);n=this.F(n);n=this.E(n);this.f=n}var t=this.y(u,!1);if(_j.h.a(t)){_j.e.a(_a.a.a,"No plain text signature.");this.k=null}else{var r="\n"+t;_j.e.a(_a.a.a,"Computed plain text signature. OriSig={0}, FormattedSig={1}",t,r);this.k=r}this.G()},bw:function(){var n;_a.h.a(n={val:this.d}),this.d=n.val;var t=_g.a.a().a();t.rpcl("SignatureText",this.s);this.c&&this.c.rpcl("CurrentStatus",this.p);_mcp.q.prototype.bw.call(this)},bO:function(){if(!this.bj.bk()){this.i=new _fm.d(_nbs.a.CA,null,this.d);this.i.y(_nbs.a.CA);this.i.a(!this.l());return[this.i]}return null},bQ:function(){this.n=_mcp.q.a(this.d,_nbs.a.CA);this.n.b(this.l());return[this.n]},bF:function(){if(!_a.g.b){this.m=new _y.h(_nbs.a.CA,this.d);this.g=!1;if(this.l()){this.g=!0;return[this.m]}}return null},ca:function(){this.i&&this.i.a(!this.l())},ce:function(){this.n&&this.n.b(this.l())},cy:function(){var n=this.bj.ev;if(n&&this.m)if(this.g&&!this.l()){n.t(this.m);this.g=!1}else if(!this.g&&this.l()){n.w(this.m);this.g=!0}},A:function(){var t=_g.a.a().a();if("Mouse"===_y.c.a.a()){var n=this.bk.a();var i=1===n||2===n||3===n||12===n;return i?t.bB.AutoAddSignatureOnReply:t.bB.AutoAddSignature}return this.o.c()?this.j.b("MOWA.IsSignatureChanged")==="true"?this.j.b("MOWA.AutoAddSignature")==="true":!0:t.bB.AutoAddSignatureOnMobile},y:function(n,t){if("Mouse"===_y.c.a.a())return _mcp.o.a(n,t);if(this.o.c()){if(this.j.b("MOWA.IsSignatureChanged")==="true")if(this.j.b("MOWA.UseDesktopSignature")==="true")return _mcp.o.a(n,t);else{var r=this.j.b("MOWA.SignatureText")||"";return t?_a.A.b(r):r}return t?_a.A.b(_mcp.S.a(this.o)):_mcp.S.a(this.o)}if(n.bB.UseDesktopSignature)return _mcp.o.a(n,t);else{var i=n.bB.SignatureTextOnMobile||"";return t?_a.A.b(i):i}},l:function(){var n="Mouse"===_y.c.a.a()||_g.a.a().a().bB.UseDesktopSignature;return n?!this.x():!_j.h.b(_g.a.a().a().bB.SignatureTextOnMobile)},z:function(){var i=this.bl.a.Z;var r=_g.a.a().a();i.cK(!0);var t=!_j.h.a(this.b());if(t){var n=new _cmc.o(0,this.b(),this.q(),7);n.r=!0;n.o=!1;this.bj.bN().a(n)}else _j.e.a(_a.a.a,"Skip insert signature due to HasSignature={0};",t)},B:function(n,t){this.c.rpcl("CurrentStatus",this.p);if(this.c.a===2){this.t();this.bt();if(this.bk.eW&&this.a()){var i=new _cmc.o(2,this.b(),this.q(),7);i.r=!0;this.bk.cG(i)}}},F:function(n){return n.replace(_mcp.o.c,'<img class="'+_mcp.o.d+'" '+"$2"+"$3")},E:function(n){var e=n.match(_mcp.o.b);if(!e)return n;for(var u=document.createElement("div"),o=e,s=o.length,i=0;i<s;++i){var f=o[i];u.innerHTML=f+"</a>";var r=u.querySelectorAll("a");r&&r.length===1&&(r[0].id="LPNoLP");var t=u.innerHTML;t=t.substr(0,t.length-4);n=n.replace(f,t)}return n},C:function(n,t){this.t();this.bt()},G:function(){var n=new RegExp("^\n{1,5}$");this.r=!this.k||!this.k.search(n);this.v=!this.f||this.r&&this.f.indexOf("<img")===-1}};_mcp.bR=function(n,t){this.u=Function.createDelegate(this,this.s);this.t=Function.createDelegate(this,this.r);this.v=Function.createDelegate(this,this.F);this.w=Function.createDelegate(this,this.z);_mcp.bR.initializeBase(this,[10,n]);this.m=new _j.g(this.w,this.bm());this.q=t};_mcp.bR.prototype={q:null,m:null,l:null,o:!1,p:!1,a:function(){return this.m},g:function(){return this.l},G:function(n){if(n!==this.l){this.l=n;this.bv("CloseConfirmDialogButtonData")}return n},i:function(){return this.o},k:function(n){if(n!==this.o){this.o=n;this.bv("IsCloseConfirmDialogShown")}return n},f:function(){return this.p},H:function(n){if(n!==this.p){this.p=n;this.bv("IsAppBarSetup")}return n},b:function(){_j.e.a(_a.a.a,"Setup appbar menu. Context: {0}",this.bk);if(!this.cb){var n=new _j.q;this.n(n,11);this.n(n,1);this.n(n,28);this.n(n,6);this.n(n,3);this.n(n,9);this.bj.ev.g(n.d);this.H(!0)}},h:function(){_j.e.a(_a.a.a,"InitTouchComponent:Context:{0}",this.bk);this.bj.bv.a()==="TouchNarrow"?this.E():this.bj.ev||this.A();this.bl.b(21);_mcp.I.prototype.h.call(this)},j:function(n,t,i){if(this.bj.bL)return!1;else if(this.bj.bp().j()){this.o||this.z();return!0}else if(this.bj.Z.bm()&&!this.x()){_j.e.a(_a.a.a,"Removing unedited reply forward draft if user clicks outside the form.");this.r();return!0}else{this.bj.P(!0);return!1}},bw:function(){var t;_a.h.a(t={val:this.m}),this.m=t.val;if(this.l){this.l.g();this.l=null}var n;_a.h.a(n={val:this.l}),this.l=n.val;_mcp.I.prototype.bw.call(this)},B:function(){return _a.g.b?null:new _y.g(_y.b.bc(),_y.b.bd(),_u.P.l,this.bj.bm().j())},x:function(){return this.bj.bg().b()},A:function(){var e=new _y.g(_y.b.s(),_y.b.t(),_u.P.a,this.bj.bg().a());var o=_y.g.a(_nbs.a.TZ,this.m);var u=this.B();var r=this.C();var i=2;i+=u?1:0;i+=r?1:0;var n=new Array(i);var t=0;n[t++]=e;u&&(n[t++]=u);n[t++]=o;r&&(n[t++]=r);_j.e.a(_a.a.a,"Creating appbar. ContextId={0}",this.bk.d());var f=_y.l.a(this.bj,n,null);f.F("TouchNarrow"===_y.c.a.a());this.bj.fz(f)},E:function(){var t=this.q;if(t){var n=t.b();if(_a.o.a().a()){n.b(2);n.d(_nbs.a.ag);n.a(t.a(_fm.a.b,_fm.a.b,this.m,_u.R.NU));n.c(t.a(_fm.a.b,_fm.a.b,this.bj.bg().a(),_u.n.SM));n.h().a(!0)}else{n.b(1);n.d(_nbs.a.RF);n.a(t.a(_y.b.a(),_y.b.a(),this.m,""));n.i(t.a(_fm.a.h,_fm.a.h,null,""));n.f(this.bj.bC().a());var i=this.bj.bc().l();if(i&&i.d.length>0){if(i.d.length>1){n.c(t.a(_y.b.A(),_y.b.A(),null,""));n.m(new _fm.f(i.d))}else{var r=i.d[0].k;n.c(t.a(_y.b.A(),_y.b.A(),r,""))}n.g(t.a(_y.b.q(),_y.b.q(),this.bj.bg().a(),""))}else n.c(t.a(_y.b.q(),_y.b.q(),this.bj.bg().a(),""))}this.bj.fA(n)}},z:function(){_j.e.a(_a.a.a,"User hit close, decide whether to show the confirm dialog. Context:{0}",this.bk);if(this.x()){_j.e.a(_a.a.a,"Skipping close since send is in progress. This is considered a corner case since going to local store should be quick. If this occurs frequently, an UX solution is needed.");return}if(this.bj.bp().j()){this.I();_j.e.a(_a.a.a,"Toggle IsCloseConfirmDialogShown flag to show the dialog.");this.k(!0)}else if(this.bk.bm()){_j.e.a(_a.a.a,"Removing unedited reply forward draft on close.");this.r()}else{_j.e.a(_a.a.a,"Navigate away due to unmodified message.");this.y()}},s:function(){_j.e.a(_a.a.a,"Hide close confirm dialog");this.k(!1)},I:function(){if(!this.l){_j.e.a(_a.a.a,"Create close confirm dialog.");var n=new _j.l;_a.g.b||n.a(new _ff.d(new _j.g(this.v,this.bm()),_u.P.U,_nbs.a.sU,!0,!1));n.a(new _ff.d(new _j.g(this.t,this.bm()),_u.n.LT,_u.n.Lr,_a.g.b,!1));n.a(new _ff.d(new _j.g(this.u,this.bm()),_bcs.D.A,_u.n.Lh,!1,!1));this.G(n)}},F:function(){_j.e.a(_a.a.a,"User select save and close");this.s();this.bj.bj().j().a()},r:function(){_j.e.a(_a.a.a,"User select discard and close");this.s();this.bj.bp().k();this.y()},y:function(){this.bj.bl().a(this.bj,!1)},C:function(){if(this.bk.W())return null;var n=new _j.q;var o=this.bj.bc();var t=o.s();if(t&&t.length>0)for(var r=t,e=r.length,i=0;i<e;++i){var u=r[i];n.c(u)}if(n.d.length===1){var f=n.d[0];return new _y.g(_y.b.M(),_y.b.N(),_u.P.T,f.a())}else return new _y.g(_y.b.M(),_y.b.N(),_u.P.T,null,n.d)},n:function(n,t){var r=null;var i=this.bl.b(t);if(i&&IMailComposeContextMenuProvider.isInstanceOfType(i)){_j.e.a(_a.a.a,"Getting app-bar items for type '{0}', IsInitialized = {1}",Object.getType(i).getName(),i.e());i.e()||i.h();r=i;n.h(r.O())}}};_mcp.O=function(n,t,i){this.N=Function.createDelegate(this,this.Z);this.H=Function.createDelegate(this,this.y);this.x=Function.createDelegate(this,this.R);this.K=Function.createDelegate(this,this.U);this.M=Function.createDelegate(this,this.X);this.I=Function.createDelegate(this,this.T);this.t=Function.createDelegate(this,this.O);this.L=Function.createDelegate(this,this.C);_mcp.O.initializeBase(this,[12,n]);this.v=this.bl.a.bV;this.o=t;this.Q=i};_mcp.O.a=function(n){if(n&&!n.fd){n.ba.b(3440);n.ba.a(3440,null);n.be()}};_mcp.O.prototype={v:null,o:null,Q:null,B:null,n:null,p:null,F:null,E:null,G:null,r:null,m:null,a:function(){this.r||(this.r=new _j.g(this.L,_a.a.a));return this.r},g:function(){return this.j()&&!this.bk.bl()||this.bj.bE},d:function(){var n=this.bk;return this.j()&&n.bl()&&!this.m&&!n.L()},j:function(){return this.i()&&this.bj.bk()&&!this.bk.K()&&!this.bj.bE},i:function(){var n=this.bk.a();return n===1||n===2||n===3},c:function(){return this.g()||this.d()},q:null,f:function(){return this.q},l:function(n){this.q=n;return n},u:!1,k:function(){return this.u},h:function(){if(this.j()){var n=this.bj.Z;if(n.bl()&&n.L()){_j.e.a(_a.a.bl,"initializing upgrade component, user requested upgrade and upgrade failed, show the failure message");this.S();this.bj.be()}}_mcp.I.prototype.h.call(this)},b:function(){_a.H.a(_a.a.a,"MailComposeUpgrade",3);this.n=_y.j.b(_a.a.a,"MailComposeUpgrade",!0);this.q=_y.j.b(_a.a.a,"MailComposeQuoteBody",!0);var r=this.bl.a;var n=r.Z;var u=n.d();this.B=u;if(!n.m()||this.bj.bE){if(!this.j()){var e=this;_j.m.a().a(_a.a.a,"ShowUpgradeMessage",function(){n.m()||n.L()||u!==e.B||_mcp.O.a(r)},5e3)}var t;t=this.o.b()||n.j()!=="HTML"?n.j()==="Text"?_h.b.i():_h.b.b():_h.b.B();if(t===_h.b.b()||t===_h.b.B()){t.BlockExternalImages=n.g().bB.HasBlockedImages;t.FilterHtmlContent=n.g().bB.HasBlockedImages}var i=r.bT.a(n,t);n.a()===12&&i.q(new _g.E(new _g.r("internalsubmission")));i.k(this.t);_j.e.a(_a.a.bl,"Begin upgrade, OriParentFolderId={0}",n.g()&&n.g().bB.ParentFolderId&&_g.b.a?_g.b.a.idToName(n.g().bB.ParentFolderId):"null");i.o("MailComposeUpgrade");this.u=!0;if(n.bG()){var f=new _mcp.w(i);r.bo.a(f,this.I,this.M,null)}else this.bj.bE?r.bo.a(i,this.K,this.x,null):r.bo.a(i,this.H,this.x,null)}},bw:function(){var n;_a.h.a(n={val:this.r}),this.r=n.val;_mcp.I.prototype.bw.call(this)},T:function(n){var t=n;this.y(t.e)},X:function(n){var i=n;var t=i.e;t.t(this.t);this.R(t)},U:function(n){this.y(n);this.bl.a.bl().l()},y:function(n){if(this.bq()){_j.e.a(_a.a.a,"MailComposeUpgradeComponent.CheckSystemUpgrade: viewModel is null or disposing, aborting logic.");return}this.u=!1;var f=this.bj;var e=f.Z;var t=n;var h=f.bp();var r=t.F;var i=n.h();var s=t.Q?t.Q.correlationId:null;var c=!!t.bo;if(this.v.a(i)){_j.e.a(_a.a.bl,"Check upgrade callback, resume discard for context {0}",i);h.c(i,r)}else if(i===e.d()){e.H(r);_j.e.a(_a.a.bl,"Context match, updated the draft id. ResponseMessageBodyType={0}",c&&t.bo.O()?t.bo.O().a():"null");var u=f.bj();var o=f.bg();if(!u.c()&&o.b()){_j.e.a(_a.a.bl,"Skipping upgrade for contextId {0} since send was triggered during upgrade",i);this.s("SkipUpgrade",s,"Skip upgrade since send is in progress");o.g();return}if(u.c()&&u.g()){_j.e.a(_a.a.bl,"Skipping upgrade for contextId {0} since save and then send was triggered during upgrade",i);this.s("SkipUpgrade",s,"SkipUpgrade since saving is in progress");u.i();return}}if(t.bo){_j.e.a(_a.a.bl,"Check upgrade, action has response message, call complete upgrade. ActionItemId={0}",_h.bb.a(r));this.O(n)}else if(n.h()===e.d()){_j.e.a(_a.a.bl,"Check upgrade: action has id only, updated draft id. ActionItemId={0}",_h.bb.a(r));this.A(!0)}},V:function(n){n.dE()&&this.bl.a.ba.a(3050)},O:function(n){if(this.bq()){_j.e.a(_a.a.a,"MailComposeUpgradeComponent.CompleteSystemUpgrade: viewModel is null or disposing, aborting logic.");return}var r=this.bj;var t=r.Z;var i=n;var o=i.Q?i.Q.correlationId:null;var f=n.h();i.t(this.t);if(f===t.d()){t.dP(i.bo);t.fs=i.bo.cn();this.m=i.bo;t.hu(i.bo.bd());try{if(this.j())if(t.bl()){_j.e.a(_a.a.bl,"upgrade returned success, user already requested for upgrade, merge body and remove spinner");this.z();this.by("IsWaitingForQuotedBody","IsOnDemandUpgradePending");r.be()}else{t.cN(!0);this.A(!1)}else this.z();i.bo.be()&&t.U(i.bo.be().e);var e=r.bc();e.z()}finally{t.m()&&r.ba.b(3440);_j.e.a(_a.a.bl,"IsUpgraded for context is {0}",t.m())}this.V(t);r.be();_j.e.a(_a.a.bl,"Complete upgrade.");var u=r.bj();u.c()?u.i():_a.br.a&&_j.m.a().c(_a.a.a,"SafeTriggerPolicyTipsIfNeededForOpenDraft",this.N);r.bf.a(_db.bG,new _mcp.bX(t.P().bB.ItemId.Id,r))}else _j.e.a(_a.a.bl,"MailComposeUpgrade failed since user switched view model context. ContextId={0}; Context{1}=",f,t)},C:function(){this.p=_y.j.b(_a.a.a,"MailComposeOnDemandUpgrade",!0);var n=this.bl.a.Z;n.eb(!0);if(this.m||n.P()&&n.m()){this.m||(this.m=n.P());_j.e.a(_a.a.bl,"user requests for quoted body, upgrade was successful, complete the body merge");this.z();this.by("ShouldShowQuoteBodyButton","IsOnDemandUpgradePending")}else if(n.L()){_j.e.a(_a.a.bl,"user requests for quoted body, upgrade failed, show error message");this.by("ShouldShowQuoteBodyButton","IsOnDemandUpgradePending");this.S();this.bj.be();this.P()}else{_j.e.a(_a.a.bl,"user requests for quoted body, upgrade has yet to come back, show spinner");this.by("ShouldShowQuoteBodyButton","IsWaitingForQuotedBody")}},z:function(){var n=this.bl.a.Z;var e=!1;if(this.o.b()){if(n.eN()){n.eR.a();n.y()===n.eN().a()&&(e=!0)}else n.fu=!0;n.ft=!0}if(this.bj.bk()&&this.j()&&this.m.O()&&n.j()!==this.m.O().a()&&this.o.b()){var f=this.m.O().bB.Value;if(n.j()==="HTML")n.fl(_a.A.b(f));else{var i;var o,r;r=_a.A.a(f,o={val:i}),i=o.val,r;n.fl(i);var h=this;n.fi=function(n){n.bc().x(!1)}}}else if(this.o.b()||n.j()!=="HTML"){var u=this.m.O().bB.Value;n.fl(!this.o.b()&&n.j()==="Text"?_a.A.G(u):u)}else n.fl(this.m.cc().bB.Value);if(_y.c.a.a()==="Mouse"||this.o.b()){this.bk.gX();var t=new _cmc.o(2,n.dw(),n.j()==="HTML",7);t.s=!1;t.z=!0;var c=this;t.A=function(){n.cN(!0)};this.bj.bN().a(t)}else n.cN(!0);if(e){n.eR.a();n.eN().r(n.y());var s=n.eO;s&&n.eO.r(n.y())}this.A(!0)},R:function(n){this.u=!1;var r=n;var u=r.Q?r.Q.correlationId:null;r.t(this.t);if(this.bq()){_j.e.a(_a.a.a,"MailComposeUpgradeComponent.OnUpgradeFailure: viewModel is null or disposing, aborting logic.");this.s("SkipUpgrade",u,"Skip upgrade since view mode is disposed");return}var s=this.bl;var t=s.a;var f=t.Z;var h=t.bp();f.et(!0);var i=n.h();if(this.v.a(i)){_j.e.a(_a.a.bl,"Resume discard for context {0}",i);h.c(i,r.F)}else if(i===f.d()){_j.e.a(_a.a.bl,"Recording on context upgrade failed");var e=t.bj();var o=t.bg();if(e.c()){if(e.g()){_j.e.a(_a.a.bl,"Skipping upgrade for context {0} since save and then send was triggered during upgrade",i);this.s("SkipUpgrade",u,"Skip upgrade since saving is in progress");e.i();return}_mcp.O.a(t)}else if(o.b()){_j.e.a(_a.a.bl,"Skipping upgrade for context {0} since send was triggered during upgrade",i);this.s("SkipUpgrade",u,"Skip upgrade since send is in progress");o.g();return}else t.bk()||_mcp.O.a(t);if(this.j()&&f.bl()){_j.e.a(_a.a.bl,"upgrade failed and user requested for upgrade, show the failure and trigger property changes to hide the spinner");this.by("IsWaitingForQuotedBody","IsOnDemandUpgradePending")}}n.g()&&this.Y(n.g(),i,u,f)},Y:function(n,t,i,r){var f;var u;var o,e;this.dg(n,o={val:f},e={val:u},"UpgradeFailure_UnknownError"),f=o.val,u=e.val;_j.e.b(_a.a.bl,"Upgrade failed. ContextId={0}, Context={1}, Server Error: {2}",t,r,u);this.s(f,i,u)},S:function(){var n=this.bl.a.ba;n.b(3450);n.a(3450,null)},s:function(n,t,i){this.F=n;this.E=t;this.G=i;if(this.n){_y.j.a(this.n,null,n,t,i);this.n=null;_a.H.b("MailComposeUpgrade")}if(this.q){_y.j.a(this.q,null,n,t,i);this.q=null}this.P()},A:function(n){if(this.n){n&&this.n.n(new _a.D("UIUpdated"));_y.j.a(this.n);this.n=null;_a.H.b("MailComposeUpgrade")}this.W()},W:function(){if(this.p){_y.j.a(this.p);this.p=null}},P:function(){if(this.p){_y.j.a(this.p,null,this.F,this.E,this.G);this.p=null}},Z:function(){_mcp.I.a(this.bj,32)}};_mcp.bJ=function(n,t,i){this.g=Function.createDelegate(this,this.j);_mcp.bJ.initializeBase(this,[17,n]);if(_a.cu.a){var r=this;t.a(function(n){if(r.bq()){_j.e.a(_a.a.a,"MailComposeMailTipsComponent.ctor: viewModel is null or disposing, aborting logic.");return}var f=r.bj;var u=f.bb();var e=r.bj.fb();var t=f.ba;if(u&&t){r.c=n.a(u,t,i,e);r.bk.V()&&r.c.f(r.bk.V().EmailAddress);if(r.d){r.i();r.d=!1}if(r.f){r.c.a();r.f=!1}}})}};_mcp.bJ.prototype={c:null,d:!1,f:!1,h:function(){if(!_a.cu.a){_mcp.I.prototype.h.call(this);return}this.c?this.i():this.d=!0;_mcp.I.prototype.h.call(this)},a:function(n){if(_a.cu.a||!this.cb){if(n===32){var r=this.bl;var i=r.a;var t=i.Z;if(t.dm()){i.ba.b(4400);i.ba.a(4400);this.bj.be()}if(!t.a()&&(!t.f()||!t.f().b())&&(!t.k()||!t.k().b())&&(!t.b()||!t.b().b())||t.a()===3||t.a()===11)return}this.e()||this.h();this.k()}},b:function(){if(_a.cu.a){this.e()||this.h();if(this.c){_j.e.a(_a.a.a,"Remove MailTips for deleted recipients");this.c.e()}else _j.e.a(_a.a.a,"MailTips for deleted recipients was called when MailTipsHandler hasn't been created, no operation needed")}},bw:function(){if(this.c){this.c.c(null);this.c=null}_mcp.I.prototype.bw.call(this)},i:function(){this.c.b();this.c.c(this.g)},k:function(){if(_a.cu.a)if(this.c){_j.e.a(_a.a.a,"Prepares to submit mailtips action");this.c.a()}else{_j.e.a(_a.a.a,"Remember to submit MailTips action once the MailTipsHandler is created");this.f=!0}},j:function(){if(_a.cu.a){this.bj.dF(this.c.d());this.bj.be()}}};_mcp.bN=function(n,t){this.g=Function.createDelegate(this,this.i);_mcp.bN.initializeBase(this,[29,n]);if(t){var i=this;t.a(function(n){if(i.bq()){_j.e.a(_a.a.a,"MailComposePeopleRecommendationsComponent.ctor: viewModel is null or disposing, aborting logic.");return}var t=i.bj;i.c=n.a(i.bj.bb(),i.bj.ba);i.c.c(i.g);if(i.d){i.c.b();i.d=!1}if(i.f){i.c.a();i.f=!1}})}};_mcp.bN.prototype={c:null,d:!1,f:!1,h:function(){this.c?this.c.b():this.d=!0;_mcp.I.prototype.h.call(this)},b:function(n){this.e()||this.h();this.j()},a:function(){this.c&&this.c.e(!0)},bw:function(){if(this.c){this.c.c(null);this.c=null}_mcp.I.prototype.bw.call(this)},j:function(){if(this.c){_j.e.a(_a.a.a,"Prepares to submit PeopleRecommendations action");this.c.a()}else{_j.e.a(_a.a.a,"Remember to submit PeopleRecommendations action once the PeopleRecommendationsHandler is created");this.f=!0}},i:function(){this.bj.be()}};_mcp.bP=function(n,t){this.p=Function.createDelegate(this,this.w);this.o=Function.createDelegate(this,this.v);this.n=Function.createDelegate(this,this.u);this.m=Function.createDelegate(this,this.t);this.l=Function.createDelegate(this,this.s);_mcp.bP.initializeBase(this,[23,n]);if(_a.br.a){var i=this;t.a(function(n){if(i.bq()){_j.e.a(_a.a.a,"MailComposePolicyTipsComponent.ctor: viewModel is null or disposing, aborting logic.");return}var t=i.bj;var f=t.bb();var u=t.bc();var r=t.ba;if(f&&u&&r){i.f=n.a(f,u,r);i.f.h(i.l);i.f.d(i.m);i.f.c(i.n);i.f.e(i.o);i.f.f(i.p);if(i.i){i.f.b();i.i=!1}if(i.j){i.a(i.k);i.j=!1}}})}};_mcp.bP.prototype={g:null,f:null,i:!1,j:!1,k:0,h:function(){if(!_a.br.a){_mcp.I.prototype.h.call(this);return}this.f?this.f.b():this.i=!0;_mcp.I.prototype.h.call(this)},bw:function(){this.g&&(this.g=_j.m.a().b(this.g));if(this.f){this.f.h(null);this.f.d(null);this.f.c(null);this.f.e(null);this.f.f(null);this.f=null}_mcp.I.prototype.bw.call(this)},c:function(){if(!_a.br.a)return!1;switch(this.q()){case 1:return!1;case 2:case 3:return this.bl.a.Z.cq()===null&&this.bl.a.Z.cp()===null;case 4:case 5:return this.bl.a.Z.cp()===null;default:return!1}},b:function(){if(!_a.br.a)return"";switch(this.q()){case 2:case 3:return _u.P.S;case 4:case 5:return _u.P.G;default:return""}},d:function(){if(_a.br.a){if(!this.f){_j.e.a(_a.a.I,"skip setting message sent flag since handler hasn't been created yet.");return}this.f.i(!0);if(this.bl.a.Z.cq()){var n=new _cmc.g(_a.a.I,"DlpPolicyTipOverridden",!1);n.b()}}},a:function(n){this.r(n,0)},x:function(n,t,i){_j.e.a(_a.a.a,"Prepares to submit policyTips action");var u;var r;if(n.eN()){u=_a.I.c(n.eN().f());r=_a.I.c(n.eN().a())}else{u=_a.I.c(n.I());r=_a.I.c(n.y())}this.f.g(i,n.q(),u,r,t)},r:function(n,t){if(_a.br.a&&!this.cb){if(!this.f){_j.e.a(_a.a.I,"Remember to resume triggering policy tips once the handler is created");this.k=n;this.j=!0;return}var f=this.bl;var e=f.a;var r=e.Z;this.e()||this.h();this.g&&(this.g=_j.m.a().b(this.g));var i=r.h();if(i){_bc.f.a(i)&&!_g.k.b&&(i=_g.k.a.q(i));if(_bc.f.a(i)){if(t<4){var u=this;this.g=_j.m.a().a(_a.a.I,"TriggerPolicyTipsIfNeeded",function(){u.r(n,t+1)},5e3)}}else this.x(r,n,i)}}},q:function(){this.e()||this.h();return this.f?this.f.a():0},s:function(){this.bj.be()},t:function(n){var r=this.bl;var i=r.a;var t=i.Z;t.dO(n)},u:function(n){var r=this.bl;var i=r.a;var t=i.Z;t.dN(n)},v:function(){this.a(64)},w:function(n){var r=this.bl;var i=r.a;var t=i.Z;t.dM(n)}};_mcp.A=function(n,t){this.P=Function.createDelegate(this,this.bG);this.Z=Function.createDelegate(this,this.bP);this.bc=Function.createDelegate(this,this.bt);this.bd=Function.createDelegate(this,this.bA);this.ba=Function.createDelegate(this,this.bQ);this.Y=Function.createDelegate(this,this.bO);this.bb=Function.createDelegate(this,this.bR);this.U=Function.createDelegate(this,this.br);this.W=Function.createDelegate(this,this.bI);this.X=Function.createDelegate(this,this.bJ);this.T=Function.createDelegate(this,this.bD);this.V=Function.createDelegate(this,this.bE);this.bh=Function.createDelegate(this,this.bB);this.bi=Function.createDelegate(this,this.bW);_mcp.A.initializeBase(this,[22,n]);this.O=!1;this.bf=t;this.N=new _j.g(this.bi,_a.a.i);this.N.c(!1)};_mcp.A.a=function(n){switch(n){case 0:return 0;case 1:return 1;case 2:return 2;default:throw Error.argument();}};_mcp.A.prototype={Q:null,R:0,O:!1,bg:!1,M:null,bf:null,be:null,N:null,a:function(){return this.M},bT:function(n){if(this.M!==n){this.M=n;this.bS(["ExtensibilityViewModel","ShouldShowAppsButton","ToggleAppPaneCommand","PopoutTaskPanePanelViewModel"])}return n},b:function(){return this.M?this.M.B():!1},bF:function(){return this.bj.bk()?this.bj.bl().j():this.M?this.M.F():null},K:function(){return this.M?this.M.q():null},j:function(){return this.N},m:function(){return!!this.M&&this.M.f()&&this.N.b&&!this.M.d()&&(!this.M.C()||this.bj.bq())},l:function(){return this.M?this.M.b():!0},bV:function(n){if(n!==this.bg){this.bg=n;this.bv("RequestCloseComposeForm")}return n},h:function(){if(!_a.g.b&&!this.e()){var n=this;this.bf.a(function(t){if(!n.M){if(n.bq()){_j.e.a(_a.a.a,"MailComposeExtensibilityComponent.Initialize: viewModel is null or disposing, aborting logic.");return}var i=n.bj;n.be=t;n.bT(t.d(n,n.bh,i.bq(),i.bJ()));var r=i.cF();n.M.w(r.a());n.M.H(i.bq());var u=i.bf;u.b(_a.di,n.V);n.M.h();r.apcl(r.b(),n.T);n.M.j(n.X);n.M.i(n.W);n.M.a().j(n.U);n.br(null,null);n.M.apcl("ShowAppsButton",n.bb);n.M.apcl("ExtensibilityContext",n.Y);n.M.apcl("PopoutTaskPanePanelViewModel",n.ba);_mcp.I.prototype.h.call(n);if(n.bk.fJ()&&n.bk.fJ().length>0){n.bn(n.bk.fJ());n.bk.cD(null)}n.bk.gG(n.bd);n.bk.gF(n.bc);n.bt(null);n.bH()}})}},bQ:function(n,t){this.bv("PopoutTaskPanePanelViewModel")},bu:function(n,t,i,r,u,f){var o=this;var e=function(n,t){if(n){o.G();f()}};u.p||u.g(1,t,e,!1,i,r,n,u.z)},k:function(n,t){this.bu(_nbs.a.IG,_nbs.a.gK,_nbs.a.bk,_nbs.a.VR,n,t)},L:function(n,t){this.bu(_nbs.a.IG,_nbs.a.rX,_nbs.a.oV,_nbs.a.Vr,n,t)},G:function(){this.M&&this.M.c()&&this.M.c().b()},bH:function(){if(this.bk&&this.bk.P()&&this.bj.fg()&&this.bj.cf){var n=this;this.bj.cf.a(function(t){n.bk&&n.bk.P()&&t.a().a().a(n.bk.P())})}},bt:function(n){this.bk.P()&&this.bk.P().cf.o(this.Z)},bA:function(n){this.bk.P()&&this.bk.P().cf.q(this.Z)},bP:function(n,t){if(this.bj&&this.bj.cf){var i=this;this.bj.cf.a(function(n){i.bk&&i.bj&&n.b(i.bk.P(),i.bj.ba)})}},bn:function(n){if(!this.Q){var s;var r=null;var o;if(this.bl.a.Z.m()){o=this.bl.b(5);r=o.a()}else _j.e.a(_a.a.i,"Attachment not added - well not upgraded.");if(!r&&this.R<10){var i=this;this.Q=_j.m.a().a(this.bm(),"MailComposeExtensibilityComponent - add attachments from context on delay",function(){if(!i.cb){i.R++;i.Q=null;i.bn(n)}},100*this.R)}else for(var t=0;t<n.length;t++)if(n[t][0]==="file"){var h=!1;_j.h.a(n[t][3])||(h=n[t][3]);this.bo(r,n[t][2],n[t][1],!0,h)}else if(n[t][0]==="item"){var u=new _g.D;u.c(new _g.e(n[t][2]));u.e(n[t][1]);var e,f;f=this.bp(r,u,e={val:s},!0),s=e.val,f}}},bs:function(){this.bv("ShouldShowAppsButton");if(this.bj.bZ()){var n=this.bl.b(27);n.G(this.m())}},bR:function(n,t){this.bs()},bO:function(n,t){this.bj.ba.b(103)},bo:function(n,t,i,r,u){var e=this.be.b(t,i);var f=n.bc(e,u,u?i:null);f?f.C(r):_j.e.b(_a.a.i,"Could not create a valid attachment view model. This could be due to policy configuration.");return f},bp:function(n,t,i,r){i.val=0;var e=new _db.F(t,t.bB.ParentItemId);var f=new _j.q;f.c(e);var o=_a.c.b(_a.a.b,"AttachmentExtensibilityItemAttachments");var u=n.H(f,o);if(!u.d.length){_j.e.a(_a.a.i,"Attachment not added - max number exceeded.");i.val=9001;return null}u.d[0].C(r);return u.d[0]},f:function(){return _y.c.a.a()==="Mouse"?this.bl.a.Z.j():this.bl.a.Z.dx()?"HTML":"Text"},w:function(){return this.bl.a.Z.u()},B:function(n){this.bl.a.Z.v(n)},v:function(n,t,i){i.val=0;var r=new _cmc.t(n);this.bl.a.Z.cP(r);r.b&&(i.val=9016);t.val=r.d;return r.a},A:function(n,t,i){i.val=0;var r=new _cmc.z(n,!0,t,12);this.bl.a.Z.cP(r);r.w?i.val=2006:r.x&&(i.val=9016)},s:function(){this.bV(!0);this.bv("RequestCloseComposeForm")},u:function(n){return this.bj.bb().G(_mcp.A.a(n))},E:function(n,t){return this.bx(n,t,!1)},z:function(n,t){this.bx(n,t,!0)},q:function(n,t,i){t.val=0;if(!this.bl.a.Z.m()){_j.e.a(_a.a.i,"Attachment not added - well not upgraded.");t.val=9005;return null}var r=this.bl.b(5);if(r.a())return this.bp(r.a(),n,t,i);else{_j.e.a(_a.a.i,"ComposeFormNotReadyForAttachments in mail module");t.val=9015;return null}},p:function(n,t,i,r){i.val=0;if(!this.bl.a.Z.m()){_j.e.a(_a.a.i,"Attachment not added - well not upgraded.");i.val=9005;return null}var f=this.bl.b(5);var u=f.a();if(u)return this.bo(u,n,t,!1,r);_j.e.c(_a.a.i,"ComposeFormNotReadyForAttachments in mail module");i.val=9015;return null},F:function(){return this.bl.a.Z.bi()?this.bl.a.Z.bi().Id:null},n:function(n,t){var i=new _cmc.o(0,n,t,12);i.o=!0;i.p=!0;this.S(i)},o:function(n,t){var i=new _cmc.o(1,n,t,12);this.S(i)},i:function(n,t){var r=this,i=this;this.bl.a.bj().b(function(t){n()},function(n){_j.e.a(_a.a.i,"SaveActionFailed: Error: {0}",n.I.message);t()})},t:function(n){var t=new _cmc.V(n);this.bl.a.Z.cG(t);return t.a},y:function(n,t,i){i.val=0;var r=new _cmc.bm(n,t,12);this.bl.a.Z.cG(r);r.c&&(i.val=2006)},c:function(){return this.bk.P()},bW:function(){this.M&&this.M.I()},br:function(n,t){this.N.c(this.M.a().b);this.bs()},bJ:function(){if(_y.c.a.a()==="TouchWide"&&this.M.p()){var n=this.bl.a;n.ew(6)}},bI:function(){var n=this.bl.a;n.ew(4)},S:function(n){this.bj.bN().a(n)},d:function(){return this.bl.a.Z.h()?this.bl.a.Z.h().Id:null},g:function(){this.bl.a.Z.Q()||this.bl.a.Z.dS(new _j.l);return this.bl.a.Z.Q()},x:function(){},C:function(){var n=new _cmc.I(null);this.S(n)},r:function(n){var t=new _cmc.I(n);this.S(t)},I:function(n,t,i){i.val=!1;if(this.bk&&this.bk.eS)return!0;if(!this.M){if(n.a().cx().Enabled){this.bj.ba.a(103);return!1}return!0}return this.M.o(!0,this.bj.ba,t,i)},bw:function(){var t=this.bl.a.cF();t.rpcl(t.b(),this.T);this.bj.bf.c(_a.di,this.V);if(this.M){this.M.u(this.X);this.M.t(this.W);this.M.a().i(this.U);this.M.rpcl("ShowAppsButton",this.bb);this.M.rpcl("ExtensibilityContext",this.Y);this.M.rpcl("PopoutTaskPanePanelViewModel",this.ba);this.M.n();this.M.m();this.M=null}if(this.N){this.N.c(!1);this.N.i(this.P);var n;_a.h.a(n={val:this.N}),this.N=n.val}if(this.bk){this.bA(null);this.bk.hi(this.bd);this.bk.hh(this.bc)}_mcp.I.prototype.bw.call(this)},bx:function(n,t,i){i&&this.bj.bb().bf(_mcp.A.a(n));var e=this.bj.bb().G(_mcp.A.a(n));var u=t.d.length;if(u+e.x.length>500)return!1;n===2&&this.bl.a.bb().z().a();for(var r=0;r<u;r++){var f=t.d[r];this.bj.bb().V(f,_mcp.A.a(n))}return!0},bE:function(n){if(this.O){this.O=!1;this.M.g(!1)}},H:function(){this.m()?this.N.a():this.N.j(this.P)},bB:function(n){if(n===1){var r=window.document.body.clientWidth;if(r<1367){var i=this.bl.a.bf;i.a(_a.dB,new _a.dB(!0));this.O=!0}}else if(n===2&&this.O){var t=this.bl.a.bf;t.a(_a.dB,new _a.dB(!1));this.O=!1}this.bj.be()},bD:function(n,t){var i=this.bl.a.cF();t===i.b()&&this.bX(i)},bX:function(n){this.M.w(n.a());n.a()&&this.M.g(!1)},bG:function(n,t){if(this.N.b){this.N.i(this.P);this.N.a()}}};_mcp.bH=function(n,t,i,r){this.o=Function.createDelegate(this,this.v);this.m=Function.createDelegate(this,this.t);this.n=Function.createDelegate(this,this.u);_mcp.bH.initializeBase(this,[30,n]);this.p=t;this.l=i;this.k=r};_mcp.bH.prototype={k:null,p:null,j:null,l:null,i:null,h:function(){_mcp.I.prototype.h.call(this);this.s()},a:function(n){this.i&&!_j.h.a(this.i.a())&&this.i.c(n)},g:function(n){this.j=n;this.j.b(this.n);this.j.a(this.m);this.j.c(this.o)},f:function(n){if(this.k){var t=this;this.k.a(function(i){t.r(i,n)})}},b:function(n,t,i){var r=this.bk;if(r){var u=r.cx();u[n.b()]=n.a();this.q(n.a(),t,i)}},d:function(n){this.i&&this.i.j(n)},c:function(n,t){this.i&&!_j.h.a(this.i.a())&&this.i.d(n,t)},bw:function(){this.w();_mcp.I.prototype.bw.call(this)},s:function(){if(this.l){var n=this;this.l.a(function(t){var i=t.a(n.bj.bo.b,n.bj.bU.h());i.f("TagName");i.h("PositionIndex");i.e("HashtagFeedback");i.i(_a.a.O);i.g(2);n.i=i})}},w:function(){if(this.j){this.j.e(this.n);this.j.d(this.m);this.j.f(this.o);this.j=null}},r:function(n,t){for(var r=Object.keys(t),f=r.length,u=new Array(f),i=0;i<f;i++)u[i]=t[r[i]];n.b(u)},v:function(n){var t=n.c();_cmc.D.b(t,this.bk.eT)},u:function(n){var t=n.c();var i=_cmc.D.d(t);_cmc.D.e(i,this.bk.eT);_cmc.D.c(t,this.bk.eT)},t:function(n){var t=n.c();_cmc.D.b(t,this.bk.eT)},q:function(n,t,i){this.i&&this.i.b(t>=0?7:4,n.substr(1),t>=0?i:[n.substr(1)],t)}};_mcp.bS=function(n){_mcp.bS.initializeBase(this,[22,n])};_mcp.bS.prototype={m:function(){return!1},j:function(){return null},l:function(){return!0},b:function(){return!1},a:function(){return null},K:function(){return null},H:function(){},k:function(n,t){},L:function(n,t){},G:function(){},I:function(n,t,i){i.val=!1;return!0}};_mcp.bA=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht){_a.b.b(e,"nativeBridge");this.a=n;this.b=i;this.c=r;this.B=u;this.u=t;this.h=f;this.e=e;this.f=o;this.o=s;this.q=h;this.r=c;this.t=l;this.D=a;this.m=v;this.g=y;this.n=p;this.A=w;this.l=b;this.p=k;this.z=d;this.i=g;this.G=nt;this.d=tt;this.C=it;this.E=rt;this.k=ut;this.s=ft;this.v=et;this.y=ot;this.x=st;this.j=ht};_mcp.bA.prototype={a:null,k:null,b:null,c:null,B:null,u:null,h:null,e:null,f:null,o:null,q:null,r:null,D:null,m:null,g:null,n:null,A:null,x:null,G:null,l:null,z:null,d:null,s:null,v:null,y:null,t:null,C:null,E:null,p:null,i:null,j:null,w:function(n,t,i){switch(n){case 0:return new _mcp.L(this.a,this.c,this.m,!!this.f);case 1:return new _mcp.f(this.a,this.b,this.d);case 2:return new _mcp.t(this.a,this.c,this.b,this.d);case 3:return new _mcp.E(this.a,this.c,this.b,this.d);case 4:return new _mcp.g(this.a,this.n,this.g);case 5:return new _mcp.m(this.a,this.u,this.b,this.c,this.B,this.a.a.ds,this.t);case 6:return new _mcp.bI(this.a,this.c,this.b,this.d);case 7:return this.b&&this.b.a().bw().Enabled?new _mcp.K(this.a,this.c,this.b,this.d,this.a.a.bf):new _mcp.s(this.a,this.c,this.b,this.d,this.a.a.bf);case 8:return new _mcp.V(this.a,this.h,this.c,this.b,this.d);case 9:return new _mcp.bK(this.a,this.f,this.b,this.d);case 10:if("Mouse"!==t)return new _mcp.bR(this.a,this.k);break;case 11:return new _mcp.o(this.a,this.c,this.b,this.d,this.E);case 12:return new _mcp.O(this.a,this.c,this.b);case 13:if(this.e.b(this.e.f())&&this.e.f().a().f())return new _mcp.bO(this.a,this.e);break;case 20:if(this.e.b(this.e.f())&&this.e.f().a().a())return new _mcp.bM(this.a,this.e);break;case 14:return new _mcp.W(this.a,this.g);case 15:if("Mouse"===t)return new _mcp.bC(this.a,this.f,this.b,this.d);break;case 16:if("Mouse"===t)return new _mcp.J(this.a);else if("TouchNarrow"===t)return new _mcp.bD(this.a);break;case 18:return new _mcp.r(this.a,this.d);case 17:return new _mcp.bJ(this.a,this.o,this.b);case 29:return new _mcp.bN(this.a,this.q);case 23:return new _mcp.bP(this.a,this.r);case 19:return new _mcp.p(this.a);case 21:if(this.e.b(this.e.m()))return new _mcp.bQ(this.a,this.e);break;case 22:return i===3?new _mcp.bS(this.a):new _mcp.A(this.a,this.a.a.dw);case 24:if(this.c.b())return new _mcp.v(this.a,this.b,this.c,this.D);break;case 30:if(this.c.b()&&this.c.e())return new _mcp.bH(this.a,this.a.a.bf,this.z,this.l);break;case 25:return t!=="Mouse"?new _mcp.bF(this.a):new _mcp.bE(this.a,this.f,this.b,this.y);case 27:if(t==="Mouse")return new _mcp.y(this.a,this.C,this.d,this.A);break;case 28:return new _mcp.bL(this.a,this.f,this.b,this.d);case 31:return new _mcp.F(this.a);case 32:if(this.c.c())return new _mcp.bz(this.a,this.c,this.a.a.bf,this.s);break;case 36:if(this.c.a().dk().Enabled)return new _mcp.u(this.a,this.c,this.x);break;case 34:if(this.b&&this.b.a()&&this.b.a().fp().Enabled)return new _mcp.bG(this.a,this.p,this.i);break;case 35:if(this.c.a().bn().Enabled)return new _mcp.h(this.a,this.c,this.i,this.v);break;case 37:if(this.b&&this.b.a()&&this.b.a().C().Enabled)return new _mcp.by(this.a,this.c,this.b,this.d,this.j);break}return null}};_mcp.X=function(n,t){this.c=n;this.d=t};_mcp.X.prototype={c:!1,d:!1,a:function(){return this.c},b:function(){return this.d}};_mcp.bg=function(){};_mcp.bT=function(){};_mcp.bT.prototype={a:function(n,t){var r=n;var i=null;switch(r){case"Normal":i=_nbs.a.hx;break;case"Personal":i=_nbs.a.Vs;break;case"Private":i=_nbs.a.WC;break;case"Confidential":i=_nbs.a.w;break;default:i=_nbs.a.hx;break}return i},b:function(n,t){throw Error.notImplemented();}};_mcp.k=function(n){_mcp.k.initializeBase(this,[n])};_mcp.k.prototype={a:null,p:function(){},o:function(){},s:function(n){},q:function(n){},r:function(n){},u:function(n){},t:function(n,t){t.val=3;this.a.a();return!0}};_mcp.e=function(){};_mcp.e.N=function(){return _fm.b.a(_fm.a.O,_fm.WebfontSizes.a.b,"ms-fcl-tp-b")};_mcp.e.L=function(){return _fm.b.a(_fm.a.bU,_fm.WebfontSizes.a.b,"ms-fcl-tp-b")};_mcp.e.M=function(){return _fm.b.a(_fm.a.bU,_fm.WebfontSizes.a.a,"ms-fcl-nd-b")};_mcp.e.j=function(){return _fm.b.a(_fm.a.i,_fm.WebfontSizes.a.b,"ms-fcl-tp-b")};_mcp.e.t=function(){return _fm.b.a(_fm.a.v,_fm.WebfontSizes.a.b,"ms-fcl-tp-b")};_mcp.e.u=function(){return _fm.b.a(_fm.a.v,_fm.WebfontSizes.a.b,"ms-fcl-nt-b")};_mcp.e.s=function(){return _fm.b.a(_fm.a.v,_fm.WebfontSizes.a.f,"ms-fcl-ns-b")};_mcp.e.v=function(){return _fm.b.a(_fm.a.v,_fm.WebfontSizes.a.f,"ms-fcl-nd-b")};_mcp.e.w=function(){return _fm.b.a(_fm.a.v,_fm.WebfontSizes.a.d,"ms-fcl-ns-b")};_mcp.e.I=function(){return _fm.b.a(_fm.a.B,_fm.WebfontSizes.a.b,"ms-fcl-ns-b")};_mcp.e.J=function(){return _fm.b.a(_fm.a.B,_fm.WebfontSizes.a.d,"ms-fcl-tp-b")};_mcp.e.K=function(){return _fm.b.a(_fm.a.B,_fm.WebfontSizes.a.b,"ms-fcl-nd-b")};_mcp.e.z=function(){return _fm.b.a(_fm.a.a,_fm.WebfontSizes.a.a,"ms-fcl-tp-b")};_mcp.e.A=function(){return _fm.b.a(_fm.a.a,_fm.WebfontSizes.a.b,"ms-fcl-nsa-b")};_mcp.e.D=function(){return _fm.b.a(_fm.a.H,_fm.WebfontSizes.a.g,"ms-fcl-ns-b")};_mcp.e.F=function(){return _fm.b.a(_fm.a.H,_fm.WebfontSizes.a.g,"ms-fcl-nd-b")};_mcp.e.a=function(){return _fm.b.a(_fm.a.A,_fm.WebfontSizes.a.g,"ms-fcl-ns-b")};_mcp.e.h=function(){return _fm.b.a(_fm.a.A,_fm.WebfontSizes.a.g,"ms-fcl-nd-b")};_mcp.e.E=function(){return _fm.b.a(_fm.a.H,_fm.WebfontSizes.a.g,"ms-fcl-nta-b")};_mcp.e.G=function(){return _fm.b.a(_fm.a.H,_fm.WebfontSizes.a.g,"ms-fcl-tp-b")};_mcp.e.f=function(){return _fm.b.a(_fm.a.c,_fm.WebfontSizes.a.a,"ms-fcl-ns-b")};_mcp.e.g=function(){return _fm.b.a(_fm.a.c,_fm.WebfontSizes.a.a,"ms-fcl-nd-b")};_mcp.e.b=function(){return _fm.b.a(_fm.a.bv,_fm.WebfontSizes.a.a,"ms-fcl-ns-b")};_mcp.e.d=function(){return _fm.b.a(_fm.a.c,_fm.WebfontSizes.a.a,"ms-fcl-ns-b","ms-fcl-ns-b")};_mcp.e.e=function(){return _fm.b.a(_fm.a.c,_fm.WebfontSizes.a.a,"ms-bgc-ns","ms-fcl-ns-b","ms-fcl-w-b")};_mcp.e.c=function(){return _fm.b.a(_fm.a.i,_fm.WebfontSizes.a.g,"ms-fcl-ns-b")};_mcp.e.x=function(){return _fm.b.a(_fm.a.i,_fm.WebfontSizes.a.g,"ms-fcl-nd-b")};_mcp.e.y=function(){return _fm.b.a(_fm.a.i,_fm.WebfontSizes.a.g,"ms-fcl-td-b")};_mcp.e.i=function(){return _fm.b.a(_fm.a.i,_fm.WebfontSizes.a.g,"ms-fcl-nta-b")};_mcp.e.n=function(){return _fm.b.a(_fm.a.bl,_fm.WebfontSizes.a.b,"ms-fcl-ns-b")};_mcp.e.o=function(){return _fm.b.a(_fm.a.bl,_fm.WebfontSizes.a.b,"ms-fcl-nd-b")};_mcp.e.p=function(){return _fm.b.a(_fm.a.bl,_fm.WebfontSizes.a.b,"ms-fcl-td-b")};_mcp.e.q=function(){return _fm.b.a(_fm.a.h,"ms-fcl-ns-b")};_mcp.e.C=function(){return _fm.e.a("insertpicture.png")};_mcp.e.H=function(){return _fm.b.a(_fm.a.cz,_fm.WebfontSizes.a.g)};_mcp.e.k=function(){return _fm.b.a(_fm.a.bu,_fm.WebfontSizes.a.b,"ms-fcl-ns-b")};_mcp.e.l=function(){return _fm.b.a(_fm.a.bu,_fm.WebfontSizes.a.b,"ms-fcl-nd-b")};_mcp.e.m=function(){return _fm.b.a(_fm.a.bu,_fm.WebfontSizes.a.b,"ms-fcl-td-b")};_mcp.e.r=function(){return _fm.b.a(_fm.a.a,_fm.WebfontSizes.a.c)};_mcp.e.B=function(){return _fm.b.a(_fm.a.e,_fm.WebfontSizes.a.c)};_mcp.e.O=function(){return _fm.b.a(_fm.a.dx,_fm.WebfontSizes.a.c)};_mcp.ch=function(n,t,i,r,u,f,e,o){this.eU=Function.createDelegate(this,this.gu);this.fg=Function.createDelegate(this,this.gz);this.dD=Function.createDelegate(this,this.cL);this.dC=Function.createDelegate(this,this.gw);this.ff=Function.createDelegate(this,this.gv);_mcp.ch.initializeBase(this,[n,"Mouse",t,i,r,u,f,e]);this.cE=u;this.bf=t;this.dE=r;this.cP=o};_mcp.ch.prototype={dE:null,bP:!1,A:!1,cf:!1,bR:null,cO:null,bD:!1,cP:null,gx:function(n){this.bP=n;this.by("EnableRichTextOptions","ShowOneRibbon");this.cL();return n},w:function(){return _mcp.d.isInstanceOfType(this.W())&&this.W().bk()},cm:function(n){this.A=n;this.fm();return n},fh:function(){return this.cf&&!this.A},cM:function(n){this.cf=n;this.fm();return n},fY:function(){return!this.w()&&this.cf&&!this.A},gs:function(){return!this.w()&&!this.cf&&!this.A},fX:function(){return this.w()||this.A},fj:function(){return!this.A&&!this.cf},fZ:function(){return this.bf.g()},ga:function(){return this.bf.h()},fi:function(){return this.bf.b()||this.bf.h()},dF:function(){return this.gt()},cE:null,bf:null,cI:function(){return this.bD&&this.bP},gy:function(n){if(this.bD!==n){this.bD=n;this.bv("ShowOneRibbon")}return n},fk:function(){this.bR||(this.bR=new _zz.M(this.s(),this.ci(),"OneRibbon"));return this.bR},bl:function(){var n=this.W();return this.w()?_mcp.i.prototype.bl.call(this):250},n:null,gr:function(){return!!this.W()&&_mcp.D.isInstanceOfType(this.W())&&!!this.W().Z&&this.W().Z.cu()},x:function(){_mcp.i.prototype.x.call(this);this.cN();if(this.n){var n=this.w();var i=n&&!!this.cP&&this.cP.a().n()==="ChronologicalNewestOnBottom";var t=this.gr()?160:0;this.n.i(this.i.InlineComposeBody,this.s(),this.i.InlineComposeHeaderWrapper,this.i.InlineComposeBottomEdge,this.i.OneRibbonFiller,this.i.AttachmentWellViewWrapper,n,i,t);this.s()&&this.s().eM(this.n);this.i.EditorFocusHandler&&this.i.EditorFocusHandler.bd("focus",this.ff,"MailComposeDockableView");this.n.b(this.dC);this.n.f(this.dD)}},H:function(){_mcp.i.prototype.H.call(this);if(this.C){this.i.InlineComposeBottomEdge=this.C.a("InlineComposeBottomEdge");this.i.InlineComposeBody=this.C.a("InlineComposeBody");this.i.InlineComposeHeaderWrapper=this.C.a("InlineComposeHeaderWrapper");this.i.OneRibbonFiller=this.C.a("OneRibbonFiller");this.i.OneRibbon=this.C.a("OneRibbon");this.i.Emoji=this.C.a("Emoji");this.i.EditorFocusHandler=this.C.a("EditorFocusHandler")}else{this.i.InlineComposeBottomEdge=null;this.i.InlineComposeBody=null;this.i.InlineComposeHeaderWrapper=null;this.i.OneRibbonFiller=null;this.i.OneRibbon=null;this.i.Emoji=null;this.i.EditorFocusHandler=null}},bB:function(){_mcp.i.prototype.bB.call(this);if(this.bR){this.bR.dispose();this.bR=null}if(this.n){this.n.a(this.dC);this.n.m(this.dD);this.n.h()}this.i.EditorFocusHandler&&this.i.EditorFocusHandler.bj("focus","MailComposeDockableView")},eL:function(n,t){_mcp.i.prototype.eL.call(this,n,t);this.cN()},cx:function(n){_mcp.i.prototype.cx.call(this,n);this.cm(!0)},eG:function(n){switch(n.c()){case 7:this.cI()?this.i.OneRibbon.c.R():this.j("SendButton");break;case 14:var t=this.i.Emoji;if(t&&!t.bq()&&_zz.s.isInstanceOfType(t)&&t.i){var i=t.z.querySelectorAll("button");i&&i.length>0&&i[0].click()}break;default:_mcp.i.prototype.eG.call(this,n);break}},cN:function(){this.gx(this.bT)},cL:function(){if(this.i){var n=this.i.OneRibbon;var t=this.i.OneRibbonFiller;n&&t&&this.cI()&&n.be()}},fl:function(){this.cO||(this.cO=new _j.g(this.fg,this.I()));return this.cO},ca:function(n){_mcp.i.prototype.ca.call(this,n);this.cL()},gz:function(){if(this.bP){this.bD=!this.bD;this.n&&this.n.l(this.eU,this.i.InlineComposeBottomEdge.z);this.bv("ShowOneRibbon");this.cL();this.bD&&this.i.OneRibbon.c.R()}},gu:function(){var n=this.bD?_zz.d.c(50):"0px";this.i.OneRibbonFiller.z.style.height=n},gw:function(){if(this.i){this.dG(this.i.ToReadWriteRecipientWellView);this.dG(this.i.CcReadWriteRecipientWellView);this.dG(this.i.BccReadWriteRecipientWellView)}},gv:function(n){n.c();n.d();this.j("EditorControl")},dG:function(n){if(_j.c.isInstanceOfType(n)){var t=n.W();t&&t.H().A(!1)}},gt:function(){var n=null;var t=this.dE.a();var u=t.fI().Enabled;var f=t.fJ().Enabled;var i=t.fK().Enabled;var r=this.W();if((u||f||i)&&!r.ep().a()&&!r.Z.a()){var e=Math.floor(Math.random()*1001);e<200&&(u?n=_u.n.BM:f?n=_u.n.JD:i&&(n=_u.n.Qd))}_j.h.a(n)&&(n=_u.n.Ga);return n},fm:function(){this.bS(["HighlightEditorBorder","HoverOnEditor","HoverOnEditorTopBorder","NormalEditorTopBorder","HighlightEditorTopBorder","NormalEditorBorder"])}};_mcp.l=function(n){_mcp.l.initializeBase(this,[n])};_mcp.l.prototype={a:null,b:function(){this.a&&_rw.b.a(this.a.z)},H:function(){_j.c.prototype.H.call(this);this.a=this.C?this.C.a("FromPersona"):null}};_mcp.R=function(n,t){_mcp.R.initializeBase(this,[n]);this.j=t};_mcp.R.prototype={n:!1,j:null,i:null,m:!1,k:!1,o:null,l:null,p:function(n){if(n!==this.n){this.n=n;this.bv("ReadyToScroll")}return n},u:function(){return _mcp.d.isInstanceOfType(this.W())?this.W().cR:!1},t:function(){return _mcp.d.isInstanceOfType(this.W())?this.W().cJ:!1},q:function(){return this.u()||this.t()},r:function(){return this.j.g()},s:function(){return this.j.h()},H:function(){_j.c.prototype.H.call(this);if(this.C){this.i=this.C.a("ComposeControlId");this.i.be=this.C.a("ComposeAppsPane");this.i.bg=this.C.a("MinAppBar");if(this.m){this.o=null;this.m=!1}if(this.k){this.i.d(this.l);this.l=null;this.k=!1;this.p(!0)}}else if(this.i){this.i.be=null;this.i.bg=null;this.i=null}},G:function(){this.i.n=new _cmc.i(this.C.a("scrollRegionId"),this.C.a("TopDockPanelId"),this.C.a("bottomDockPanelId"),this.W().bA,1,this.j);this.i.n.d(this.i);_j.c.prototype.G.call(this)},M:function(){if(this.i&&this.i.n){this.i.n.c();this.i.n=null}_j.c.prototype.M.call(this)},d:function(n){if(this.i){this.i.d(n);this.p(!0)}else{this.l=n;this.k=!0}},e:function(){this.i.e()},f:function(n){if(!this.i){this.o=n;this.m=!0}},g:function(){this.i.g()},a:function(){return this.i.a()},h:function(n){this.i.h(n)},c:function(n){this.i.c(n)},b:function(){return this.i.b()}};_mcp.i=function(n,t,i,r,u,f,e,o){this.fs=Function.createDelegate(this,this.hO);this.ft=Function.createDelegate(this,this.hP);this.cU=Function.createDelegate(this,this.hy);this.fn=Function.createDelegate(this,this.gC);this.dI=Function.createDelegate(this,this.eF);this.dQ=Function.createDelegate(this,this.eG);this.dH=Function.createDelegate(this,this.gJ);this.dO=Function.createDelegate(this,this.gL);this.dJ=Function.createDelegate(this,this.gK);this.dR=Function.createDelegate(this,this.gM);this.dP=Function.createDelegate(this,this.cx);this.ev=Function.createDelegate(this,this.hI);this.ek=Function.createDelegate(this,this.hu);this.eo=Function.createDelegate(this,this.hz);this.ej=Function.createDelegate(this,this.hg);this.cv=Function.createDelegate(this,this.fK);this.eq=Function.createDelegate(this,this.hD);this.dS=Function.createDelegate(this,this.gP);this.dU=Function.createDelegate(this,this.gR);this.dT=Function.createDelegate(this,this.gQ);this.er=Function.createDelegate(this,this.hG);this.cY=Function.createDelegate(this,this.hF);this.cX=Function.createDelegate(this,this.hE);this.cW=Function.createDelegate(this,this.hC);this.cV=Function.createDelegate(this,this.hB);this.dZ=Function.createDelegate(this,this.gY);this.da=Function.createDelegate(this,this.hH);this.cR=Function.createDelegate(this,this.gZ);this.cq=Function.createDelegate(this,this.gU);this.cQ=Function.createDelegate(this,this.gW);this.el=Function.createDelegate(this,this.fJ);this.ew=Function.createDelegate(this,this.hJ);this.ee=Function.createDelegate(this,this.he);this.ex=Function.createDelegate(this,this.hK);this.cr=Function.createDelegate(this,this.hx);this.dW=Function.createDelegate(this,this.gT);this.ei=Function.createDelegate(this,this.hf);this.dV=Function.createDelegate(this,this.gS);this.en=Function.createDelegate(this,this.hw);this.em=Function.createDelegate(this,this.hv);this.ep=Function.createDelegate(this,this.hA);this.dX=Function.createDelegate(this,this.gV);this.ec=Function.createDelegate(this,this.hd);this.ea=Function.createDelegate(this,this.hb);this.eb=Function.createDelegate(this,this.hc);this.ey=Function.createDelegate(this,this.hM);this.ez=Function.createDelegate(this,this.hN);this.cn=Function.createDelegate(this,this.gF);this.dc=Function.createDelegate(this,this.hQ);this.bc=Function.createDelegate(this,this.fv);this.fo=Function.createDelegate(this,this.gG);this.fr=Function.createDelegate(this,this.gN);this.cT=Function.createDelegate(this,this.ha);this.dY=Function.createDelegate(this,this.gX);this.ed=Function.createDelegate(this,this.eL);this.fp=Function.createDelegate(this,this.dh);this.db=Function.createDelegate(this,this.hL);this.q={};_mcp.i.initializeBase(this,[n]);this.o=t;this.v=i;this.eD=r;this.bW=u;this.bi=f;this.bZ=e;this.eJ=o;if(this.bW){this.fG=this.bW.a().n().Enabled;this.fH=this.bW.a().m().Enabled}this.i={};_j.e.a(_a.a.a,"View created with layout={0}",this.o)};_mcp.i.prototype={bT:!1,v:null,eD:null,bW:null,p:null,r:null,l:null,cy:null,k:null,bs:!1,dr:!1,dm:!1,di:!1,ck:!1,cC:!1,cD:!1,bX:!1,dw:!1,cB:!1,bY:!1,dn:!1,cj:!1,dq:!1,bZ:null,bi:null,eJ:null,bH:!1,dp:!1,fG:!1,fH:!1,bV:null,dd:null,ds:null,eK:!1,s:function(){return this.i?this.i.EditorControl:null},bl:function(){var n;n=this.o==="TouchNarrow"?50:100;return n},df:function(){var t=this.o==="Mouse"||this.eE()?1:3;var i=this.W();if(i)if(i.bk())t=2;else{var n=i.Z;this.o==="Mouse"||this.eE()||n.m()&&(n.a()===1||n.a()===2||n.a()===3)&&(t=2)}return t},t:function(n){if(this.l!==n){this.hY(n,this.l);this.l=n;this.hZ()}return n},eN:function(n){if(this.dd!==n){this.dd=n;this.bi.a(_y.bE,new _y.bE(this.dd))}return n},fE:function(){return this.v.D()?"":_nbs.a.qi},gI:function(){return _y.c.a.i()||this.o==="Mouse"?!1:this.dr},dv:function(n){if(this.dr!==n){this.dr=n;this.bv("IsToRecipientWellPeoplePickerButtonShown")}return n},fD:function(){return _y.c.a.i()||this.o==="Mouse"?!1:this.dm},du:function(n){if(this.dm!==n){this.dm=n;this.bv("IsCcRecipientWellPeoplePickerButtonShown")}return n},fw:function(){return _y.c.a.i()||this.o==="Mouse"?!1:this.di},dt:function(n){if(this.di!==n){this.di=n;this.bv("IsBccRecipientWellPeoplePickerButtonShown")}return n},i:null,o:0,cw:null,fz:function(){return!0},cz:function(n){if(this.bY!==n){this.bY=n;this.bv("IsReadyToShowContent")}return n},eQ:function(n){if(this.cj!==n){this.cj=n;this.bv("IsReadyToShowEditor");this.cj&&this.eR()}return n},eP:function(n){if(this.dn!==n){this.dn=n;this.bv("IsReadyToShowAppBarContent")}return n},u:function(n){if(this.bs!==n){this.bs=n;this.bv("ShouldPreventShiftTabDefault")}return n},hR:function(n){this.dq=n;this.bv("IsTabAnchorNeeded");return n},eE:function(){return this.eD.b()},gH:function(){return!this.v.a()||this.o!=="TouchNarrow"},I:function(){return _a.a.a},ci:function(){!this.ds&&this.W()&&this.W().bJ()&&(this.ds=this.W().e());return this.ds},eO:function(n){if(this.bH!==n){this.bH=n;this.cc();this.bF()}return n},fM:function(){this.cy?this.j(this.cy):this.hS()},hS:function(){if(!this.W()){_j.e.a(_a.a.a,"No data context yet, skipping set initial focus");return}var t=this.W();if(this.hV()){_j.e.a(_a.a.a,"Queue task to set initial focus to To well.");this.eC();this.q&&this.q.ToRecipientWellControl&&this.q.ToRecipientWellControl.removeAttribute("disabled");if(this.v.a()||this.v.e()){var n=this.i.ComposeViewContent;n.K(!1)}this.j("ToRecipientWellControl")}else if(this.fP()){_j.e.a(_a.a.a,"Set initial focus to subject. ");this.j("SubjectTextBox")}else{_j.e.a(_a.a.a,"Set initial focus to body. ");this.hT()}},hV:function(){var n=this.W();return n.bb().s()<1},fP:function(){return _j.h.a(this.i.SubjectTextBox.b)},f:function(n){},d:function(n){this.dw=!this.W();if(this.dw)_j.e.a(_a.a.a,"PostTransitionIn with null DataContext.");else{var t=this.W();var i=t.bt();if(i.e()){this.cB=!!this.i.EditorControl;this.cB?this.Z()?t.bJ()&&!t.cL?t.apcl("IsReadyForViewInitialization",this.db):this.x():_j.e.a(_a.a.a,"PostTransitionIn view not active yet. "):_j.e.a(_a.a.a,"PostTransitionIn template not applied yet. ")}else this.fO(i,t.Z);this.o==="Mouse"&&t.eW()}this.bX=!0},g:function(){this.bX=!1;_j.e.a(_a.a.a,"PreTransitionOut view");var n=this.l;this.cy=n;if(n&&n in this.i)switch(n){case"FromFieldControl":case"ToRecipientWellControl":case"CcRecipientWellControl":case"BccRecipientWellControl":case"SubjectTextBox":this.eC();this.ck=!0;var t=this.q[n];if(t===document.activeElement){_j.e.a(_a.a.a,"Blur from {0}",n);t.blur()}this.l=null;this.ck=!1;break;case"EditorControl":this.ck=!0;this.i.EditorControl.dE();this.l=null;this.ck=!1;break}else _j.e.a(_a.a.a," Skip pre-transition out focus related processing for current focused control {0}, since it's not present in the controls dictionary",n)},e:function(){_j.e.a(_a.a.a,"PostTransitionOut view");this.dv(!0);this.du(!1);this.dt(!1);this.fL();this.cz(!1);this.eQ(!1);this.eP(!1)},R:function(){this.br();return!0},be:null,bg:null,a:function(){var n=this.W();return n.bd.b(5).f()},b:function(){var n=this.W();return n.bd.b(35).a()},h:function(n){var t=this.W();if(t){_cmc.j.g(n.a(),JsonParser.serialize(n))&&n.b(_cmc.j.d(n.a(),t.Z.h()));t.bc().B(_db.F.a(n))}},c:function(n){var i=this.W();if(i&&i.bc()&&i.bc().a()){var t=i.bc().a();t.Q(n.d());t.R(n.c());t.P(n.a());t.cj(n.f());t.ci(n.e());t.T(n.b());t.i().a()}},bw:function(){_j.e.a(_a.a.a,"Disposing view");this.hX();this.ia();this.bB();this.q=null;this.i=null;this.l=null;var n=this.W();if(n){var i=n.bl();if(i&&!i.c())_j.e.a(_a.a.a,"MailComposeView.InternalDispose - Skipping post-transition out processing because either the navigation component is null or IsNavigatingAwayFromCompose is false.");else{var t=n.bg();t&&!t.j()&&n.dispose()}}_j.c.prototype.bw.call(this)},H:function(){_j.c.prototype.H.call(this);var n=this.C;var t=null;this.W()&&(t=this.W());if(n){this.i.SubjectTextBox=n.a("SubjectTextBox");this.i.FromFieldControl=n.a("FromFieldControl");this.i.ToRecipientWellControl=n.a("ToRecipientWellControl");this.i.CcRecipientWellControl=n.a("CcRecipientWellControl");this.i.BccRecipientWellControl=n.a("BccRecipientWellControl");var i=n.a("EditorControl");this.i.EditorControl=i;this.i.ComposeViewContent=n.a("ComposeViewContent");this.i.CancelConfirmDialog=n.a("CancelConfirmDialog");this.i.MessageBox=n.a("MessageBox");this.i.ComposeDockPanel=n.a("ComposeDockPanel");this.i.ToRecipientButton=n.a("ToRecipientButton");this.i.CcRecipientButton=n.a("CcRecipientButton");this.i.BccRecipientButton=n.a("BccRecipientButton");this.i.ToReadWriteRecipientWellView=n.a("ToReadWriteRecipientWellView");this.i.CcReadWriteRecipientWellView=n.a("CcReadWriteRecipientWellView");this.i.BccReadWriteRecipientWellView=n.a("BccReadWriteRecipientWellView");this.i.QuotedBodyHtmlLabel=n.a("QuotedBodyHtmlLabel");this.i.AttachmentWellViewWrapper=n.a("AttachmentWellViewWrapper");this.i.OnDemandUpgradeContainer=n.a("OnDemandUpgradeContainer");i.fF=!1;if(this.o==="Mouse"){this.i.SendButton=n.a("SendButton");this.i.DiscardButton=n.a("DiscardButton");this.i.InsertButton=n.a("InsertButton");t.bk()||(this.i.AppsButton=n.a("AppsButton"));this.i.AffordanceMenuButton=n.a("AffordanceMenuButton");this.i.OpenSeperateWindowButton=n.a("OpenSeperateWindowButton");this.be=this.be||n.a("ComposeAppsPane");this.bg=this.bg||n.a("MinAppBar");this.bT=t.Z.j()==="HTML"}this.cw=new _j.g(this.fp,this.I());this.hU();if(this.bX&&!this.cB){_j.e.a(_a.a.a,"Applied template, already in view and template was not applied at PostTransitionIn, calling PostTransitionIn. ");this.d(null)}else _j.e.a(_a.a.a,"Applying template. ");this.i.EditorControl&&this.i.EditorControl.apcl("IsPlainTextContent",this.ed);this.fQ()}else{_j.e.a(_a.a.a,"Applying null template. ");this.i.SubjectTextBox=null;this.i.FromFieldControl=null;this.i.ToRecipientWellControl=null;this.i.CcRecipientWellControl=null;this.i.BccRecipientWellControl=null;this.i.EditorControl=null;this.i.CancelConfirmDialog=null;this.i.MessageBox=null;this.i.ComposeDockPanel=null;this.i.AttachmentWellViewWrapper=null;this.i.OnDemandUpgradeContainer=null}this.s()&&this.i.OnDemandUpgradeContainer&&(this.s().ez=this.i.OnDemandUpgradeContainer)},bu:function(){var t=new _b.e(this.eJ);t.j("ShowAddressBook");var r=this;t.l=new _j.g(function(){r.j("ToRecipientWellControl")},this.I());var n=new _fc.g;n.a([t]);var i=_j.i.prototype.bu.call(this);this.B(-1);return i?i.concat(n):[n]},Y:function(){_j.i.prototype.Y.call(this);if(this.W()){var t=this.W();var i=t.Z;var n=t.bt();if(n){i.apcl("IsUpgraded",this.dY);this.bT=i.j()==="HTML";if(this.dw)if(n.e()){_j.e.a(_a.a.a,"DataContext updated, PostTransitionIn with null DataContext and view model initialized, call PostTransitionIn");this.d(null)}else this.fO(n,i);n.d()||n.apcl("IsSecondInitializationComplete",this.cT);t.bb().bh(this.fr)}else t.fd||_j.e.b(_a.a.a,"MailCompseView.OnDataContextUpdated -- InitializerComponent should not be null if the state is not disposing..")}else _j.e.a(_a.a.a,"Updated DataContext to null")},G:function(){_j.c.prototype.G.call(this);if(this.bX&&this.W()&&this.cB){var t=this.W();var n=t.bt();n.e()&&this.x()}this.W()&&!this.W().bJ()&&(_fc.g.a=this)},M:function(){this.fL();this.W()&&!this.W().bJ()&&(_fc.g.a=null);_j.c.prototype.M.call(this)},bU:function(){var n=this.W();if(this.cD){_j.e.a(_a.a.a,"Events already bound. ");return}if(this.v.a()){_j.k.b(window.document.body,"mousedown",this.fo,"MailComposeView");var e=this;_j.m.a().a(_a.a.a,"RemoveBodyFocusHandler",function(){_j.k.c(window.document.body,"mousedown","MailComposeView")},1e3)}this.p=new _j.q;if(this.o==="Mouse"){this.p.c(new _mcp.i.a("DiscardButton",this.bc));this.p.c(new _mcp.i.a("InsertButton",this.bc));n.bk()||this.p.c(new _mcp.i.a("AppsButton",this.bc));this.p.c(new _mcp.i.a("AffordanceMenuButton",this.bc));this.p.c(new _mcp.i.a("OpenSeperateWindowButton",this.bc));this.p.c(new _mcp.i.a("ToRecipientButton",this.bc))}this.p.c(new _mcp.i.a("SubjectTextBox",this.bc));this.p.c(new _mcp.i.a("FromFieldControl",this.bc));this.p.c(new _mcp.i.a("ToRecipientWellControl",this.dc));this.p.c(new _mcp.i.a("CcRecipientWellControl",this.dc));this.p.c(new _mcp.i.a("BccRecipientWellControl",this.dc));this.p.c(new _mcp.i.a("AttachmentWellViewWrapper",this.bc));this.r=new _j.q;this.r.c(new _mcp.i.a("FromFieldControl",this.cn));this.r.c(new _mcp.i.a("ToRecipientWellControl",this.cn));this.r.c(new _mcp.i.a("CcRecipientWellControl",this.cn));this.r.c(new _mcp.i.a("BccRecipientWellControl",this.cn));if(n.bJ()){var t=this.ci();t.addEventListener("focus",this.ez,!0);t.addEventListener("blur",this.ey,!0);t.addEventListener("dragover",this.eb,!0);t.addEventListener("dragleave",this.ea,!0);t.addEventListener("drop",this.ec,!0)}else{for(var r=0;r<this.p.d.length;r++){var f=this.i[this.p.d[r].a];f&&_j.k.b(f.z,"focusin",this.p.d[r].c())}for(var i=0;i<this.r.d.length;i++)_j.k.b(this.i[this.r.d[i].a].z,"focusout",this.r.d[i].c())}this.fu();this.i.CancelConfirmDialog.apcl("IsHidden",this.dX);this.i.MessageBox.apcl("IsHidden",this.ep);n.bc().a()&&(this.bH=!n.bc().a().n());this.bF();n.ba.apcl("ActionPerformed",this.em);n.ba.apcl("Count",this.en);n.bc().o(this.dV);if(this.bZ.b(this.bZ.d())&&this.o==="TouchWide"){var u=n.bm().a();if(u){u.k(this.ei);u.x(this.dW)}}n.bh.apcl("IsShown",this.cr);n.bp().apcl("IsDiscardConfirmDialogShown",this.cr);n.Z.apcl("SelectedDataCallContext",this.ex);n.Z.apcl("EditorCallContext",this.ee);n.bm().apcl("RequestCloseComposeForm",this.ew);this.i.FromFieldControl.apcl("IsHidden",this.el);this.i.CcRecipientWellControl.apcl("IsHidden",this.cQ);this.i.BccRecipientWellControl.apcl("IsHidden",this.cq);this.gE();this.cD=!0},bB:function(){var n=this.W();var f=null;var e=null;if(n){e=n.bt();if(e){e.rpcl("IsInitialized",this.cR);e.rpcl("IsSecondInitializationComplete",this.cT)}else _j.e.b(_a.a.a,"MailComposeView.UnbindEvent - InitializerComponent was null.");f=n.Z;f?f.rpcl("IsUpgraded",this.dY):_j.e.b(_a.a.a,"MailComposeView.UnbindEvent - Context was null.");n.rpcl("ReadyToSetInitialFocus",this.da)}if(!this.cD){_j.e.a(_a.a.a,"Events aren't bound. ");return}if(this.i){this.i.CancelConfirmDialog&&this.i.CancelConfirmDialog.rpcl("IsHidden",this.dX);this.i.MessageBox&&this.i.MessageBox.rpcl("IsHidden",this.ep);this.cc();this.i&&this.i.BccRecipientWellControl&&this.i.BccRecipientWellControl.rpcl("IsHidden",this.cq);this.i.CcRecipientWellControl&&this.i.CcRecipientWellControl.rpcl("IsHidden",this.cQ);this.i.FromFieldControl&&this.i.FromFieldControl.rpcl("IsHidden",this.el);if(n&&n.bJ()){var t=this.ci();if(t&&!t.closed)try{t.removeEventListener("focus",this.ez,!0);t.removeEventListener("blur",this.ey,!0);t.removeEventListener("dragover",this.eb,!0);t.removeEventListener("dragleave",this.ea,!0);t.removeEventListener("drop",this.ec,!0)}catch(p){}}else{for(var o=0;o<this.p.d.length;o++)this.i[this.p.d[o].a]&&_j.k.c(this.i[this.p.d[o].a].z,"focusin");for(var i=0;i<this.r.d.length;i++)this.i[this.r.d[i].a]&&_j.k.c(this.i[this.r.d[i].a].z,"focusout")}this.i.EditorControl&&this.i.EditorControl.rpcl("IsPlainTextContent",this.ed)}if(n){_j.e.a(_a.a.a,"Unbind view events on view model. ");n.bC()&&n.bC().a()&&n.bC().a().rpcl("IsShown",this.dZ);var u=n.ca();if(u){u.rpcl("DialogViewModel",this.cV);u.a()&&u.a().rpcl("IsShown",this.cW)}var r=n.cb();if(r){r.rpcl("DialogViewModel",this.cX);r.a()&&r.a().rpcl("IsShown",this.cY)}var c=n.bb();c&&c.rpcl("IsPeoplePickerShown",this.er);var a=n.bc();if(a){a.v(this.dV);if(n.bc().a()){n.bc().a().A(this.dT);n.bc().a().cf(this.dU)}}if(this.bZ.b(this.bZ.d())&&this.o==="TouchWide"){var s=n.bm().a();if(s){s.v(this.ei);s.G(this.dW)}}var l=n.bm();l&&l.rpcl("RequestCloseComposeForm",this.ew);if(f){n.Z.rpcl("SelectedDataCallContext",this.ex);n.Z.rpcl("EditorCallContext",this.ee)}var h=n.ba;if(h){h.rpcl("ActionPerformed",this.em);h.rpcl("Count",this.en)}var y=n.bh;y&&n.bh.rpcl("IsShown",this.cr);var v=n.bp();v&&n.bp().rpcl("IsDiscardConfirmDialogShown",this.cr);n.rpcl("IsReadyForViewInitialization",this.db)}this.ib();this.cD=!1},ca:function(n){if(n===1||n===2){var i=n===1?"ComposeAppsPane":"MinAppBar";var t=this.i[i];t&&t.bq()&&this.j("ToRecipientWellControl")}this.eR();this.eM()},cx:function(n){_j.e.a(_a.a.a,"Focused in the RTE");this.l!=="EditorControl"&&this.t("EditorControl")},fv:function(n,t){var i=t.uiComponent;this.de(i)},hQ:function(n,t){this.fv(n,t);this.eH()},gF:function(n,t){_j.e.a(_a.a.a,"User blured from {0}",this.l);if(this.W()&&_mcp.d.isInstanceOfType(this.W())&&!this.ck&&!this.W().bL){var i=this.W().bb();if(this.l==="FromFieldControl"&&i&&i.n()){var o=i.n().c();_j.h.a(o)||i.M(o,!0)}var r=null;var s=!0;switch(this.l){case"ToRecipientWellControl":r=this.i.ToReadWriteRecipientWellView;break;case"CcRecipientWellControl":r=this.i.CcReadWriteRecipientWellView;break;case"BccRecipientWellControl":r=this.i.BccReadWriteRecipientWellView;break;default:s=!1;break}if(s&&r&&i&&i.m()){var e=r.W();e&&!e.fd&&e.H()&&!e.H().cp()&&i.m().g()}if(_a.cu.a){var f=this;_j.m.a().a(this.I(),"Delayed MailTips retrieval",function(){if(f.W()&&!f.bL&&!f.cb){var n=f.W().dc();n&&n.a(1)}},100)}if(_a.br.a){var u=this;_j.m.a().a(this.I(),"Delayed PolicyTips retrieval",function(){if(u.W()&&!u.bL&&!u.cb){var n=u.W().dd();n&&n.a(1)}},100)}}},br:function(){if(this.i&&this.Z()&&this.bX&&this.l&&this.W()&&!this.W().bL){_j.e.a(_a.a.a,"Restore focus to {0}",this.l);this.j(this.l)}else _j.e.a(_a.a.a,"Skip restore focus, controls={0}; Active={1}; InView={2}; Name={3}; VM={4}",this.i?"non-null":"null",this.Z(),this.bX,this.l,this.W()?"non-null":"null")},j:function(n){this.eC();switch(n){case"SubjectTextBox":case"BccRecipientWellControl":case"CcRecipientWellControl":case"ToRecipientWellControl":case"FromFieldControl":if(this.q&&this.q[n]){this.q[n].focus();this.t(n);this.eH()}break;case"EditorControl":if(this.i&&this.i[n]){var i=this.i.EditorControl;i.bg(new _cmc.G(!1));this.t(n)}break;case"ToRecipientButton":case"CcRecipientButton":case"BccRecipientButton":case"OpenSeperateWindowButton":case"SendButton":case"DiscardButton":case"AppsButton":case"AffordanceMenuButton":if(this.i&&this.m(n)){this.i[n].R();this.t(n)}break;case"AttachmentWellViewWrapper":var t=this.W().bc();if(this.i&&this.m(n)&&this.W()&&t&&t.r()>0){this.i[n].R();this.t(n)}break}},eC:function(){if(this.q&&!("SubjectTextBox"in this.q)){this.q.SubjectTextBox=this.i.SubjectTextBox.z;this.q.FromFieldControl=this.i.FromFieldControl.z.querySelector("input");this.q.ToRecipientWellControl=this.i.ToRecipientWellControl.z.querySelector("input");this.q.CcRecipientWellControl=this.i.CcRecipientWellControl.z.querySelector("input");this.q.BccRecipientWellControl=this.i.BccRecipientWellControl.z.querySelector("input")}},eL:function(n,t){this.fu();var i=this.W();this.bT=i.Z.j()==="HTML";if(!this.bT){this.fF();i.bj().a("AutoSave",null,null,!1)}this.fM()},hg:function(n){this.ca(5)},hz:function(n){this.ca(3)},gP:function(n,t){this.ca(1)},gE:function(){var i=this.W();if(this.o==="Mouse"){this.be&&this.be.apcl("IsHidden",this.dS);this.bg&&this.bg.apcl("IsHidden",this.eq);if(_y.c.a.b())if(i.bJ()){var r=this.ci();var n=_j.w.b(r);var t=this;n.b("resize",function(n){t.fK()})}else{_y.c.a.o(this.cv);this.bi.b(_a.bH,this.ej);this.bi.b(_a.cN,this.eo);_g.a.a().b().u(this.ek)}else _y.c.a.o(this.cv)}},ib:function(){var i=this.W();if(this.o==="Mouse"){this.be&&this.be.rpcl("IsHidden",this.dS);this.bg&&this.bg.rpcl("IsHidden",this.eq);if(_y.c.a.b())if(i.bJ()){var t=this.ci();var n=_j.w.b(t);n.c("resize",null)}else{_y.c.a.q(this.cv);this.bi.c(_a.bH,this.ej);this.bi.c(_a.cN,this.eo);_g.a.a().b().x(this.ek)}else _y.c.a.q(this.cv)}},gG:function(n){_j.e.a(_a.a.a,"MouseDown event on Body is being ignored to prevent hiding the keyboard.");n.c()},hU:function(){this.i.FromFieldControl.fy(this.ev)},hD:function(n,t){this.ca(2)},hK:function(n,t){var i=this.W();var u=this.l||this.cy;if(u==="SubjectTextBox"){i.Z.B().c("subject");this.i.SubjectTextBox.w(i.Z.B())}else if(u==="EditorControl"){if("EditorControl"in this.i){var r=this.i.EditorControl;if(r.bc)r.bg(i.Z.B());else if(_cmc.t.isInstanceOfType(i.Z.B()))i.Z.B().a=r.dV;else if(_cmc.z.isInstanceOfType(i.Z.B())){r.dV=i.Z.B().q;r.bg(i.Z.B())}}i.Z.B().c("body")}else i.Z.B().g(!0)},hJ:function(n,t){var r=this.W();if(r){var u=r.bd;var i=null;if(this.o==="Mouse"){var e=u.b(19);i=e.l()}else{var f=u.b(10);i=f.a()}i&&i.b&&i.a();this.o==="TouchNarrow"&&r.bm().a()&&r.bm().a().l()}},he:function(n,t){if("EditorControl"in this.i){var i=this.W();this.i.EditorControl.bg(i.Z.di())}},hX:function(){var n=this.i.FromFieldControl;var r=this.i.ToRecipientWellControl;var i=this.i.CcRecipientWellControl;var t=this.i.BccRecipientWellControl;n&&n.kJ(this.ev)},hI:function(n){if(this.i.FromFieldControl===n)for(var i=n.z.querySelectorAll("input"),t=0;t<i.length;t++)i[t].setAttribute("aria-labelledby","MailCompose.FromRecipientWellButton")},gN:function(){var n=this.i.FromFieldControl;n&&n.b()},eH:function(){var t=!0;switch(this.l){case"ToRecipientWellControl":this.dv(!0);this.du(!1);this.dt(!1);break;case"CcRecipientWellControl":this.du(!0);this.dv(!1);this.dt(!1);break;case"BccRecipientWellControl":this.dt(!0);this.du(!1);this.dv(!1);break;default:t=!1;break}if(t){var n=this.W().bb();n&&n.m()&&n.m().j()}},dh:function(){var n=!0;if(this.bs){switch(this.l){case"DiscardButton":this.j("SendButton");break;case"InsertButton":this.j("DiscardButton");n=!1;break;case"AppsButton":this.j("InsertButton");n=!1;break;case"AffordanceMenuButton":var i=this.i.AppsButton;i&&!i.bq()?this.j("AppsButton"):this.j("InsertButton");n=!1;break;case"OpenSeperateWindowButton":this.j("AffordanceMenuButton");n=!1;break;case"ToRecipientButton":var t=this.W();if(t.bb().ba()||t.ba.p.x.length)this.u(!1);else{var u=this.be;if(u.bq()){this.j("OpenSeperateWindowButton");n=!1}else this.u(!1)}break;case"ToRecipientWellControl":if(this.o==="Mouse"){this.j("ToRecipientButton");n=!1;this.u(!1)}else this.u(!1);break;case"CcRecipientWellControl":this.j("CcRecipientButton");break;case"BccRecipientWellControl":this.j("BccRecipientButton");break;case"AttachmentWellViewWrapper":this.j("SubjectTextBox");break}if(n){var r=this;_j.m.a().a(this.I(),"MailComposeView.HandleShiftTabOnRecipientWell",function(){r.u(!1)},100)}}},hZ:function(){if(this.hW()){var n=this.W();switch(this.l){case"ToRecipientWellControl":n.bb().d(1);n.bb().d(2);break;case"CcRecipientWellControl":n.bb().d(0);n.bb().d(2);break;case"BccRecipientWellControl":n.bb().d(0);n.bb().d(1);break;default:n.bb().d(0);n.bb().d(1);n.bb().d(2);break}}},hW:function(){return this.o==="Mouse"&&this.W()?!0:!1},gV:function(n,t){if(this.i.CancelConfirmDialog.bq()&&this.W()&&!this.W().bL){_j.e.a(_a.a.a,"Restore focus on hide of cancel confirm dialog.");this.br()}},hA:function(n,t){if(this.i.MessageBox.bq()){_j.e.a(_a.a.a,"Restore focus on hide of message box.");this.br()}},gZ:function(n,t){var i=this.W();if(i.bt().e()){this.dp&&i.bt().rpcl("IsInitialized",this.cR);_j.e.a(_a.a.a,"Calling PostTransitionIn on initialize of Data Context.");this.d(null)}else _j.e.a(_a.a.a,"InitializerComponent.IsInitialized = false.")},gX:function(n,t){var i=this.W();i.Z.m()&&this.bv("EditorSizingMode")},hx:function(n,t){var r=this.W();if(this.v.g()&&r){var i=!1;t==="IsShown"?i=r.bh?r.bh.p:i:t==="IsDiscardConfirmDialogShown"&&(i=r.bp()?r.bp().b():i);if(i){this.s().dE();this.s().iE()}}},ha:function(n,t){var i=this.W();i.bt().rpcl("IsSecondInitializationComplete",this.cT);this.o==="Mouse"&&i.bC()&&i.bC().a()&&i.bC().a().apcl("IsShown",this.dZ);var u=i.ca();u.a()?u.a().apcl("IsShown",this.cW):u.apcl("DialogViewModel",this.cV);var r=i.cb();r.a()?r.a().apcl("IsShown",this.cY):r.apcl("DialogViewModel",this.cX);var f=i.bb();f&&f.apcl("IsPeoplePickerShown",this.er)},gY:function(n,t){var i=this.W();if(!i.bC().a().q()){var u=i.ca();var r=i.cb();var f=this;_j.m.a().a(this.I(),"MailComposeView.OnContextMenuShownChanged",function(){var e=!u.a()||!u.a().p;var t=!r.a()||!r.a().p;var n=!i.bh||!i.bh.p;if(e&&n&&t){_j.e.a(_a.a.a,"Restore focus on hide of context menu");f.br()}},100)}},hB:function(n,t){var r=this.W();var i=r.ca();i.rpcl("DialogViewModel",this.cV);i.a().apcl("IsShown",this.cW)},hC:function(n,t){var r=this.W();var i=this;_j.m.a().a(this.I(),"MailComposeView.OnMessageOptionsShownChanged",function(){if(!r.ca().a().p){_j.e.a(_a.a.a,"Restore focus on hide of message options dialog");i.br()}},100)},hE:function(n,t){var r=this.W();var i=r.cb();i.rpcl("DialogViewModel",this.cX);i.a().apcl("IsShown",this.cY)},hF:function(n,t){var r=this.W();var i=this;_j.m.a().a(this.I(),"MailComposeView.OnOmeOptionsShownChanged",function(){if(!r.cb().a().p){_j.e.a(_a.a.a,"Restore focus on hide of ome options dialog");i.br()}},100)},hG:function(n,t){var i=this.W();if(!i.bb().bb()){_j.e.a(_a.a.a,"Restore focus on hide of people picker");this.br()}},hv:function(n,t){this.br()},hw:function(n,t){this.fQ();this.eR()},fQ:function(){var a=this.C.a("InfoBarControl");if(a){var i=this.W();if(i.ba&&i.ba.p&&i.ba.p.x.length>0){for(var l=new _y.cv,o=_nbs.a.IN+". ",n,f=0;f<i.ba.p.x.length;f++){n="";var t=i.ba.p.x[f];if(_db.x.isInstanceOfType(t)){var h=t;h&&(n=h.g)}else if(_db.D.isInstanceOfType(t)){var e=t;e&&(n=e.g)}else if(_db.B.isInstanceOfType(t)){var u=t;if(u&&_y.fV.isInstanceOfType(u.g)){var r=u.g;r&&r.a()&&(n=r.a())}}if(n===""){var s=t;s&&(n=l.a(s.d,null))}o+=n+". "}var c=this.C.a("InfoBarControl").z;c.setAttribute("aria-label",o)}}},gS:function(n){n.a().v(this.dT);n.a().bB(this.dU);this.eO(!n.a().n())},gR:function(n){this.eO(!n.n());this.s().ha=_j.k.g(this.i.AttachmentWellViewWrapper.z)},gQ:function(n){if(n.bN()){n.ck(!1);this.t("EditorControl")}this.eO(!n.n());this.br()},fO:function(n,t){if(this.dp)_j.e.a(_a.a.a,"PostTransitionIn before DataContext was initialized. DataContext initialization handler is already setup. ");else{_j.e.a(_a.a.a,"PostTransitionIn before DataContext was initialized. Adding handler to call PostTransitionIn after DataContext is initialized. ");n.apcl("IsInitialized",this.cR);this.dp=!0}},gD:function(){if(!this.cC){var t=this.W();if("EditorControl"in this.i&&this.i.EditorControl){var n=this.i.EditorControl;n.eC(this.dP);n.cn(this.dR);n.hv(this.dJ);n.fH(this.dO);n.b(this.dH);n.dD(this.dQ);n.iz(this.dI);var f=t.bc();f&&f.y(n);var e=t.dC();e&&e.j(n);var o=t.em();o&&o.b(n);var i=t.bH();i&&i.g(n);var r=this.W().dy();r&&r.b(n)}if(this.v.b()){var u=this.C.a("TabAnchor");u&&_j.k.b(u.z,"focusin",this.fn)}this.cC=!0}},eF:function(n){},ia:function(){if(this.cC){if("EditorControl"in this.i&&this.i.EditorControl){var n=this.i.EditorControl;n.eK(this.dP);n.ck(this.dR);n.hM(this.dJ);n.fY(this.dO);n.e(this.dH);n.dv(this.dQ);n.jl(this.dI)}if(this.v.b()){var t=this.C.a("TabAnchor");t&&_j.k.c(t.z,"focusin")}this.cC=!1}},gC:function(n){this.j("EditorControl");n.c()},dg:function(n){_j.h.a(this.k)||this.j(this.k);n.a(!0)},bF:function(){this.k=null;this.bH&&(this.k="AttachmentWellViewWrapper");var n=this.W();n.Z.bu()||_j.h.a(this.k)&&this.m("SubjectTextBox")&&(this.k="SubjectTextBox");_j.h.a(this.k)&&this.m("BccRecipientWellControl")&&(this.k="BccRecipientWellControl");if(_j.h.a(this.k)&&this.m("CcRecipientWellControl")){this.k="CcRecipientWellControl";this.i.BccRecipientWellControl.rpcl("IsHidden",this.cq);this.i.BccRecipientWellControl.apcl("IsHidden",this.cq)}_j.h.a(this.k)&&this.m("ToRecipientWellControl")&&(this.k="ToRecipientWellControl");!_j.h.a(this.k)&&this.i&&this.i[this.k]&&_j.k.b(this.i[this.k].z,"keydown",this.cU)},cc:function(){!_j.h.a(this.k)&&this.i&&this.i[this.k]&&_j.k.c(this.i[this.k].z,"keydown")},m:function(n){if(!this.i)return!1;var t=this.i[n];return!!t&&!t.bq()},gU:function(n,t){this.m("BccRecipientWellControl")&&this.l&&this.j("BccRecipientWellControl");this.cc();this.bF()},gW:function(n,t){this.i.CcRecipientWellControl.rpcl("IsHidden",this.cQ);this.m("CcRecipientWellControl")&&this.l&&this.j("CcRecipientWellControl");this.cc();this.bF()},fJ:function(n,t){},gM:function(n){var t=this.W();if(t){t.Z.em(n.f());t.Z.dQ(n.e());t.Z.dZ(n.c())}},gK:function(n){var i=this.W();if(i){var t=i.bc().a().bj();t.b(n.c());t.a(n.c())}},gL:function(n){var t=this.W();if(t){var i=t.bc().a();i.W(n.c())}},gJ:function(n){this.fF()},eG:function(n){var i=this.W();if(i){var f=i.bd;switch(n.c()){case 1:var s=i.bg();var u=s.a();u&&u.b&&u.a();break;case 2:this.bi&&this.bi.a(_y.eN,new _y.eN);break;case 3:var r=i.bj().d();r&&r.b&&r.a();break;case 4:var t=null;if(this.o==="Mouse"){var o=f.b(19);t=o.a()}else{var e=f.b(10);t=e.a()}t&&t.b&&t.a();break;case 5:this.j("ToRecipientWellControl");break;case 8:this.dg(n);break}}},eR:function(){var t=this.W();if(this.i&&t){var n;n=this.i.EditorControl;n&&n.bc&&t.cK&&this.bY&&this.cj&&n.eb()}},fL:function(){if(this.i&&this.i.EditorControl){var n=this.i.EditorControl;n.bc&&n.bg(new _cmc.k(!1))}},fF:function(){var t=this.W();if(this.bT&&this.i&&this.i.EditorControl){var n=this.i.EditorControl;if(n.bc&&!n.cj()){n.bg(new _cmc.bB);t.Z.cU(n.bJ.b)}}else t.Z.cU(0)},hu:function(n,t){},fK:function(){this.ca(0)},eM:function(){if(this.i){var i=this.i.ToReadWriteRecipientWellView;var t=this.i.CcReadWriteRecipientWellView;var n=this.i.BccReadWriteRecipientWellView;this.eS(i);this.eS(t);this.eS(n)}},eS:function(n){if(n&&_rw.d.isInstanceOfType(n.W())){var t=n.W();t.bL(!0);t.bL(!1)}},hf:function(){var n=this.i.QuotedBodyHtmlLabel;if(n){this.i.QuotedBodyHtmlLabel.bd("touchstart",this.ft,"MailComposeView");this.i.QuotedBodyHtmlLabel.bd("touchend",this.fs,"MailComposeView")}},gT:function(){var n=this.i.QuotedBodyHtmlLabel;if(n){this.i.QuotedBodyHtmlLabel.bj("touchstart","MailComposeView");this.i.QuotedBodyHtmlLabel.bj("touchend","MailComposeView")}},hO:function(n){if(n.b().tagName==="A"){var t=n.b().getAttribute("href");this.bZ.d().a(t);n.d();n.c()}},hP:function(n){if(n.b().tagName==="A"){n.d();n.c()}},x:function(){var n=this.W();try{var i=this.i.EditorControl;this.v.g()&&this.i&&this.i.SubjectTextBox&&_zz.F.c(this.i.SubjectTextBox.z,null);this.gD();this.o==="TouchNarrow"?this.eP(!1):this.eP(!0);this.s().eL(this);this.s().kW(this);this.s().kX(n.dy());this.cz(!0);this.eQ(!0);_j.e.a(_a.a.a,"PostTransitionIn active view. ");n.Z.bH()||this.fN()||this.W().apcl("ReadyToSetInitialFocus",this.da);this.bU()}catch(t){n&&n.bt()&&n.bt().a("MailComposeViewInitializeException",null,t.message);_j.e.c(this.I(),"MailComposeView.InitializeView exception: {0}",t.message);throw t;}},hL:function(n,t){var i=n;i.rpcl("IsReadyForViewInitialization",this.db);this.x()},hT:function(){if(this.i&&this.i.EditorControl){var n=this.i.EditorControl;n.bg(new _cmc.G(!0));this.t("EditorControl")}},hN:function(n){if(Node.isInstanceOfType(n.target))for(var i=0;i<this.p.d.length;i++){var r=this.p.d[i];var t=this.i[r.a];if(t&&(n.target===t.z||t.z.contains(n.target))){this.de(r.a);this.eH();break}}return!0},hM:function(n){if(Node.isInstanceOfType(n.target))for(var t=0;t<this.r.d.length;t++){var r=this.r.d[t];var i=this.i[r.a];if(n.target===i.z||i.z.contains(n.target)){r.b(null,null);break}}return!0},hc:function(n){_b.r.b(n);var t=n.dataTransfer.types;this.eN(t);this.bV&&(this.bV=_j.m.a().b(this.bV));return!1},hb:function(n){if(!this.bV){var t=this;this.bV=_j.m.a().a(_a.a.g,"OnDragLeave",function(){t.eN(null);t.bV=null},50)}return!0},hd:function(n){_b.r.b(n);this.eN(null);return!1},fI:function(n){return n==="ToRecipientWellControl"||n==="BccRecipientWellControl"||n==="CcRecipientWellControl"},gO:function(){return!!this.bW&&this.bW.a().gD().Enabled},hY:function(n,t){if(this.gO()&&!this.fI(n)&&this.fI(t)){var i=this;_j.m.a().a(this.I(),"Delayed PeopleRecommendations recipients retrieval",function(){if(i.W()){var t=i.W();if(t&&!t.fd){var n=i.W().el();n&&n.b(1)}}},100)}},de:function(n){_j.e.a(_a.a.a,"Focused in {0}",n);this.t(n);this.u(n==="CcRecipientWellControl"||n==="BccRecipientWellControl"||n==="ToRecipientWellControl"||n==="ToRecipientButton"||n==="OpenSeperateWindowButton"||n==="AffordanceMenuButton"||n==="InsertButton"||n==="DiscardButton"||n==="AppsButton");if(this.W()&&_mcp.d.isInstanceOfType(this.W())){var i=this.W();if(this.l==="FromFieldControl"){var t=i.bb();t&&t.K(!1)}}},fu:function(){var n=this.W();n&&this.hR(this.v.b()&&n.Z.j()==="Text"?!0:!1)},hy:function(n){var t=n.a();if(t===9&&!n.o()&&this.k!=="AttachmentWellViewWrapper"&&(this.k!=="SubjectTextBox"||!this.i.SubjectTextBox.q)){this.j("EditorControl");this.hk(n)}},hH:function(n,t){this.fN()},fN:function(){var n=this.W();if(n&&!this.eK&&(n.cQ||!(this.o==="Mouse"))){this.eK=!0;this.fM();n.rpcl("ReadyToSetInitialFocus",this.da);return!0}return!1}};_mcp.i.a=function(n,t){this.a=n;this.b=t};_mcp.i.a.prototype={a:null,b:null,c:function(){var n=this;return function(t){n.b(t,{uiComponent:n.a})}}};_mcp.bc=function(n){this.h=Function.createDelegate(this,this.p);this.g=Function.createDelegate(this,this.o);this.b={};_mcp.bc.initializeBase(this,[n])};_mcp.bc.prototype={c:null,a:null,d:null,e:function(){this.b.UpconvertButton.R();this.c="UpconvertButton";_mcp.n.isInstanceOfType(this.a)&&(this.a.bJ=!0)},H:function(){_j.c.prototype.H.call(this);this.b.ShowCcButton=this.C.a("ShowCcButton");this.b.ShowBccButton=this.C.a("ShowBccButton");this.b.UpconvertButton=this.C.a("UpconvertButton")},dK:function(){_j.i.prototype.dK.call(this);this.q()},M:function(){this.i();_j.c.prototype.M.call(this)},bw:function(){this.i();_j.c.prototype.bw.call(this)},j:function(n){if(this.b[n]){this.b[n].R();this.c=n}},q:function(){this.d=this.X;this.a=this.d.X;_mcp.l.isInstanceOfType(this.a)&&(this.a=this.a.X);_mcp.n.isInstanceOfType(this.a)&&this.a.ik(this);_j.k.b(this.d.z,"focusout",this.g);_j.k.b(this.d.z,"keydown",this.h)},f:function(n){var t=this.b?this.b[n]:null;return!!t&&!t.bq()},p:function(n){var t=n.a();if(t===9&&n.g())if(this.b.UpconvertButton.hm()){this.c="UpconvertButton";this.n()}else if(this.b.ShowBccButton.hm()){this.c="ShowBccButton";this.k()}else if(this.b.ShowCcButton.hm()){this.c="ShowCcButton";this.l()}},n:function(){if(this.f("ShowBccButton")){this.j("ShowBccButton");_mcp.n.isInstanceOfType(this.a)&&(this.a.bJ=!0)}else this.f("ShowCcButton")&&this.k()},k:function(){if(this.f("ShowCcButton")){this.j("ShowCcButton");_mcp.n.isInstanceOfType(this.a)&&(this.a.bJ=!0)}else this.l()},l:function(){this.c=null;if(_mcp.n.isInstanceOfType(this.a)){this.a.il();this.a.bJ=!1}},i:function(){this.m();_j.k.c(this.d.z,"focusout");_j.k.c(this.d.z,"keydown")},o:function(n){this.m()},m:function(){this.c=null;_mcp.n.isInstanceOfType(this.a)&&(this.a.bJ=!1)}};_mcp.n=function(n,t,i,r,u,f,e,o){this.fS=Function.createDelegate(this,this.ih);this.fT=Function.createDelegate(this,this.ii);this.eT=Function.createDelegate(this,this.ig);this.fR=Function.createDelegate(this,this.ie);this.fU=Function.createDelegate(this,this.ij);_mcp.n.initializeBase(this,[n,t,i,r,u,f,e,o])};_mcp.n.prototype={dB:!1,ce:null,bJ:!1,ik:function(n){n&&(this.ce=n)},il:function(){if(this.m("FromFieldControl"))this.j("FromFieldControl");else{this.dB=!0;this.j("ToRecipientWellControl")}},ic:function(){return this.W()&&this.W().dE()?null:"MailInlineComposeView.Mouse.EmojiViewInToolbar"},id:function(){return!this.w()&&!!this.W()&&!this.W().Z.bj()},H:function(){_mcp.ch.prototype.H.call(this);if(this.C){this.i.InsertPictureButton=this.C.a("InsertPictureButton");this.i.FormatButton=this.C.a("FormatButton");this.i.InsertAvailableTime=this.C.a("InsertAvailableTime");this.i.ShowOriginalMessage=this.C.a("ShowOriginalMessage");this.i.AggregatedReadOnlyHeader=this.C.a("AggregatedReadOnlyHeader");this.i.ReadWriteHeader=this.C.a("ReadWriteHeader");this.i.ComposeBodyContainer=this.C.a("ComposeBodyContainer")}else{this.i.InsertPictureButton=null;this.i.FormatButton=null;this.i.InsertAvailableTime=null;this.i.Emoji=null;this.i.ShowOriginalMessage=null;this.i.AggregatedReadOnlyHeader=null;this.i.ReadWriteHeader=null;this.i.ComposeBodyContainer=null}},x:function(){_mcp.D.isInstanceOfType(this.W())&&(this.n=this.W().i);_mcp.ch.prototype.x.call(this)},ie:function(n){this.cl(!1);this.j("ToRecipientWellControl")},cl:function(n){if(this.W()&&_mcp.d.isInstanceOfType(this.W())){var t=this.W();t.bi().a("ShowFullRecipient");this.cm(n);t.bb()&&t.bb().L(n)}},j:function(n){if(this.i)switch(n){case"Emoji":if(this.i[n]){this.i[n].R();this.t(n)}break;case"FormatButton":case"InsertPictureButton":case"ShowOriginalMessage":case"InsertAvailableTime":if(this.m(n)){this.i[n].R();this.t(n)}break;case"EditorControl":var t=this.i.EditorControl;this.bf.b()&&t.cE()||t.bg(new _cmc.G(!1));this.t(n);break;default:_mcp.i.prototype.j.call(this,n);break}},cx:function(n){_mcp.ch.prototype.cx.call(this,n);this.w()&&this.cE.a(IMailInlineComposeFocusEvent,new _mcp.bg)},bF:function(){this.k=null;this.bH&&(this.k="AttachmentWellViewWrapper");for(var t=this.w()?["BccRecipientWellControl","CcRecipientWellControl","ToRecipientWellControl"]:["SubjectTextBox","BccRecipientWellControl","CcRecipientWellControl","ToRecipientWellControl"],n=0;!this.k&&n<t.length;n++)this.m(t[n])&&(this.k=t[n]);!_j.h.a(this.k)&&this.m(this.k)&&_j.k.b(this.i[this.k].z,"keydown",this.cU)},cc:function(){!_j.h.a(this.k)&&this.i&&this.i[this.k]&&_j.k.c(this.i[this.k].z,"keydown")},dh:function(){this.bs&&(this.w()?this.fV():_mcp.i.prototype.dh.call(this))},dg:function(n){if(!_j.h.a(this.k)){this.bH||this.cl(!1);this.j(this.k);this.k!=="ToRecipientWellControl"||this.m("FromFieldControl")||this.ce.e()}n.a(!0)},de:function(n){_j.e.a(_a.a.a,"Focused in {0}",n);this.t(n);var t=n==="CcRecipientWellControl"||n==="CcRecipientButton"||n==="BccRecipientWellControl"||n==="BccRecipientButton"||n==="ToRecipientWellControl"||n==="ToRecipientButton"||n==="FromFieldControl";this.u(t||n==="AttachmentWellViewWrapper");this.cm(!t&&n!=="SubjectTextBox");t&&this.cE.a(IMailInlineComposeFocusEvent,new _mcp.bg);if(this.W()&&_mcp.d.isInstanceOfType(this.W())){var r=this.W();if(this.l==="FromFieldControl"){var i=r.bb();i&&i.K(!1)}}},bU:function(){_mcp.i.prototype.bU.call(this);var i=this.i.ShowOriginalMessage;i&&_j.k.b(i.z,"keydown",this.fU);var t=this.i.AggregatedReadOnlyHeader;if(t){_j.k.b(t.z,"click",this.fR);t.apcl("IsHidden",this.eT)}var n=this.i.ComposeBodyContainer;if(n){_j.k.b(n.z,"mouseover",this.fT);_j.k.b(n.z,"mouseout",this.fS)}},bB:function(){_mcp.ch.prototype.bB.call(this);var i=this.i.ShowOriginalMessage;i&&_j.k.c(i.z,"keydown");var t=this.i.AggregatedReadOnlyHeader;if(t){_j.k.c(t.z,"click");t.rpcl("IsHidden",this.eT)}var n=this.i.ComposeBodyContainer;if(n){_j.k.c(n.z,"mouseover");_j.k.c(n.z,"mouseout")}},fJ:function(n,t){this.cc();this.bF();this.cl(!1)},cN:function(){_mcp.ch.prototype.cN.call(this);this.im(!this.bP)},im:function(n){this.m("FormatButton")&&this.i.FormatButton.fd(n);this.m("InsertPictureButton")&&this.i.InsertPictureButton.fd(n);this.m("Emoji")&&this.i.Emoji.fd(n);this.m("InsertAvailableTime")&&this.i.InsertAvailableTime.fd(n)},ij:function(n){var t=n.a();if(t===9&&!n.o()){this.j("SendButton");this.hk(n)}},fV:function(){if(!this.bJ)switch(this.l){case"BccRecipientWellControl":this.j("BccRecipientButton");break;case"BccRecipientButton":this.m("CcRecipientWellControl")?this.j("CcRecipientWellControl"):this.m("FromFieldControl")?this.j("ToRecipientWellControl"):this.ce.e();break;case"CcRecipientWellControl":this.j("CcRecipientButton");break;case"CcRecipientButton":this.m("FromFieldControl")?this.j("ToRecipientWellControl"):this.ce.e();break;case"ToRecipientWellControl":this.dB?this.dB=!1:this.j("ToRecipientButton");break;case"ToRecipientButton":this.m("FromFieldControl")?this.ce.e():this.u(!1);break;case"FromFieldControl":this.bJ||this.u(!1);break;case"ShowOriginalMessage":this.j("EditorControl");break;case"SendButton":this.j("ShowOriginalMessage");break;case"AttachmentWellViewWrapper":this.cl(!1);this.m("FromFieldControl")?this.j("ToRecipientWellControl"):this.ce.e();break;default:this.u(!1);break}},ih:function(n){this.cM(!1)},ii:function(n){this.cM(!0)},ig:function(n,t){this.eM()}};_mcp.a=function(){};_mcp.a.$$cctor=function(){_mcp.a._I()};_mcp.a.eI=function(){var n=window.document.createElement("DIV");n.innerHTML="<div> <span></span> </div><div> <div class='ms-font-weight-regular ms-font-color-neutralSecondaryAlt InfobarImmediateTextContainer'> <span class='_mcp_2'></span> <a class='_mcp_3 ms-font-weight-regular ms-font-color-themeDark ms-font-s'></a> <span class='ms-font-weight-regular ms-font-color-themeDark ms-font-s'></span> <a class='_mcp_3 ms-font-weight-regular ms-font-color-themeDark ms-font-s'></a> </div> </div><div> <span class='_mcp_4'></span> <span class='_mcp_4'></span> </div><div> <div class='_mcp_t ms-font-weight-regular ms-font-color-neutralDark'></div> </div><div> <button type='button' class='_mcp_g'></button> <div class='_mcp_v'></div> <div class='_mcp_e'></div> <div class='_mcp_e'></div> </div><div> <span class='_mcp_k ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_s'> <span class='_mcp_l ms-font-weight-regular ms-font-color-black'></span> <button type='button' class='_mcp_x ms-font-m'></button> </div> </div><div> <span class='_mcp_r'></span> <span class='_mcp_r'></span> </div><div> <span class='_mcp_r'></span> </div><div> <span class='_mcp_k ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_s'> <span class='_mcp_o _mcp_p _mcp_q ms-font-weight-regular ms-font-color-neutralSecondary'></span> <div></div> </div> </div><div> <span class='_mcp_k ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_s'> <span class='_mcp_q ms-font-weight-regular ms-font-color-neutralSecondary'></span> </div> </div><div> <span class='_mcp_k ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_s'> <div class='_mcp_9'></div> </div> </div><div> <button autoid=\"_mcp_5\" type='button'></button> <div></div> </div><div> <div class='_mcp_X _mcp_Y'></div> </div><div> <span class='_mcp_i ms-font-weight-semibold ms-font-color-black'></span> <span class='_mcp_h'></span> </div><div> <div class='_mcp_G'></div>  <div class='ms-bg-color-themePrimary'></div> <div class='_mcp_I'> <div class='_mcp_J ms-font-weight-regular ms-font-color-neutralPrimary'></div> <div>  <div class='_mcp_P'></div> <div class='_mcp_N'> <div class='_mcp_c'> <div class='_mcp_7 _mcp_O _mcp_d ms-border-color-neutralTertiary ms-bg-color-white'></div> </div> <div class='_mcp_7 _mcp_S _mcp_d ms-border-color-neutralTertiary ms-bg-color-white'> <button type='button' class='_mcp_j ms-font-weight-regular ms-font-color-black _mcp_F'></button> <div> <div class='_mcp_E'> <button type='button'></button> </div> <div autoid=\"_mcp_0\" class='_mcp_a _mcp_y'></div> </div> <div> <div class='_mcp_a _mcp_y'></div> </div> </div> <div class='_mcp_7 _mcp_S _mcp_d ms-border-color-neutralTertiary ms-bg-color-white'> <button type='button' class='_mcp_j ms-font-weight-regular ms-font-color-black _mcp_F'></button> <div> <div class='_mcp_E'> <button type='button'></button> </div> <div autoid=\"_mcp_1\" class='_mcp_a _mcp_y'></div> </div> <div> <div class='_mcp_a _mcp_y'></div> </div> </div> <div class='_mcp_7 _mcp_S _mcp_d ms-border-color-neutralTertiary ms-bg-color-white'> <button type='button' class='_mcp_j ms-font-weight-regular ms-font-color-black _mcp_F'></button> <div> <div class='_mcp_E'> <button type='button'></button> </div> <div autoid=\"_mcp_2\" class='_mcp_a _mcp_y'></div> </div> <div> <div class='_mcp_a _mcp_y'></div> </div> </div> <div class='_mcp_7 _mcp_b _mcp_d ms-border-color-neutralTertiary ms-bg-color-white'> <div class='_mcp_s'> <button type='button' class='_mcp_x _mcp_n'></button> <span class='_mcp_x _mcp_m'></span> <span class='_mcp_x _mcp_m'></span> <span class='_mcp_x _mcp_m'></span> <button type='button' class='_mcp_x ms-font-xl'></button> <div class='_mcp_y'> <input autoid=\"_mcp_3\" class='_mcp_t _mcp_u ms-font-weight-regular ms-font-color-neutralSecondary'/> </div> </div> </div> <div> <div class='_mcp_8 ms-bg-color-white'></div> <div class='_mcp_8 ms-bg-color-white'></div> <div class='_mcp_8 ms-bg-color-white'></div> <div class='_mcp_8 ms-bg-color-white'></div> </div> <div> <div class='_mcp_7 ms-bg-color-white'> <div></div> </div> </div> <span></span> </div> <div class='_mcp_N ms-bg-color-white'> <div autoid=\"_mcp_4\" class='_mcp_z'></div> <div class='_mcp_K ms-border-color-neutralTertiary'></div> </div> <div class='_mcp_N ms-bg-color-white'> <span class='_mcp_B ms-font-weight-regular'></span> </div> </div> </div> <div></div> <div></div> <div></div> <div></div> <div></div> <div></div> <div class='_mcp_H'></div>  </div><div> <iframe autoid=\"_mcp_6\" class='_mcp_11'></iframe> </div><div> <div class='_mcp_21'> <button type='button' class='_mcp_31 _mcp_01 ms-font-weight-regular'></button> <span></span> </div> </div><div> <span class='_mcp_r2'></span> </div><div> <span class='_mcp_s2'></span> </div><div>  <span></span> </div><div> <div class='_mcp_I1 ms-font-weight-regular ms-bg-color-white-hover ms-font-color-neutralSecondaryAlt'></div> </div><div> <button autoid=\"_mcp_7\" type='button' class='ms-font-weight-semibold ms-font-s _mcp_v1'></button> <div class='_mcp_L1'></div> <div class='_mcp_s1'></div> <div class='_mcp_s1'></div> <div></div> </div><div> <span class='_mcp_z1 ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_D1'> <span autoid=\"_mcp_d\" class='_mcp_A1 ms-font-weight-regular ms-font-color-black'></span> </div> </div><div> <span class='_mcp_S1 _mcp_p2'></span> <span class='_mcp_S1 _mcp_p2'></span> </div><div> <span class='_mcp_S1 _mcp_p2'></span> </div><div> <span class='_mcp_z1 ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_D1'> <div> <span class='_mcp_S1 _mcp_R1 ms-font-weight-regular ms-font-color-neutralSecondary _mcp_T1'></span> <div></div> </div> </div> </div><div> <span class='_mcp_z1 ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_D1'> <span autoid=\"_mcp_e\" class='_mcp_R1 ms-font-weight-regular ms-font-color-neutralPrimary'></span> </div> </div><div> <span class='_mcp_z1 ms-font-weight-semibold ms-font-color-black _mcp_B1'></span> <div class='_mcp_D1'> <div class='_mcp_k1'></div> </div> </div><div> <div></div> <div></div> </div><div> <span class='_mcp_x1 ms-font-weight-regular'></span> <span class='_mcp_w1'></span> </div><div>  <div autoid=\"_mcp_m\"></div> </div><div> <div class='_mcp_m2'></div> <button type='button' class='ms-font-s ms-font-weight-regular _mcp_e1'></button> <button type='button' class='ms-font-s ms-font-weight-regular _mcp_e1'></button> <button type='button' class='_mcp_e1 ms-border-color-neutralTertiary _mcp_f1'></button> </div><div> <div class='_mcp_d1'></div> </div><div> <span class='_mcp_e1'></span> <span autoid=\"_mcp_p\" class='_mcp_e1'></span> <span autoid=\"_mcp_q\" class='_mcp_e1'></span> <span class='_mcp_e1'></span> </div><div> <span></span> <span class='_mcp_v2'></span> </div><div> <div class='_mcp_51 ms-border-color-neutralLight'> <div> <div class='_mcp_q2'></div> <div class='_mcp_q2'></div> </div> <div class='_mcp_61 ms-bg-color-white'> <div class='_mcp_c1 ms-font-weight-regular'></div> <div> <div class='_mcp_71'> <div class='ms-bg-color-white customScrollBar'>  <div class='_mcp_l1'> <div></div>  </div>  <div> <div class='_mcp_g1 _mcp_i1 _mcp_o1'></div> <div class='_mcp_g1'> <button autoid=\"_mcp_8\" type='button' class='_mcp_y1 ms-font-weight-semibold ms-font-s _mcp_32'></button> <div class='_mcp_D1 _mcp_E1'>  <div autoid=\"_mcp_9\" class='_mcp_12'></div> </div> <div class='_mcp_D1 _mcp_E1 _mcp_F1'> <div class='_mcp_12'></div> </div> <div></div>  </div> <div class='_mcp_g1 _mcp_p1'> <button type='button' class='_mcp_y1 ms-font-weight-semibold ms-font-s _mcp_32'></button> <div class='_mcp_D1 _mcp_E1'>  <div autoid=\"_mcp_a\" class='_mcp_12'></div> </div> <div class='_mcp_D1 _mcp_F1'> <div class='_mcp_12'></div> </div>  </div> <div class='_mcp_g1 _mcp_p1'> <button type='button' class='_mcp_y1 ms-font-weight-semibold ms-font-s _mcp_32'></button> <div class='_mcp_D1 _mcp_E1'>  <div autoid=\"_mcp_b\" class='_mcp_12'></div> </div> <div class='_mcp_D1 _mcp_F1'> <div class='_mcp_12'></div> </div>  </div> <div class='_mcp_g1'> <span class='_mcp_y1 ms-font-weight-semibold ms-font-color-black _mcp_C1 '></span> <span class='_mcp_y1 ms-font-weight-semibold ms-font-color-black _mcp_C1 '></span> </div> <div class='_mcp_g1 _mcp_j1 _mcp_p1 ms-border-color-neutralTertiaryAlt'> <div class='_mcp_n2'></div>  <div class='_mcp_12'> <input autoid=\"_mcp_c\" class='_mcp_I1 _mcp_J1 ms-font-weight-regular ms-bg-color-white-hover ms-font-color-neutralPrimary'/> </div> </div> <div class='_mcp_o2 _mcp_p1 ms-border-color-neutralTertiaryAlt'> <div class='_mcp_n1'></div> <div class='_mcp_n1'></div> <div class='_mcp_n1'></div> <div class='_mcp_n1'></div> </div> </div> </div> <div class='_mcp_o1'></div> </div> <span></span> <span></span> <div class='_mcp_r1'>  <div>  <div class='_mcp_N1 ms-font-weight-regular ms-font-color-neutralPrimary _mcp_O1 ms-border-color-neutralLight'></div> </div> <div></div> <div class='_mcp_U1'> <div></div> </div> <div class='_mcp_92'> <button autoid=\"_mcp_f\" type='button' class='ms-font-s ms-font-weight-regular'></button> <div></div> </div> <div class='_mcp_a2'></div> </div> </div>  <div class='_mcp_81 _mcp_p1 ms-bg-color-white'> <div class='_mcp_c2 ms-border-color-neutralTertiaryAlt'> <div class='_mcp_e2'></div> <div class='_mcp_d2'></div> <div class='_mcp_f2'></div> </div>  <div class='_mcp_a1'>  <button autoid=\"_mcp_g\" type='button' class='_mcp_Z1'></button> <button type='button' class='_mcp_Z1'></button> <button autoid=\"_mcp_h\" type='button' class='_mcp_Z1'></button> <button autoid=\"_mcp_i\" type='button' class='_mcp_02'></button> <button type='button' class='_mcp_02 _mcp_t2'></button> <button type='button' class='_mcp_02 _mcp_h2'></button> <div></div> <button type='button' class='_mcp_02'></button> <button type='button' class='_mcp_02 _mcp_h2'></button> <button type='button' class='_mcp_02'></button> <button autoid=\"_mcp_j\" type='button' class='_mcp_02'></button> <button autoid=\"_mcp_k\" type='button' class='_mcp_02'></button>  <span class='_mcp_j2 ms-font-weight-semilight ms-font-color-neutralSecondary'></span>  <div class='_mcp_k2'></div> </div> <div class='_mcp_b1 ms-font-weight-regular ms-font-color-neutralSecondary'></div> </div> </div> </div> <div></div> <div class='_mcp_22 ms-bg-color-white'></div> <div autoid=\"_mcp_l\"></div> <div></div> <div></div> <div></div> <div></div>   <div autoid=\"_mcp_n\"></div> <div autoid=\"_mcp_o\"></div>    </div><div> <span class='_mcp_w2 _mcp_x2 ms-font-weight-regular ms-font-color-neutralPrimary'></span> <div class='_mcp_z2'></div> </div><div> <span class='_mcp_C2'></span> <span class='_mcp_C2'></span> <button type='button' class='ms-font-s ms-font-weight-regular ms-font-color-neutralPrimary _mcp_C2 _mcp_D2'></button> </div><div> <div class='ms-font-color-neutralSecondary ms-font-s _mcp_y2'> <div class='_mcp_z2'></div> <div class='_mcp_A2'></div> </div> </div><div> <div class='_mcp_N2'></div> <span class='_mcp_O2'></span> <div class='_mcp_K2 ms-bg-color-white'> <div class='_mcp_P2'></div> <div></div> <div class='_mcp_L2 ms-font-weight-regular ms-font-color-neutralSecondary'></div> </div> <div class='_mcp_E2'> <div class='_mcp_F2 _mcp_Q2'></div> <div></div> <div class='_mcp_F2 _mcp_Q2'></div> <div class='ms-border-color-neutralTertiary ms-bg-color-white _mcp_G2'></div> <div class='_mcp_F2'>  <div class='_mcp_V2'></div> </div> <div class='ms-border-color-neutralTertiary ms-bg-color-white _mcp_R2'></div> </div> </div><div> <button autoid=\"_mcp_u\" type='button' class='_mcp_Y2'></button> <button autoid=\"_mcp_v\" type='button' class='_mcp_Y2'></button> </div><div> <span class='_mcp_W2 ms-font-weight-regular ms-font-color-neutralPrimary'></span> <div autoid=\"_mcp_r\" class='_mcp_X2'></div> <button autoid=\"_mcp_s\" type='button' class='_mcp_Y2'></button> <button autoid=\"_mcp_t\" type='button' class='_mcp_Y2'></button>  <div></div> <div class='_mcp_Z2'></div>  </div><div> <span class='_mcp_03 ms-font-weight-regular ms-font-color-neutralPrimary'></span> <div class='_mcp_13'></div> <button type='button' class='_mcp_23'></button> <button type='button' class='_mcp_23'></button>  </div><div> <div class='_mcp_53'> <label></label> </div> <div class='_mcp_53'> <label class='_mcp_b3'></label> <div class='_mcp_93'> <input class='_mcp_73'/> <input class='_mcp_73'/> <input class='_mcp_73'/> </div> </div> </div><div> <span class='_mcp_33 ms-font-weight-regular ms-font-color-neutralPrimary'></span> <div class='_mcp_63'></div> <span class='_mcp_43 ms-font-weight-regular ms-font-color-neutralPrimary'></span> </div><div> <div class='_mcp_i3'> <button type='button' class='_mcp_e3'></button> <span class='_mcp_h3 ms-font-xl  ms-font-weight-semilight ms-font-color-neutralPrimary'></span> </div>  <div class='_mcp_f3'> <div class='ms-border-color-neutralTertiaryAlt _mcp_g3'></div> </div> <div class='_mcp_c3'> <button type='button' class='_mcp_d3'></button> <button type='button' class='_mcp_d3'></button> </div> </div>";_j.i.a().appendChild(n);return n};_mcp.a.fF=function(n){return n.e()};_mcp.a.fG=function(n){return n.f()};_mcp.a.fD=function(n){return n.b};_mcp.a.fE=function(n){return n.c};_mcp.a.gz=function(n){return n.b};_mcp.a.gy=function(n){return n.a};_mcp.a.d=function(n){return n.bb()};_mcp.a.H=function(n){return _mcp.f.isInstanceOfType(n)?n.br:null};_mcp.a.dS=function(n){return n.n()};_mcp.a.bk=function(n){return n.ce()};_mcp.a.bf=function(n){return n.a()};_mcp.a.z=function(n){return n.q()};_mcp.a.W=function(n){return n.k()};_mcp.a.dT=function(n){return n.x()};_mcp.a.e=function(n){return n.Z};_mcp.a.bd=function(n){return n.u()};_mcp.a.eD=function(n){return _mcp.i.isInstanceOfType(n)?n.gH():null};_mcp.a.R=function(n){return n.bC()};_mcp.a.N=function(n){return n.a()};_mcp.a.q=function(n){return n.ek()};_mcp.a.dO=function(n){return n.d()};_mcp.a.bs=function(n){return n.W()};_mcp.a.bW=function(n){return n.a()};_mcp.a.bY=function(n){return _mcp.g.isInstanceOfType(n)?n.j():null};_mcp.a.eb=function(n){return _mcp.b.isInstanceOfType(n)?_u.P.R:null};_mcp.a.dN=function(n){return n.c()};_mcp.a.dM=function(n){return n.b()};_mcp.a.U=function(n){return n.bK()};_mcp.a.gi=function(n){return n.a()};_mcp.a.dW=function(n){return n.g()};_mcp.a.dV=function(n){return n.d()};_mcp.a.fr=function(n){return n.e()};_mcp.a.cY=function(n){return n.bg};_mcp.a.cX=function(n){return n.v()};_mcp.a.J=function(n){return n.bY};_mcp.a.eE=function(n){return n.dn};_mcp.a.ef=function(n){return _a.g.b};_mcp.a.x=function(n){return n.bm()};_mcp.a.be=function(n){return n.a()};_mcp.a.bT=function(n){return n.b()};_mcp.a.gB=function(n){return n.fc()};_mcp.a.cI=function(n){return n.ck};_mcp.a.cb=function(n){return n.cc};_mcp.a.cJ=function(n){return n.bI()};_mcp.a.ge=function(n){return n.a()};_mcp.a.bC=function(n){return n.bj()};_mcp.a.cw=function(n){return n.d()};_mcp.a.D=function(n){return n.bg()};_mcp.a.cz=function(n){return _mcp.s.isInstanceOfType(n)?n.z:null};_mcp.a.cA=function(n){return n.db()};_mcp.a.bX=function(n){return n.a()};_mcp.a.cu=function(n){return n.w()};_mcp.a.l=function(n){return n.X};_mcp.a.cg=function(n){return _mcp.i.isInstanceOfType(n)?n.cw:null};_mcp.a.K=function(n){return _mcp.i.isInstanceOfType(n)?n.bs:null};_mcp.a.cC=function(n){return n.ba};_mcp.a.s=function(n){return n.eh()};_mcp.a.ca=function(n){return n.dz()};_mcp.a.eC=function(n){return n.eE()};_mcp.a.bU=function(n){return n.z()};_mcp.a.Q=function(n){return n.c()};_mcp.a.C=function(n){return n.Q()};_mcp.a.n=function(n){return n.eg()};_mcp.a.u=function(n){return n.v()};_mcp.a.hm=function(n){return n.gI()};_mcp.a.cD=function(n){return n.fe()};_mcp.a.bh=function(n){return n.a};_mcp.a.bc=function(n){return _rw.c.isInstanceOfType(n)?n.eq():null};_mcp.a.bg=function(n){return n.b};_mcp.a.P=function(n){return n.g()};_mcp.a.hk=function(n){return n.fD()};_mcp.a.cq=function(n){return n.Y()};_mcp.a.O=function(n){return n.o()};_mcp.a.hj=function(n){return n.fw()};_mcp.a.bA=function(n){return n.bj()};_mcp.a.bB=function(n){return n.cF()};_mcp.a.fM=function(n){return n.d()};_mcp.a.cr=function(n){return n.a()};_mcp.a.dF=function(n){return n.t()};_mcp.a.dE=function(n){return n.o()};_mcp.a.cB=function(n){return n.ef()};_mcp.a.ct=function(n){return n.a()};_mcp.a.cp=function(n){return n.X()};_mcp.a.bo=function(n){return n.b};_mcp.a.ea=function(n){return _mcp.b.isInstanceOfType(n)?255:null};_mcp.a.dD=function(n){return n.bu()};_mcp.a.dA=function(n){return n.bF()};_mcp.a.B=function(n){return n.bc()};_mcp.a.bV=function(n){return n.a()};_mcp.a.fn=function(n){return n.n()};_mcp.a.I=function(n){return _mcp.b.isInstanceOfType(n)?n.fL():null};_mcp.a.bZ=function(n){return _mcp.b.isInstanceOfType(n)?n.fK():null};_mcp.a.dz=function(n){return n.y()};_mcp.a.dj=function(n){return n.bZ()};_mcp.a.dy=function(n){return n.j()};_mcp.a.dk=function(n){return n.cj()};_mcp.a.ee=function(n){return n.bN()};_mcp.a.dJ=function(n){return n.b()};_mcp.a.di=function(n){return n.bJ};_mcp.a.hi=function(n){return n.df()};_mcp.a.hh=function(n){return n.bl()};_mcp.a.ec=function(n){return n.ec()};_mcp.a.dU=function(n){return n.c()};_mcp.a.dC=function(n){return n.dw()};_mcp.a.ek=function(n){return n.bh};_mcp.a.gf=function(n){return n.g()};_mcp.a.gg=function(n){return n.i()};_mcp.a.v=function(n){return n.b()};_mcp.a.fL=function(n){return n.c()};_mcp.a.bx=function(n){return n.p};_mcp.a.by=function(n){return n.w};_mcp.a.bu=function(n){return n.o};_mcp.a.bv=function(n){return n.x};_mcp.a.bw=function(n){return n.n};_mcp.a.el=function(n){return n.ca()};_mcp.a.dQ=function(n){return n.a()};_mcp.a.bR=function(n){return n.B};_mcp.a.bN=function(n){return n.bT};_mcp.a.em=function(n){return n.cb()};_mcp.a.dR=function(n){return n.a()};_mcp.a.gD=function(n){return n.bL};_mcp.a.T=function(n){return n.dC()};_mcp.a.fX=function(n){return n.i()};_mcp.a.fT=function(n){return n.f()};_mcp.a.fU=function(n){return n.g()};_mcp.a.cF=function(n){return n.bS};_mcp.a.bi=function(n){return n.ei()};_mcp.a.dY=function(n){return _mcp.f.isInstanceOfType(n)?n.cp:null};_mcp.a.fq=function(n){return n.d()};_mcp.a.eT=function(n){return n.X};_mcp.a.hg=function(n){return n.s()};_mcp.a.cH=function(n){return n.bk()};_mcp.a.dB=function(n){return n.ct()};_mcp.a.gw=function(n){return _mcp.f.isInstanceOfType(n)?n.eD():null};_mcp.a.ga=function(n){return n.z()};_mcp.a.cE=function(n){return n.bl()};_mcp.a.dX=function(n){return _mcp.t.isInstanceOfType(n)?n.B:null};_mcp.a.dg=function(n){return n.o};_mcp.a.df=function(n){return n.E};_mcp.a.eP=function(n){return n.j};_mcp.a.eO=function(n){return n.r};_mcp.a.eQ=function(n){return n.z};_mcp.a.dL=function(n){return n.l()};_mcp.a.bD=function(n){return n.w()};_mcp.a.ei=function(n){return n.dB()};_mcp.a.fA=function(n){return n.p};_mcp.a.eS=function(n){return n.x.length};_mcp.a.bt=function(n){return n.bq()};_mcp.a.cS=function(n){return n.A};_mcp.a.S=function(n){return n.bp()};_mcp.a.cs=function(n){return n.a()};_mcp.a.cv=function(n){return n.y()};_mcp.a.gv=function(n){return _mcp.f.isInstanceOfType(n)?n.ea():null};_mcp.a.gx=function(n){return _mcp.f.isInstanceOfType(n)?n.ec():null};_mcp.a.gu=function(n){return _mcp.f.isInstanceOfType(n)?n.dX():null};_mcp.a.gt=function(n){return _mcp.f.isInstanceOfType(n)?n.dW():null};_mcp.a.cy=function(n){return _mcp.f.isInstanceOfType(n)?n.dw():null};_mcp.a.fz=function(n){return n.bN()};_mcp.a.hp=function(n){return n.id()};_mcp.a.hn=function(n){return n.fE()};_mcp.a.eg=function(n){return n.bH()};_mcp.a.gY=function(n){return n.fY()};_mcp.a.hb=function(n){return n.gs()};_mcp.a.gW=function(n){return n.fX()};_mcp.a.hl=function(n){return n.dq};_mcp.a.fo=function(n){return n.o()};_mcp.a.gZ=function(n){return n.fi()};_mcp.a.bj=function(n){return n.ej()};_mcp.a.gV=function(n){return n.bl()};_mcp.a.hc=function(n){return n.dF()};_mcp.a.gA=function(n){return _mcp.b.isInstanceOfType(n)?n.fN():null};_mcp.a.gF=function(n){return n.bE};_mcp.a.gq=function(n){return _mcp.v.isInstanceOfType(n)?n.u:null};_mcp.a.gr=function(n){return _mcp.v.isInstanceOfType(n)?n.k():null};_mcp.a.gE=function(n){return n.bq()};_mcp.a.gs=function(n){return _mcp.t.isInstanceOfType(n)?n.u:null};_mcp.a.cT=function(n){return n.cI()};_mcp.a.ha=function(n){return n.fj()};_mcp.a.gX=function(n){return n.fh()};_mcp.a.hd=function(n){return n.fk()};_mcp.a.gd=function(n){return n.f()};_mcp.a.fy=function(n){return n.W()};_mcp.a.gj=function(n){return _mcp.m.isInstanceOfType(n)?n.C:null};_mcp.a.gk=function(n){return _mcp.m.isInstanceOfType(n)?n.cl():null};_mcp.a.cx=function(n){return _mcp.m.isInstanceOfType(n)?n.cm():null};_mcp.a.F=function(n){return n.q()};_mcp.a.gG=function(n){return n.dE()};_mcp.a.fH=function(n){return n.f()};_mcp.a.cf=function(n){return n.bP};_mcp.a.ho=function(n){return n.ic()};_mcp.a.en=function(n){return n.em()};_mcp.a.gb=function(n){return n.a()};_mcp.a.ed=function(n){return n.dy()};_mcp.a.eW=function(n){return n.a()};_mcp.a.he=function(n){return n.fl()};_mcp.a.go=function(n){return _mcp.A.isInstanceOfType(n)?n.bF():null};_mcp.a.fR=function(n){return n.m()};_mcp.a.dZ=function(n){return _mcp.z.isInstanceOfType(n)?n.w:null};_mcp.a.fp=function(n){return n.A()};_mcp.a.gH=function(n){return n.cj};_mcp.a.fN=function(n){return n.f()};_mcp.a.fO=function(n){return n.b()};_mcp.a.gl=function(n){return _mcp.p.isInstanceOfType(n)?n.m:null};_mcp.a.gm=function(n){return _mcp.p.isInstanceOfType(n)?n.n:null};_mcp.a.dx=function(n){return n.z};_mcp.a.gc=function(n){return n.i()};_mcp.a.fv=function(n){return n.i()};_mcp.a.fw=function(n){return n.j()};_mcp.a.ft=function(n){return n.g()};_mcp.a.fu=function(n){return n.h()};_mcp.a.fW=function(n){return n.b()};_mcp.a.fV=function(n){return n.a()};_mcp.a.gI=function(n){return n.eo()};_mcp.a.eh=function(n){return n.bt()};_mcp.a.gp=function(n){return _mcp.L.isInstanceOfType(n)?n.M():null};_mcp.a.cU=function(n){return n.n};_mcp.a.eJ=function(n){return n.j};_mcp.a.fS=function(n){return n.b()};_mcp.a.ej=function(n){return n.dD()};_mcp.a.fK=function(n){return n.a()};_mcp.a.hf=function(n){return n.q()};_mcp.a.fJ=function(n){return n.b()};_mcp.a.cG=function(n){return n.cR};_mcp.a.fs=function(n){return n.E()};_mcp.a.fQ=function(n){return n.K()};_mcp.a.fC=function(n){return n.b()};_mcp.a.fB=function(n){return n.a()};_mcp.a.ez=function(n){return n.r()};_mcp.a.eA=function(n){return n.s()};_mcp.a.gC=function(n){return n.cJ};_mcp.a.gK=function(n){return n.b};_mcp.a.gL=function(n){return n.i};_mcp.a.gM=function(n){return n.c};_mcp.a.gN=function(n){return n.j};_mcp.a.er=function(n){return n.s()};_mcp.a.eq=function(n){return n.d};_mcp.a.db=function(n){return n.b()};_mcp.a.eo=function(n){return n.e};_mcp.a.es=function(n){return!_a.g.b};_mcp.a.ep=function(n){return n.f};_mcp.a.et=function(n){return!_a.g.b};_mcp.a.gJ=function(n){return n.h};_mcp.a.ex=function(n){return n.l()};_mcp.a.cc=function(n){return n.c};_mcp.a.cL=function(n){return n.d()};_mcp.a.cN=function(n){return n.a};_mcp.a.cM=function(n){return n.e()};_mcp.a.cP=function(n){return n.d};_mcp.a.ck=function(n){return n.u()};_mcp.a.cK=function(n){return n.c};_mcp.a.cd=function(n){return n.e};_mcp.a.ce=function(n){return n.f};_mcp.a.gR=function(n){return n.a};_mcp.a.eK=function(n){return n.a()};_mcp.a.gQ=function(n){return n.g};_mcp.a.ey=function(n){return n.m()};_mcp.a.gT=function(n){return n.a};_mcp.a.gU=function(n){return n.n()};_mcp.a.h=function(n,t){n.a(t)};_mcp.a.i=function(n,t){n.T(t)};_mcp.a.g=function(n,t){n.ba(t)};_mcp.a.m=function(n,t){n.l(t)};_mcp.a.k=function(n,t){n.k(t)};_mcp.a.j=function(n,t){n.Q(t)};_mcp.a.Y=function(n,t){n.c(t)};_mcp.a.G=function(n,t){n.r(t)};_mcp.a.X=function(n,t){n.j(t)};_mcp.a.b=function(n,t){n.K(t)};_mcp.a.dP=function(n,t){n.f(t)};_mcp.a.dt=function(n,t){n.a(t)};_mcp.a.bl=function(n,t){n.m(t)};_mcp.a.E=function(n,t){n.s(t)};_mcp.a.L=function(n,t){n.b(t)};_mcp.a.bm=function(n,t){n.d(t)};_mcp.a.r=function(n,t){n.a(t)};_mcp.a.cZ=function(n,t){n.c(t)};_mcp.a.o=function(n,t){n.l=t};_mcp.a.M=function(n,t){n.n=t};_mcp.a.bP=function(n,t){n.m=t};_mcp.a.dh=function(n,t){n.c(t)};_mcp.a.A=function(n,t){n.Q(t)};_mcp.a.bq=function(n,t){n.g(t)};_mcp.a.dI=function(n,t){n.v(t)};_mcp.a.br=function(n,t){n.c(t)};_mcp.a.bp=function(n,t){n.a(t)};_mcp.a.fI=function(n,t){n.w(t)};_mcp.a.cm=function(n,t){n.gp(t)};_mcp.a.dq=function(n,t){n.ga(t)};_mcp.a.dH=function(n,t){n.r(t)};_mcp.a.dm=function(n,t){n.cl(t)};_mcp.a.dG=function(n,t){n.i(t)};_mcp.a.dp=function(n,t){n.cy(t)};_mcp.a.dK=function(n,t){n.a(t)};_mcp.a.dl=function(n,t){n.bg(t)};_mcp.a.dn=function(n,t){n.cc=t};_mcp.a.eY=function(n,t){n.bT(t)};_mcp.a.dr=function(n,t){n.cx=t};_mcp.a.du=function(n,t){n.Q=t};_mcp.a.dw=function(n,t){n.bO(t)};_mcp.a.dv=function(n,t){n.bJ(t)};_mcp.a.bQ=function(n,t){n.bQ(t)};_mcp.a.ds=function(n,t){n.a(t)};_mcp.a.co=function(n,t){n.k(t)};_mcp.a.cn=function(n,t){n.d(t)};_mcp.a.gh=function(n,t){n.k(t)};_mcp.a.w=function(n,t){n.a(t)};_mcp.a.bz=function(n,t){n.f(t)};_mcp.a.ba=function(n,t){n.l(t)};_mcp.a.bb=function(n,t){n.i(t)};_mcp.a.bn=function(n,t){n.o(t)};_mcp.a.Z=function(n,t){n.k(t)};_mcp.a.bS=function(n,t){n.y(t)};_mcp.a.bO=function(n,t){n.dH(t)};_mcp.a.eM=function(n,t){n.a(t)};_mcp.a.eU=function(n,t){n.F(t)};_mcp.a.p=function(n,t){n.bm(t)};_mcp.a.fc=function(n,t){n.l=t};_mcp.a.fa=function(n,t){n.p=t};_mcp.a.fb=function(n,t){n.bg(t)};_mcp.a.eV=function(n,t){n.bE(t)};_mcp.a.ch=function(n,t){n.cz(t)};_mcp.a.cR=function(n,t){n.a=t};_mcp.a.eN=function(n,t){n.s(t)};_mcp.a.fd=function(n,t){n.f=t};_mcp.a.fe=function(n,t){n.i=t};_mcp.a.eX=function(n,t){n.cO=t};_mcp.a.fl=function(n,t){n.y(t)};_mcp.a.fj=function(n,t){n.cQ(t)};_mcp.a.fi=function(n,t){n.ce(t)};_mcp.a.fk=function(n,t){n.dV(t)};_mcp.a.eZ=function(n,t){n.bn(t)};_mcp.a.fm=function(n,t){n.f=t};_mcp.a.ff=function(n,t){n.K=t};_mcp.a.fh=function(n,t){n.Q=t};_mcp.a.fg=function(n,t){n.bl=t};_mcp.a.y=function(n,t){n.p(t)};_mcp.a.V=function(n,t){n.o(t)};_mcp.a.eR=function(n,t){n.y(t)};_mcp.a.fP=function(n,t){n.i(t)};_mcp.a.gn=function(n,t){n.o(t)};_mcp.a.da=function(n,t){n.bl(t)};_mcp.a.fx=function(n,t){n.k(t)};_mcp.a.fZ=function(n,t){n.d(t)};_mcp.a.fY=function(n,t){n.c(t)};_mcp.a.eB=function(n,t){n.p(t)};_mcp.a.gO=function(n,t){n.p(t)};_mcp.a.gP=function(n,t){n.q(t)};_mcp.a.dc=function(n,t){n.c(t)};_mcp.a.ew=function(n,t){n.o(t)};_mcp.a.dd=function(n,t){n.e(t)};_mcp.a.eu=function(n,t){n.m(t)};_mcp.a.ev=function(n,t){n.n(t)};_mcp.a.de=function(n,t){n.a=t};_mcp.a.cO=function(n,t){n.f(t)};_mcp.a.cQ=function(n,t){n.j(t)};_mcp.a.cl=function(n,t){n.l(t)};_mcp.a.gS=function(n,t){n.n(t)};_mcp.a.eL=function(n,t){n.b(t)};_mcp.a.t=function(){_mcp.a.bI||(_mcp.a.bI=new _fc.l);return _mcp.a.bI};_mcp.a.c=function(){_mcp.a.bE||(_mcp.a.bE=new _fc.k);return _mcp.a.bE};_mcp.a.cj=function(){_mcp.a.bL||(_mcp.a.bL=new _n.A);return _mcp.a.bL};_mcp.a.cV=function(){_mcp.a.bJ||(_mcp.a.bJ=new _b.bs);return _mcp.a.bJ};_mcp.a.eH=function(){_mcp.a.bK||(_mcp.a.bK=new _n.bg);return _mcp.a.bK};_mcp.a.ci=function(){_mcp.a.bH||(_mcp.a.bH=new _fc.o);return _mcp.a.bH};_mcp.a.eF=function(){_mcp.a.bF||(_mcp.a.bF=new _fce.s);return _mcp.a.bF};_mcp.a.eG=function(){_mcp.a.bG||(_mcp.a.bG=new _fce.H);return _mcp.a.bG};_mcp.a.cW=function(){_mcp.a.bM||(_mcp.a.bM=new _mcp.bT);return _mcp.a.bM};_mcp.a._I=function(){var w="AddOriginalAttachmentInfoBarView._tid1";new _j.d(w,function(){_mcp.a.a[w]===undefined&&(_mcp.a.a[w]=[[[-1,0,["IncludeButtonText"],[_mcp.a.fF],null,"Text",null,_mcp.a.h,0,null,null,null]]]);var n=_mcp.a.f.childNodes[0].cloneNode(!0);var t=new _fc.a(n.children[0]);return new _j.a(n,[t])},"",_mcp.N,_fc.e,function(n){return new _fc.e(n)},!1,!0,!1,0,_mcp.a.a);var b="AddOriginalAttachmentInfoBarView._tid2";new _j.d(b,function(){_mcp.a.a[b]===undefined&&(_mcp.a.a[b]=[[[-1,4,null,null,null,"Text",null,_mcp.a.h,0,null,null,null,_u.n.Ls]]]);var n=_mcp.a.f.childNodes[0].cloneNode(!0);var t=new _fc.a(n.children[0]);return new _j.a(n,[t])},"",_mcp.N,_fc.e,function(n){return new _fc.e(n)},!1,!0,!1,0,_mcp.a.a);var k="AddOriginalAttachmentInfoBarView";new _j.d(k,function(){_mcp.a.a[k]===undefined&&(_mcp.a.a[k]=[[[-1,0,["InfoBarText"],[_mcp.a.fG],null,"Text",null,_mcp.a.h,1,null,null,null]],[[-1,0,["AddAttachmentCommand"],[_mcp.a.fD],null,"ClickCommand",null,_mcp.a.i,0,null,null,null]],null,[[-1,0,["DismissInfoBarCommand"],[_mcp.a.fE],null,"ClickCommand",null,_mcp.a.i,0,null,null,null]]]);var n=_mcp.a.f.childNodes[1].cloneNode(!0);var r=new _fc.e(_j.a.a(n,[0,3]));r.y("AddOriginalAttachmentInfoBarView._tid2");var i=new _fc.a(_j.a.a(n,[0,2]));i.a("|");var t=new _fc.e(_j.a.a(n,[0,1]));t.y("AddOriginalAttachmentInfoBarView._tid1");var u=new _fc.a(_j.a.a(n,[0,0]));return new _j.a(n,[u,t,i,r])},"",_mcp.N,_j.c,function(n){return new _j.c(n)},!1,!1,!1,0,_mcp.a.a);var v="IrmDialogView";new _j.d(v,function(){_mcp.a.a[v]===undefined&&(_mcp.a.a[v]=[[[-1,0,["Description"],[_mcp.a.gz],null,"Text",null,_mcp.a.h,1,null,null,null]],[[-1,0,["ConversationOwner"],[_mcp.a.gy],null,"Text",null,_mcp.a.h,1,null,null,null]]]);var n=_mcp.a.f.childNodes[2].cloneNode(!0);var i=new _fc.a(n.children[1]);var t=new _fc.a(n.children[0]);return new _j.a(n,[t,i])},"",_mcp.bh,_j.c,function(n){return new _j.c(n)},!1,!1,!1,0,_mcp.a.a);var y="MailComposeView._tid3._tid5";new _j.d(y,function(){_mcp.a.a[y]===undefined&&(_mcp.a.a[y]=[[[-1,0,["RecipientComponent","FromPersonaViewModel"],[_mcp.a.d,_mcp.a.H],null,"DataContext",null,_mcp.a.g,1,null,null,null]]]);var t=_mcp.a.f.childNodes[0].cloneNode(!0);var n=new _pe.d(t.children[0],_j.b.Instance.a(_a.r),_j.b.Instance.a(_pe.e));n.j("_mcp_w ms-font-weight-regular ms-font-color-black bidi");n.y("PersonaView.BasicDetailsPopup");n.bb("MailCompose.FromRecipientWellButton");return new _j.a(t,[n])},"",_mcp.d,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_mcp.a.a);var p="MailComposeView._tid3._tid6";new _j.d(p,function(){_mcp.a.a[p]===undefined&&(_mcp.a.a[p]=[[[-1,0,["RecipientComponent","FromFindRecipientViewModel"],[_mcp.a.d,_mcp.a.dS],null,"DataContext",null,_mcp.a.g,1,null,null,null]]]);var t=_mcp.a.f.childNodes[3].cloneNode(!0);var n=new _fp.f(t.children[0],_j.b.Instance.a(_y.a),_j.b.Instance.a(_j.j));n.bb("MailCompose.FromRecipientWellButton");return new _j.a(t,[n])},"",_mcp.d,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_mcp.a.a);var d="MailComposeView._tid3";new _j.d(d,function(){_mcp.a.a[d]===undefined&&(_mcp.a.a[d]=[[[-1,4,null,null,null,"ImageId",null,_mcp.a.m,0,null,null,null,_b.i.b()],[-1,4,null,null,null,"Text",null,_mcp.a.k,0,null,null,null,_nbs.a.PN],[-1,4,null,null,null,"AriaLabel",null,_mcp.a.j,0,null,null,null,_nbs.a.py],[-1,5,["SendAsContextMenuComponent","Menu","IsShown"],[_mcp.a.bk,_mcp.a.bf,_mcp.a.z],null,"contextMenu",null,null,0,null,null,null]],[[-1,0,["RecipientComponent","FromPersonaViewModel"],[_mcp.a.d,_mcp.a.H],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.t(),null,!0]],[[-1,0,["RecipientComponent","FromPersonaViewModel"],[_mcp.a.d,_mcp.a.H],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.t(),null,!0]],[[-1,0,["RecipientComponent","FromPersonaViewModel"],[_mcp.a.d,_mcp.a.H],null,"IsHidden",null,_mcp.a.b,1,new _j.r([_mcp.a.t(),_mcp.a.c()],[null,null]),null,!0],[-1,5,["RecipientComponent","ShouldHighlightFromAsInvalid"],[_mcp.a.d,_mcp.a.dT],null,"_mcp_f",null,null,0,null,null,null]]]);var t=_mcp.a.f.childNodes[4].cloneNode(!0);var u=new _j.c(t.children[3]);u.y("MailComposeView._tid3._tid6");var f=new _j.c(t.children[2]);var r=new _j.c(t.children[1]);r.y("MailComposeView._tid3._tid5");var n=new _fc.b(t.children[0]);n.y("MailComposeView.FromButtonTemplate");n.f("ms-bg-color-neutralLighter");n.c("ms-bg-color-neutralLight");n.e("ms-font-color-white ms-bg-color-themePrimary");n.O("MailCompose.FromRecipientWellButton");n.B(0);var i=new _fce.g(_j.b.Instance.a(_fc.f),_j.b.Instance.a(_j.j),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));i.U(_j.f.a(["SendAsContextMenuComponent","Menu"],[_mcp.a.bk,_mcp.a.bf],null,"MenuDataContext",null,_mcp.a.Y,1)).U(_j.f.a(["SendAsContextMenuComponent","Menu","IsShown"],[_mcp.a.bk,_mcp.a.bf,_mcp.a.z],_mcp.a.G,"IsShown",_mcp.a.W,_mcp.a.X,2,null,null,!1));i.a=3;i.b=1;n.E([i]);return new _j.a(t,[n,r,f,u]).l({FromPersona:r})},"",_mcp.d,_mcp.l,function(n){return new _mcp.l(n)},!1,!0,!1,0,_mcp.a.a);var it="MailComposeView._tidb";new _j.d(it,function(){_mcp.a.a[it]===undefined&&(_mcp.a.a[it]=[[[-1,4,null,null,null,"Text",null,_mcp.a.h,0,null,null,null,_u.P.e]],[[-1,0,["Context","Subject"],[_mcp.a.e,_mcp.a.bd],null,"Text",null,_mcp.a.h,1,null,null,null]],[[-1,4,null,null,null,"ImageId",null,_mcp.a.m,0,null,null,null,_mcp.e.q()],[-1,1,["HideSubjectAffordanceButton"],[_mcp.a.eD],null,"IsHidden",null,_mcp.a.b,1,null,null,!0]]]);var t=_mcp.a.f.childNodes[5].cloneNode(!0);var i=new _fc.b(_j.a.a(t,[1,1]));var n=new _fce.g(_j.b.Instance.a(_fc.f),_j.b.Instance.a(_j.j),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));n.U(_j.f.a(["ContextMenuComponent","Menu"],[_mcp.a.R,_mcp.a.N],null,"MenuDataContext",null,_mcp.a.Y,1)).U(_j.f.a(["ContextMenuComponent","Menu","IsShown"],[_mcp.a.R,_mcp.a.N,_mcp.a.z],_mcp.a.G,"IsShown",_mcp.a.W,_mcp.a.X,2,null,null,!1));n.a=3;n.b=5;i.E([n]);var u=new _fc.a(_j.a.a(t,[1,0]));var r=new _fc.a(t.children[0]);return new _j.a(t,[r,u,i])},"",_mcp.d,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_mcp.a.a);var rt="MailComposeView._tidd._tide";new _j.d(rt,function(){_mcp.a.a[rt]===undefined&&(_mcp.a.a[rt]=[[[-1,0,["MeetingComponent","SenderDetailsViewModel"],[_mcp.a.q,_mcp.a.dO],_mcp.a.dP,"DataContext",_mcp.a.bs,_mcp.a.g,2,null,null,null]],[[-1,0,["MeetingComponent","FromDetailsViewModel"],[_mcp.a.q,_mcp.a.bW],null,"DataContext",null,_mcp.a.g,1,null,null,null]]]);var i=_mcp.a.f.childNodes[6].cloneNode(!0);var t=new _pe.d(i.children[1],_j.b.Instance.a(_a.r),_j.b.Instance.a(_pe.e));t.j("_mcp_l ms-font-weight-regular ms-font-color-black bidi");t.y("PersonaView.PresenceBasicDetailsPopup");var n=new _pe.d(i.children[0],_j.b.Instance.a(_a.r),_j.b.Instance.a(_pe.e));n.j("_mcp_l ms-font-weight-regular ms-font-color-black bidi");n.y("PersonaView.PresenceBasicDetailsPopup");return new _j.a(i,[n,t])},"",_mcp.d,_b.n,function(n){return new _b.n(n)},!1,!0,!1,0,_mcp.a.a);var ut="MailComposeView._tidd._tidf";new _j.d(ut,function(){_mcp.a.a[ut]===undefined&&(_mcp.a.a[ut]=[[[-1,0,["MeetingComponent","FromDetailsViewModel"],[_mcp.a.q,_mcp.a.bW],null,"DataContext",null,_mcp.a.g,1,null,null,null]]]);var t=_mcp.a.f.childNodes[7].cloneNode(!0);var n=new _pe.d(t.children[0],_j.b.Instance.a(_a.r),_j.b.Instance.a(_pe.e));n.j("_mcp_l ms-font-weight-regular ms-font-color-black bidi");n.y("PersonaView.PresenceBasicDetailsPopup");return new _j.a(t,[n])},"",_mcp.d,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_mcp.a.a);var g="MailComposeView._tidd";new _j.d(g,function(){_mcp.a.a[g]===undefined&&(_mcp.a.a[g]=[[[-1,4,null,null,null,"Text",null,_mcp.a.h,0,null,null,null,_nbs.a.gt]],[[-1,4,null,null,null,"FormatString",null,_mcp.a.dt,0,null,null,null,_u.n.Qj],[-1,0,["MeetingComponent","IsMeetingForwardOnBehalfOf"],[_mcp.a.q,_mcp.a.bY],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]],[[-1,0,["MeetingComponent","IsMeetingForwardOnBehalfOf"],[_mcp.a.q,_mcp.a.bY],null,"IsHidden",null,_mcp.a.b,1,null,null,!0]]]);var n=_mcp.a.f.childNodes[8].cloneNode(!0);var i=new _j.c(_j.a.a(n,[1,1]));i.y("MailComposeView._tidd._tidf");var t=new _b.n(_j.a.a(n,[1,0]));t.y("MailComposeView._tidd._tide");var r=new _fc.a(n.children[0]);return new _j.a(n,[r,t,i])},"",_mcp.d,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_mcp.a.a);var nt="MailComposeView._tidg";new _j.d(nt,function(){_mcp.a.a[nt]===undefined&&(_mcp.a.a[nt]=[[[-1,0,["Context","WhenLabel"],[_mcp.a.e,_mcp.a.eb],null,"Text",null,_mcp.a.h,1,null,null,null]],[[-1,0,["MeetingComponent","MeetingCalendarTimePeriod"],[_mcp.a.q,_mcp.a.dN],null,"Text",null,_mcp.a.h,1,null,null,null]]]);var n=_mcp.a.f.childNodes[9].cloneNode(!0);var i=new _fc.a(_j.a.a(n,[1,0]));var t=new _fc.a(n.children[0]);return new _j.a(n,[t,i])},"",_mcp.d,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_mcp.a.a);var tt="MailComposeView._tidh";new _j.d(tt,function(){_mcp.a.a[tt]===undefined&&(_mcp.a.a[tt]=[[[-1,4,null,null,null,"Text",null,_mcp.a.h,0,null,null,null,_u.P.J]],[[-1,0,["MeetingComponent","LocationViewModel"],[_mcp.a.q,_mcp.a.dM],null,"DataContext",null,_mcp.a.g,1,null,null,null]]]);var t=_mcp.a.f.childNodes[10].cloneNode(!0);var n=new _j.c(_j.a.a(t,[1,0]));n.y("LocationView");n.L(!0);var i=new _fc.a(t.children[0]);return new _j.a(t,[i,n])},"",_mcp.d,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_mcp.a.a);var r="MailComposeView._tidj";new _j.d(r,function(){_mcp.a.a[r]===undefined&&(_mcp.a.a[r]=[[[-1,4,null,null,null,"ImageId",null,_mcp.a.m,0,null,null,null,_b.i.a()],[-1,4,null,null,null,"HoveredImageId",null,_mcp.a.bl,0,null,null,null,_n.b.i()],[-1,4,null,null,null,"PressedImageId",null,_mcp.a.E,0,null,null,null,_n.b.i()],[-1,4,null,null,null,"Text",null,_mcp.a.k,0,null,null,null,_nbs.a.nz],[-1,4,null,null,null,"AriaLabel",null,_mcp.a.j,0,null,null,null,_nbs.a.nz],[-1,0,["UpgradeComponent","CompleteBodyUpgradeCommand"],[_mcp.a.U,_mcp.a.gi],null,"ClickCommand",null,_mcp.a.i,1,null,null,null],[-1,0,["UpgradeComponent","ShouldShowQuoteBodyButton"],[_mcp.a.U,_mcp.a.dW],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]],[[-1,4,null,null,null,"SpinnerSize",null,_mcp.a.L,0,null,null,0,0],[-1,4,null,null,null,"BusyText",null,_mcp.a.bm,0,null,null,null,_nbs.a.nz],[-1,0,["UpgradeComponent","IsWaitingForQuotedBody"],[_mcp.a.U,_mcp.a.dV],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]]]);var t=_mcp.a.f.childNodes[11].cloneNode(!0);var n=new _fce.h(t.children[1],_j.b.Instance.a(_j.p),_j.b.Instance.a(_ff.a));n.a=0;n.B(-1);var i=new _fc.b(t.children[0]);i.B(0);return new _j.a(t,[i,n])},"",_mcp.d,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_mcp.a.a);var u="MailComposeView._tidk";new _j.d(u,function(){_mcp.a.a[u]===undefined&&(_mcp.a.a[u]=[[[-1,0,["IsXOwaExtensibilityActive"],[_mcp.a.fr],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]]]);var t=_mcp.a.f.childNodes[12].cloneNode(!0);var n=new _j.c(t.children[0]);n.y("XComposeExtensibilityView");return new _j.a(t,[n])},"",_y.ft,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_mcp.a.a);var f="MailComposeView.FromButtonTemplate";new _j.d(f,function(){_mcp.a.a[f]===undefined&&(_mcp.a.a[f]=[[[-1,1,["Text"],[_mcp.a.cY],null,"Text",null,_mcp.a.h,1,null,null,null]],[[-1,1,["CurrentImageId"],[_mcp.a.cX],null,"Id",null,_mcp.a.r,1,null,null,null]]]);var n=_mcp.a.f.childNodes[13].cloneNode(!0);var i=new _fc.d(n.children[1],_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));var t=new _fc.a(n.children[0]);return new _j.a(n,[t,i]).l({Label:t,Image:i})},"",Object,_fc.b,function(n){return new _fc.b(n)},!1,!1,!1,0,_mcp.a.a);var n="MailComposeView";new _j.d(n,function(){_mcp.a.a[n]===undefined&&(_mcp.a.a[n]=[[[-1,4,null,null,null,"SpinnerSize",null,_mcp.a.L,0,null,null,0,1],[-1,1,["IsReadyToShowContent"],[_mcp.a.J],null,"IsBusy",null,_mcp.a.cZ,1,_mcp.a.c(),null,!1]],[[-1,1,["IsReadyToShowAppBarContent"],[_mcp.a.eE],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0],[-1,5,["GenericMailMode"],[_mcp.a.ef],null,"_mcp_R",null,null,0,_mcp.a.c(),null,null]],[[-1,5,["ExtensibilityComponent","ExtensibilityViewModel","AppPaneIsHidden"],[_mcp.a.x,_mcp.a.be,_mcp.a.bT],null,"_mcp_Z",null,null,0,_mcp.a.c(),null,null],[-1,5,["IsReadyToShowAppBarContent"],[_mcp.a.eE],null,"_mcp_Q",null,null,1,null,null,null],[-1,5,["GenericMailMode"],[_mcp.a.ef],null,"_mcp_U",null,null,0,null,null,null],[-1,5,["DisableMomemtumScrolling"],[_mcp.a.gB],null,"_mcp_M",null,null,0,null,null,null]],[[-1,4,null,null,null,"SpinnerSize",null,_mcp.a.L,0,null,null,0,0],[-1,0,["ToolbarMessage"],[_mcp.a.cI],null,"BusyText",null,_mcp.a.bm,1,null,null,null],[-1,0,["ShouldShowToolbarMessage"],[_mcp.a.cb],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]],[[-1,1,["IsReadyToShowContent"],[_mcp.a.J],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]],[[-1,0,["InfoBarViewModel"],[_mcp.a.cC],null,"DataSource",null,_mcp.a.dh,1,null,null,null],[-1,5,["IsFirefox"],[_mcp.a.s],null,"_mcp_W",null,null,0,null,null,null],[-1,5,["IsInternetExplorer"],[_mcp.a.ca],null,"_mcp_V",null,null,0,null,null,null]],[[-1,5,["DoesSupportRichText"],[_mcp.a.eC],null,"_mcp_6",null,null,1,null,null,null]],[[-1,0,["Context","IsFromShown"],[_mcp.a.e,_mcp.a.bU],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]],[[-1,4,null,null,null,"Text",null,_mcp.a.k,0,null,null,null,_u.n.Bt],[-1,4,null,null,null,"AriaLabel",null,_mcp.a.j,0,null,null,null,_nbs.a.Uo],[-1,0,["RecipientComponent","To","RichPeoplePickerCommand"],[_mcp.a.d,_mcp.a.Q,_mcp.a.C],null,"ClickCommand",null,_mcp.a.i,1,null,null,null],[-1,5,["IsFirefox"],[_mcp.a.s],null,"_mcp_W",null,null,0,null,null,null],[-1,5,["IsChrome"],[_mcp.a.n],null,"chr",null,null,0,null,null,null]],[[-1,0,["RecipientComponent","IsReadWrite"],[_mcp.a.d,_mcp.a.u],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]],null,[[-1,4,null,null,null,"ImageId",null,_mcp.a.m,0,null,null,null,_mcp.e.d()],[-1,4,null,null,null,"PressedImageId",null,_mcp.a.E,0,null,null,null,_mcp.e.e()],[-1,1,["IsToRecipientWellPeoplePickerButtonShown"],[_mcp.a.hm],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0],[-1,0,["RecipientComponent","To","RichPeoplePickerCommand"],[_mcp.a.d,_mcp.a.Q,_mcp.a.C],null,"ClickCommand",null,_mcp.a.i,1,null,null,null],[-1,5,["IsAndroid"],[_mcp.a.cD],null,"_mcp_T",null,null,0,null,null,null]],[[-1,4,null,null,null,"AriaLabel",null,_mcp.a.A,0,null,null,null,_nbs.a.de],[-1,0,["RecipientComponent","To","ReadWriteRecipientWellViewModel"],[_mcp.a.d,_mcp.a.Q,_mcp.a.bh],null,"DataContext",null,_mcp.a.g,1,null,null,null],[0,5,["IsAndroid"],[_mcp.a.bc],null,"_mcp_T",null,null,0,null,null,null]],[[-1,0,["RecipientComponent","IsReadWrite"],[_mcp.a.d,_mcp.a.u],null,"IsHidden",null,_mcp.a.b,1,null,null,!0]],[[-1,0,["RecipientComponent","To","ReadOnlyRecipientWellViewModel"],[_mcp.a.d,_mcp.a.Q,_mcp.a.bg],null,"DataContext",null,_mcp.a.g,1,null,null,null],[0,5,["IsAndroid"],[_mcp.a.bc],null,"Android",null,null,0,null,null,null]],null,[[-1,4,null,null,null,"Text",null,_mcp.a.k,0,null,null,null,_u.n.Mr],[-1,4,null,null,null,"AriaLabel",null,_mcp.a.j,0,null,null,null,_nbs.a.lm],[-1,0,["RecipientComponent","Cc","RichPeoplePickerCommand"],[_mcp.a.d,_mcp.a.P,_mcp.a.C],null,"ClickCommand",null,_mcp.a.i,1,null,null,null],[-1,5,["IsFirefox"],[_mcp.a.s],null,"_mcp_W",null,null,0,null,null,null],[-1,5,["IsChrome"],[_mcp.a.n],null,"chr",null,null,0,null,null,null]],[[-1,0,["RecipientComponent","IsReadWrite"],[_mcp.a.d,_mcp.a.u],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]],null,[[-1,4,null,null,null,"ImageId",null,_mcp.a.m,0,null,null,null,_mcp.e.d()],[-1,4,null,null,null,"PressedImageId",null,_mcp.a.E,0,null,null,null,_mcp.e.e()],[-1,1,["IsCcRecipientWellPeoplePickerButtonShown"],[_mcp.a.hk],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0],[-1,0,["RecipientComponent","Cc","RichPeoplePickerCommand"],[_mcp.a.d,_mcp.a.P,_mcp.a.C],null,"ClickCommand",null,_mcp.a.i,1,null,null,null],[-1,5,["IsAndroid"],[_mcp.a.cD],null,"_mcp_T",null,null,0,null,null,null]],[[-1,4,null,null,null,"AriaLabel",null,_mcp.a.A,0,null,null,null,_nbs.a.ZW],[-1,0,["RecipientComponent","Cc","ReadWriteRecipientWellViewModel"],[_mcp.a.d,_mcp.a.P,_mcp.a.bh],null,"DataContext",null,_mcp.a.g,1,null,null,null],[0,5,["IsAndroid"],[_mcp.a.bc],null,"_mcp_T",null,null,0,null,null,null]],[[-1,0,["RecipientComponent","IsReadWrite"],[_mcp.a.d,_mcp.a.u],null,"IsHidden",null,_mcp.a.b,1,null,null,!0]],[[-1,0,["RecipientComponent","Cc","ReadOnlyRecipientWellViewModel"],[_mcp.a.d,_mcp.a.P,_mcp.a.bg],null,"DataContext",null,_mcp.a.g,1,null,null,null],[0,5,["IsAndroid"],[_mcp.a.bc],null,"_mcp_T",null,null,0,null,null,null]],[[-1,0,["Context","IsBccShown"],[_mcp.a.e,_mcp.a.cq],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]],[[-1,4,null,null,null,"Text",null,_mcp.a.k,0,null,null,null,_u.n.Jq],[-1,4,null,null,null,"AriaLabel",null,_mcp.a.j,0,null,null,null,_nbs.a.lC],[-1,0,["RecipientComponent","Bcc","RichPeoplePickerCommand"],[_mcp.a.d,_mcp.a.O,_mcp.a.C],null,"ClickCommand",null,_mcp.a.i,1,null,null,null],[-1,5,["IsFirefox"],[_mcp.a.s],null,"_mcp_W",null,null,0,null,null,null],[-1,5,["IsChrome"],[_mcp.a.n],null,"chr",null,null,0,null,null,null]],[[-1,0,["RecipientComponent","IsReadWrite"],[_mcp.a.d,_mcp.a.u],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]],null,[[-1,4,null,null,null,"ImageId",null,_mcp.a.m,0,null,null,null,_mcp.e.d()],[-1,4,null,null,null,"PressedImageId",null,_mcp.a.E,0,null,null,null,_mcp.e.e()],[-1,1,["IsBccRecipientWellPeoplePickerButtonShown"],[_mcp.a.hj],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0],[-1,0,["RecipientComponent","Bcc","RichPeoplePickerCommand"],[_mcp.a.d,_mcp.a.O,_mcp.a.C],null,"ClickCommand",null,_mcp.a.i,1,null,null,null],[-1,5,["IsAndroid"],[_mcp.a.cD],null,"_mcp_T",null,null,0,null,null,null]],[[-1,4,null,null,null,"AriaLabel",null,_mcp.a.A,0,null,null,null,_nbs.a.SK],[-1,0,["RecipientComponent","Bcc","ReadWriteRecipientWellViewModel"],[_mcp.a.d,_mcp.a.O,_mcp.a.bh],null,"DataContext",null,_mcp.a.g,1,null,null,null],[0,5,["IsAndroid"],[_mcp.a.bc],null,"_mcp_T",null,null,0,null,null,null]],[[-1,0,["RecipientComponent","IsReadWrite"],[_mcp.a.d,_mcp.a.u],null,"IsHidden",null,_mcp.a.b,1,null,null,!0]],[[-1,0,["RecipientComponent","Bcc","ReadOnlyRecipientWellViewModel"],[_mcp.a.d,_mcp.a.O,_mcp.a.bg],null,"DataContext",null,_mcp.a.g,1,null,null,null],[0,5,["IsAndroid"],[_mcp.a.bc],null,"_mcp_T",null,null,0,null,null,null]],[[-1,0,["Context","IsMeetingForward"],[_mcp.a.e,_mcp.a.bA],null,"IsHidden",null,_mcp.a.b,1,null,null,!0]],[[-1,4,null,null,null,"ImageId",null,_mcp.a.m,0,null,null,null,_mcp.e.b()],[-1,0,["ComplianceComponent","ShowIrmInformationCommand"],[_mcp.a.bB,_mcp.a.fM],null,"ClickCommand",null,_mcp.a.i,1,null,null,null],[-1,0,["ComplianceComponent","IsIrmProtected"],[_mcp.a.bB,_mcp.a.cr],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]],[[-1,4,null,null,null,"Id",null,_mcp.a.r,0,null,null,null,_n.b.Z()],[-1,0,["Context","SmimeSignMessage"],[_mcp.a.e,_mcp.a.dF],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]],[[-1,4,null,null,null,"Id",null,_mcp.a.r,0,null,null,null,_n.b.be()],[-1,0,["Context","SmimeEncryptMessage"],[_mcp.a.e,_mcp.a.dE],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]],[[-1,0,["ImportanceComponent","IsNormalImportance"],[_mcp.a.cB,_mcp.a.ct],null,"IsHidden",null,_mcp.a.b,1,null,null,!0],[-1,0,["Context","Importance"],[_mcp.a.e,_mcp.a.cp],null,"Id",null,_mcp.a.r,1,_mcp.a.cj(),!1,null]],[[-1,4,null,null,null,"ImageId",null,_mcp.a.m,0,null,null,null,_mcp.e.q()],[-1,1,["HideSubjectAffordanceButton"],[_mcp.a.eD],null,"IsHidden",null,_mcp.a.b,1,null,null,!0]],[[-1,4,null,null,null,"Placeholder",null,_mcp.a.bq,0,null,null,null,_nbs.a.qi],[-1,0,["Context","Subject"],[_mcp.a.e,_mcp.a.bd],_mcp.a.dI,"Text",_mcp.a.bo,_mcp.a.br,2,null,null,null],[-1,0,["Context","MaxSubjectLength"],[_mcp.a.e,_mcp.a.ea],null,"MaxLength",null,_mcp.a.bp,1,null,null,0]],[[-1,0,["Context","ShowMeetingReadonlyFields"],[_mcp.a.e,_mcp.a.dD],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]],[[-1,0,["Context","IsMeetingForward"],[_mcp.a.e,_mcp.a.bA],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]],[[-1,0,["Context","IsMeetingForward"],[_mcp.a.e,_mcp.a.bA],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]],null,[[-1,0,["Context","HasLocation"],[_mcp.a.e,_mcp.a.dA],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]],[[-1,0,["AttachmentComponent","AttachmentWellViewModel","ShouldBeHidden"],[_mcp.a.B,_mcp.a.bV,_mcp.a.fn],null,"IsHidden",null,_mcp.a.b,1,null,null,!0]],[[-1,0,["AttachmentComponent","AttachmentWellViewModel"],[_mcp.a.B,_mcp.a.bV],_mcp.a.fI,"DataContext",_mcp.a.bs,_mcp.a.g,2,null,null,null]],[[-1,4,null,null,null,"Text",null,_mcp.a.h,0,null,null,null,_nbs.a.Gn],[-1,0,["Context","IsPrintRestricted"],[_mcp.a.e,_mcp.a.I],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0],[-1,5,["Context","IsPrintRestricted"],[_mcp.a.e,_mcp.a.I],null,"noScreen:hiddenMsg",null,null,0,null,null,null]],null,[[-1,4,null,null,null,"EditorAriaLabel",null,_mcp.a.dn,0,null,null,null,_nbs.a.Pk],[-1,1,["EditorSizingMode"],[_mcp.a.hi],null,"SizingMode",null,_mcp.a.eY,1,null,null,0],[-1,1,["EditorMinHeight"],[_mcp.a.hh],null,"MinHeight",null,_mcp.a.dr,1,null,null,0],[-1,1,["IsReadyToShowContent"],[_mcp.a.J],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0],[-1,0,["Context","IsCopyRestricted"],[_mcp.a.e,_mcp.a.bZ],null,"IsCopyRestricted",null,_mcp.a.cm,1,null,null,!1],[-1,0,["Context","IsPrintRestricted"],[_mcp.a.e,_mcp.a.I],null,"IsPrintRestricted",null,_mcp.a.dq,1,null,null,!1],[-1,0,["Context","EditorContent"],[_mcp.a.e,_mcp.a.dz],_mcp.a.dH,"Content",_mcp.a.dj,_mcp.a.dm,2,null,null,null],[-1,0,["Context","BodyType"],[_mcp.a.e,_mcp.a.dy],_mcp.a.dG,"IsPlainTextContent",_mcp.a.dk,_mcp.a.dp,2,_mcp.a.cV(),null,!1],[-1,0,["EditorComponent","EditorCallContext"],[_mcp.a.ee,_mcp.a.dJ],_mcp.a.dK,"CallContext",_mcp.a.di,_mcp.a.dl,2,null,null,null],[-1,5,["Context","IsPrintRestricted"],[_mcp.a.e,_mcp.a.I],null,"noPrint",null,null,0,null,null,null]],[[-1,1,["IsReadyToShowContent"],[_mcp.a.J],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0],[-1,5,["UpgradeComponent","IsOnDemandUpgradePending"],[_mcp.a.U,_mcp.a.dU],null,"_mcp_L",null,null,0,_mcp.a.c(),null,null]],[[-1,1,["DoesSupportRichText"],[_mcp.a.eC],null,"IsHidden",null,_mcp.a.b,1,null,null,!0],[-1,0,["Context","IsCopyRestricted"],[_mcp.a.e,_mcp.a.bZ],null,"TextSelectionType",null,_mcp.a.bQ,1,_mcp.a.eH(),null,0]],[[-1,0,["Context","IsCopyRestricted"],[_mcp.a.e,_mcp.a.bZ],null,"IsCopyRestricted",null,_mcp.a.cm,1,null,null,!1],[-1,0,["Context","QuotedBody"],[_mcp.a.e,_mcp.a.dC],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.t(),null,!0],[-1,0,["Context","QuotedBody"],[_mcp.a.e,_mcp.a.dC],null,"Html",null,_mcp.a.ds,1,null,null,null]],[[-1,0,["ExtensibilityComponent","ExtensibilityViewModel"],[_mcp.a.x,_mcp.a.be],null,"DataContext",null,_mcp.a.g,1,null,null,null],[0,0,["AppPaneIsHidden"],[_mcp.a.bT],null,"IsHidden",null,_mcp.a.b,1,null,null,!0]],[[-1,0,["MessageBoxViewModel"],[_mcp.a.ek],null,"DataContext",null,_mcp.a.g,1,null,null,null]],[[-1,4,null,null,null,"DialogTitle",null,_mcp.a.co,0,null,null,null,_nbs.a.Hy],[-1,0,["TouchComponent","CloseConfirmDialogButtonData"],[_mcp.a.cJ,_mcp.a.gf],null,"ButtonDataList",null,_mcp.a.cn,1,null,null,null],[-1,0,["TouchComponent","IsCloseConfirmDialogShown"],[_mcp.a.cJ,_mcp.a.gg],_mcp.a.gh,"IsShown",_mcp.a.v,_mcp.a.w,2,null,null,!1]],[[-1,0,["ComplianceComponent","DialogViewModel"],[_mcp.a.bB,_mcp.a.fL],null,"DataContext",null,_mcp.a.g,1,null,null,null],[0,0,["IsShown"],[_mcp.a.bx],_mcp.a.bz,"IsShown",_mcp.a.v,_mcp.a.w,2,null,null,!1],[0,0,["Title"],[_mcp.a.by],null,"DialogTitle",null,_mcp.a.ba,1,null,null,null],[0,0,["CloseCommand"],[_mcp.a.bu],null,"CloseCommand",null,_mcp.a.bb,1,null,null,null],[0,0,["ContentDataContext"],[_mcp.a.bv],null,"ContentDataContext",null,_mcp.a.bn,1,null,null,null],[0,0,["FooterButtons"],[_mcp.a.bw],null,"ButtonDataList",null,_mcp.a.Z,1,null,null,null]],[[-1,0,["MessageOptionsComponent","DialogViewModel"],[_mcp.a.el,_mcp.a.dQ],null,"DataContext",null,_mcp.a.g,1,null,null,null],[0,0,["IsBusy"],[_mcp.a.bR],_mcp.a.bS,"IsBusy",_mcp.a.bN,_mcp.a.bO,2,null,null,!1],[0,0,["IsShown"],[_mcp.a.bx],_mcp.a.bz,"IsShown",_mcp.a.v,_mcp.a.w,2,null,null,!1],[0,0,["Title"],[_mcp.a.by],null,"DialogTitle",null,_mcp.a.ba,1,null,null,null],[0,0,["CloseCommand"],[_mcp.a.bu],null,"CloseCommand",null,_mcp.a.bb,1,null,null,null],[0,0,["ContentDataContext"],[_mcp.a.bv],null,"ContentDataContext",null,_mcp.a.bn,1,null,null,null],[0,0,["FooterButtons"],[_mcp.a.bw],null,"ButtonDataList",null,_mcp.a.Z,1,null,null,null]],[[-1,0,["OmeComponent","DialogViewModel"],[_mcp.a.em,_mcp.a.dR],null,"DataContext",null,_mcp.a.g,1,null,null,null],[0,0,["IsBusy"],[_mcp.a.bR],_mcp.a.bS,"IsBusy",_mcp.a.bN,_mcp.a.bO,2,null,null,!1],[0,0,["IsShown"],[_mcp.a.bx],_mcp.a.bz,"IsShown",_mcp.a.v,_mcp.a.w,2,null,null,!1],[0,0,["Title"],[_mcp.a.by],null,"DialogTitle",null,_mcp.a.ba,1,null,null,null],[0,0,["CloseCommand"],[_mcp.a.bu],null,"CloseCommand",null,_mcp.a.bb,1,null,null,null],[0,0,["ContentDataContext"],[_mcp.a.bv],null,"ContentDataContext",null,_mcp.a.bn,1,null,null,null],[0,0,["FooterButtons"],[_mcp.a.bw],null,"ButtonDataList",null,_mcp.a.Z,1,null,null,null]],[[-1,0,["IsNavigatingAway"],[_mcp.a.gD],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]]]);var t=_mcp.a.f.childNodes[14].cloneNode(!0);var hi=new _j.i(t.children[9]);var kt=new _fce.o(t.children[8],_j.b.Instance.a(_fc.f),_j.b.Instance.a(_j.j),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));kt.d("OmeExpirationView");var bt=new _fce.o(t.children[7],_j.b.Instance.a(_fc.f),_j.b.Instance.a(_j.j),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));bt.d("MessageOptionsView");var pt=new _fce.o(t.children[6],_j.b.Instance.a(_fc.f),_j.b.Instance.a(_j.j),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));pt.d("IrmDialogView");var ht=new _b.o(t.children[5],_j.b.Instance.a(_y.a),_j.b.Instance.a(_fc.f),_j.b.Instance.a(_j.j),_j.b.Instance.a(_ff.b));ht.g(!1);var ut=new _j.c(t.children[4]);ut.y("MessageBoxDefaultView");var at=new _j.c(t.children[3]);at.y("MailComposeView._tidk");var dt=new _b.p(_j.a.a(t,[2,1,3,0]),_j.b.Instance.a(_a.f));var fr=new _j.i(_j.a.a(t,[2,1,3]));var ot=new _j.c(_j.a.a(t,[2,1,2,1]));ot.y("MailComposeView._tidj");var i=_j.b.Instance.a(_j.bE.$$(_zz.m)).a(_j.a.a(t,[2,1,2,0]));i.bB("_mcp_A ms-font-weight-regular ms-font-color-neutralPrimary customScrollBar");i.L(!0);i.B(-1);i.cm="0";var yt=new _zz.n(_j.b.Instance.a(_b.a),_j.b.Instance.a(_zz.h),_j.b.Instance.a(_ff.b));yt.k="PasteFlyout";var tr=new _zz.y;var nr=new _zz.x(_j.b.Instance.a(_fc.f),_j.b.Instance.a(_ff.b),_j.b.Instance.a(_j.j),_j.b.Instance.a(_ff.a));var rt=new _zz.o(_j.b.Instance.a(_b.a),_j.b.Instance.a(_zz.h),_j.b.Instance.a(_ff.b),_j.b.Instance.a(_a.f),_j.b.Instance.a(_j.cb.$$(IFindRecipientAtMentionSuggestionViewModelFactory)));rt.U(_j.f.a(["AtMentionComponent"],[_mcp.a.ec],null,"MentionsHandler",null,_mcp.a.du,1)).U(_j.f.a(["Context","Subject"],[_mcp.a.e,_mcp.a.bd],null,"Topic",null,_mcp.a.dw,1)).U(_j.f.b(_cmc.d.f,null,null,null,"Scenario",null,_mcp.a.dv,0));rt.k="MentionsPicker";i.E([yt,tr,nr,rt]);var ur=new _j.i(_j.a.a(t,[2,1,2]));var ki=new _fc.a(_j.a.a(t,[2,1,1,7]));var s=new _j.c(_j.a.a(t,[2,1,1,6,0,0]));s.y("AttachmentWellViewWrapper");s.cs(!0);s.L(!0);var er=new _j.i(_j.a.a(t,[2,1,1,6]));var ri=new _j.c(_j.a.a(t,[2,1,1,5,3]));ri.y("MailComposeView._tidh");var ii=new _j.c(_j.a.a(t,[2,1,1,5,2]));ii.y("MailComposeView._tidg");var ni=new _j.c(_j.a.a(t,[2,1,1,5,1]));ni.y("MailComposeView._tidd");var vt=new _j.c(_j.a.a(t,[2,1,1,5,0]));vt.y("MailComposeView._tidb");var yi=new _j.i(_j.a.a(t,[2,1,1,5]));var l=new _cmc.q(_j.a.a(t,[2,1,1,4,0,5,0]));l.i("ms-font-color-neutralTertiary");l.B(0);var ti=new _fc.b(_j.a.a(t,[2,1,1,4,0,4]));var h=new _fce.g(_j.b.Instance.a(_fc.f),_j.b.Instance.a(_j.j),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));h.U(_j.f.a(["ContextMenuComponent","Menu"],[_mcp.a.R,_mcp.a.N],null,"MenuDataContext",null,_mcp.a.Y,1)).U(_j.f.a(["ContextMenuComponent","Menu","IsShown"],[_mcp.a.R,_mcp.a.N,_mcp.a.z],_mcp.a.G,"IsShown",_mcp.a.W,_mcp.a.X,2,null,null,!1));h.a=3;h.b=5;ti.E([h]);var ui=new _fc.d(_j.a.a(t,[2,1,1,4,0,3]),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));var ei=new _fc.d(_j.a.a(t,[2,1,1,4,0,2]),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));var si=new _fc.d(_j.a.a(t,[2,1,1,4,0,1]),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));var oi=new _fc.b(_j.a.a(t,[2,1,1,4,0,0]));var pi=new _j.i(_j.a.a(t,[2,1,1,4]));var y=new _j.c(_j.a.a(t,[2,1,1,3,2,0]));y.y("ReadOnlyRecipientWellView");y.cs(!0);y.L(!0);var sr=new _j.i(_j.a.a(t,[2,1,1,3,2]));var a=new _j.c(_j.a.a(t,[2,1,1,3,1,1]));a.y("ReadWriteRecipientWellView");a.F(26);a.cs(!0);var v=new _fc.b(_j.a.a(t,[2,1,1,3,1,0,0]));v.i=!0;v.B(-1);v.N(!0);var bi=new _j.i(_j.a.a(t,[2,1,1,3,1,0]));var wi=new _j.i(_j.a.a(t,[2,1,1,3,1]));var r=new _fc.b(_j.a.a(t,[2,1,1,3,0]));r.f("ms-bg-color-neutralLighter");r.c("ms-bg-color-neutralLight");r.e("ms-font-color-white ms-bg-color-themePrimary");r.B(-1);var gt=new _j.i(_j.a.a(t,[2,1,1,3]));var c=new _j.c(_j.a.a(t,[2,1,1,2,2,0]));c.y("ReadOnlyRecipientWellView");c.cs(!0);c.L(!0);var gi=new _j.i(_j.a.a(t,[2,1,1,2,2]));var e=new _j.c(_j.a.a(t,[2,1,1,2,1,1]));e.y("ReadWriteRecipientWellView");e.cs(!0);e.F(26);e.L(!0);var nt=new _fc.b(_j.a.a(t,[2,1,1,2,1,0,0]));nt.i=!0;nt.B(-1);nt.N(!0);var di=new _j.i(_j.a.a(t,[2,1,1,2,1,0]));var ai=new _j.i(_j.a.a(t,[2,1,1,2,1]));var f=new _fc.b(_j.a.a(t,[2,1,1,2,0]));f.f("ms-bg-color-neutralLighter");f.c("ms-bg-color-neutralLight");f.e("ms-font-color-white ms-bg-color-themePrimary");f.B(-1);var lt=new _j.i(_j.a.a(t,[2,1,1,2]));var et=new _j.c(_j.a.a(t,[2,1,1,1,2,0]));et.y("ReadOnlyRecipientWellView");et.L(!0);var or=new _j.i(_j.a.a(t,[2,1,1,1,2]));var o=new _j.c(_j.a.a(t,[2,1,1,1,1,1]));o.y("ReadWriteRecipientWellView");o.F(26);o.L(!0);var tt=new _fc.b(_j.a.a(t,[2,1,1,1,1,0,0]));tt.i=!0;tt.B(-1);tt.N(!0);var ir=new _j.i(_j.a.a(t,[2,1,1,1,1,0]));var rr=new _j.i(_j.a.a(t,[2,1,1,1,1]));var u=new _fc.b(_j.a.a(t,[2,1,1,1,0]));u.f("ms-bg-color-neutralLighter");u.c("ms-bg-color-neutralLight");u.e("ms-font-color-white ms-bg-color-themePrimary");u.B(0);var ft=new _mcp.l(_j.a.a(t,[2,1,1,0,0]));ft.y("MailComposeView._tid3");var fi=new _j.i(_j.a.a(t,[2,1,1]));var d=_j.b.Instance.a(_j.bE.$$(_db.g)).a(_j.a.a(t,[2,1,0]));d.e="_mcp_D";d.B(0);var w=new _j.i(_j.a.a(t,[2,1]));w.B(-1);var wt=new _fc.g;var st=new _fc.c;st.U(_j.f.a(["TouchComponent","CloseCommand"],[_mcp.a.cJ,_mcp.a.ge],null,"Command",null,_mcp.a.o,1));st.j("ESC");var p=new _fc.c;p.U(_j.f.a(["SaveComponent","SaveCommand"],[_mcp.a.bC,_mcp.a.cw],null,"Command",null,_mcp.a.o,1));p.j("S");p.k=2;var k=new _fc.c;k.U(_j.f.a(["SendComponent","AltSSendCommand"],[_mcp.a.D,_mcp.a.cz],null,"Command",null,_mcp.a.o,1)).U(_j.f.a(["DoesSupportAltSForSend"],[_mcp.a.cA],null,"PreventDefault",null,_mcp.a.M,1,null,null,!1));k.j("S");k.k=4;var b=new _fc.c;b.U(_j.f.a(["SendComponent","SendCommand"],[_mcp.a.D,_mcp.a.bX],null,"Command",null,_mcp.a.o,1));b.j("ENTER");b.k=2;var g=new _fc.c;g.U(_j.f.a(["RecipientComponent","ResolveCommand"],[_mcp.a.d,_mcp.a.cu],null,"Command",null,_mcp.a.o,1));g.j("K");g.k=2;var it=new _fc.c;it.V(_j.f.a(["ContextParent","ContextParent","ShiftTabCommand"],[_mcp.a.l,_mcp.a.l,_mcp.a.cg],null,"Command",null,_mcp.a.o,1)).V(_j.f.a(["ContextParent","ContextParent","ShouldPreventShiftTabDefault"],[_mcp.a.l,_mcp.a.l,_mcp.a.K],null,"PreventDefault",null,_mcp.a.M,1,null,null,!1)).V(_j.f.a(["ContextParent","ContextParent","ShouldPreventShiftTabDefault"],[_mcp.a.l,_mcp.a.l,_mcp.a.K],null,"StopPropagation",null,_mcp.a.bP,1,null,null,!1));it.j("TAB");it.k=1;wt.a([st,p,k,b,g,it]);w.E([wt]);var ci=new _fce.h(_j.a.a(t,[2,0]),_j.b.Instance.a(_j.p),_j.b.Instance.a(_ff.a));var li=new _fce.f(t.children[2],_j.b.Instance.a(_j.p),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_j.j));var vi=new _j.i(t.children[1]);var ct=new _fce.h(t.children[0],_j.b.Instance.a(_j.p),_j.b.Instance.a(_ff.a));ct.a=0;ct.d("");return new _j.a(t,[ct,vi,li,ci,w,d,fi,ft,u,rr,ir,tt,o,or,et,lt,f,ai,di,nt,e,gi,c,gt,r,wi,bi,v,a,sr,y,pi,oi,si,ei,ui,ti,l,yi,vt,ni,ii,ri,er,s,ki,ur,i,ot,fr,dt,at,ut,ht,pt,bt,kt,hi]).l({ComposeViewContent:w,InfoBarControl:d,FromFieldControl:ft,ToRecipientButton:u,ToRecipientWellControl:o,CcRecipientWellControl:lt,CcRecipientButton:f,BccRecipientWellControl:gt,BccRecipientButton:r,SubjectTextBox:l,AttachmentWellViewWrapper:s,EditorControl:i,OnDemandUpgradeContainer:ot,QuotedBodyHtmlLabel:dt,MessageBox:ut,CancelConfirmDialog:ht})},"",_mcp.d,_mcp.i,function(n){return new _mcp.i(n,_j.b.Instance.a(_j.br),_j.b.Instance.a(_j.o),_j.b.Instance.a(_a.x),_j.b.Instance.a(_a.f),_j.b.Instance.a(_j.j),_j.b.Instance.a(_a.B),_j.b.Instance.a(_b.c))},!0,!1,!1,0,_mcp.a.a);var t="MailComposeCompactRecipientWellView._tid81";new _j.d(t,function(){_mcp.a.a[t]===undefined&&(_mcp.a.a[t]=[[[-1,4,null,null,null,"Text",null,_mcp.a.h,0,null,null,null,_u.n.PT]],[[-1,0,["RecipientComponent"],[_mcp.a.d],null,"DataContext",null,_mcp.a.g,1,null,null,null]]]);var i=_mcp.a.f.childNodes[36].cloneNode(!0);var n=new _rw.l(i.children[1]);n.d=0;n.c="calc(100% - 150px)";var r=new _fc.a(i.children[0]);return new _j.a(i,[r,n])},"",_mcp.d,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_mcp.a.a);var i="MailComposeCompactRecipientWellView._tid91";new _j.d(i,function(){_mcp.a.a[i]===undefined&&(_mcp.a.a[i]=[[[-1,0,["ImportanceComponent","IsNormalImportance"],[_mcp.a.cB,_mcp.a.ct],null,"IsHidden",null,_mcp.a.b,1,null,null,!0],[-1,0,["Context","Importance"],[_mcp.a.e,_mcp.a.cp],null,"Id",null,_mcp.a.r,1,_mcp.a.cj(),!1,null]],[[-1,4,null,null,null,"Id",null,_mcp.a.r,0,null,null,null,_mcp.e.b()],[-1,0,["ComplianceComponent","IsIrmProtected"],[_mcp.a.bB,_mcp.a.cr],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]],[[-1,4,null,null,null,"ImageId",null,_mcp.a.m,0,null,null,null,_mcp.e.k()],[-1,4,null,null,null,"HoveredImageId",null,_mcp.a.bl,0,null,null,null,_mcp.e.l()],[-1,4,null,null,null,"PressedImageId",null,_mcp.a.E,0,null,null,null,_mcp.e.m()],[-1,4,null,null,null,"AriaLabel",null,_mcp.a.j,0,null,null,null,_nbs.a.Bq],[-1,4,null,null,null,"Title",null,_mcp.a.p,0,null,null,null,_nbs.a.Bq],[-1,0,["ShouldShowExpandButton"],[_mcp.a.gI],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0],[-1,0,["NavigationComponent","UpconvertOnMoreOptionsCommand"],[_mcp.a.cE,_mcp.a.dX],null,"ClickCommand",null,_mcp.a.i,1,null,null,null]]]);var n=_mcp.a.f.childNodes[37].cloneNode(!0);var t=new _fc.b(n.children[2]);t.c("ms-font-color-black");t.B(-1);var u=new _fc.d(n.children[1],_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));var r=new _fc.d(n.children[0],_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));return new _j.a(n,[r,u,t])},"",_mcp.d,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_mcp.a.a);var e="MailComposeCompactRecipientWellView";new _j.d(e,function(){_mcp.a.a[e]===undefined&&(_mcp.a.a[e]=[null,[[-1,0,["ShouldApplyInlineCompose"],[_mcp.a.cH],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0],[-1,5,["IsFirefox"],[_mcp.a.s],null,"_mcp_B2",null,null,0,null,null,null]]]);var n=_mcp.a.f.childNodes[38].cloneNode(!0);var i=new _j.c(_j.a.a(n,[0,1]));i.y("MailComposeCompactRecipientWellView._tid91");var t=new _j.c(_j.a.a(n,[0,0]));t.y("MailComposeCompactRecipientWellView._tid81");return new _j.a(n,[t,i])},"",_mcp.d,_j.c,function(n){return new _j.c(n)},!1,!1,!1,0,_mcp.a.a);var c="MessageOptionsView._tidd1";new _j.d(c,function(){_mcp.a.a[c]===undefined&&(_mcp.a.a[c]=[[[-1,4,null,null,null,"Text",null,_mcp.a.k,0,null,null,null,_nbs.a.Nl],[-1,0,["SmimeEncryptMessage"],[_mcp.a.gK],_mcp.a.gO,"IsChecked",_mcp.a.F,_mcp.a.y,2,null,null,!1],[-1,0,["SmimeEncryptMessageIsEnabled"],[_mcp.a.gL],null,"IsEnabled",null,_mcp.a.V,1,null,null,!1]],[[-1,4,null,null,null,"Text",null,_mcp.a.k,0,null,null,null,_nbs.a.OT],[-1,0,["SmimeSignMessage"],[_mcp.a.gM],_mcp.a.gP,"IsChecked",_mcp.a.F,_mcp.a.y,2,null,null,!1],[-1,0,["SmimeSignMessageIsEnabled"],[_mcp.a.gN],null,"IsEnabled",null,_mcp.a.V,1,null,null,!1]]]);var n=_mcp.a.f.childNodes[40].cloneNode(!0);var i=new _fc.h(n.children[1],_j.b.Instance.a(_ff.a));var t=new _fc.h(n.children[0],_j.b.Instance.a(_ff.a));return new _j.a(n,[t,i])},"",_mcp.P,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_mcp.a.a);var l="MessageOptionsView.SensitivityTemplate";new _j.d(l,function(){_mcp.a.a[l]===undefined&&(_mcp.a.a[l]=[[[-1,1,["DataContext"],[_mcp.a.bs],null,"Text",null,_mcp.a.h,1,_mcp.a.cW(),null,null]]]);var n=_mcp.a.f.childNodes[0].cloneNode(!0);var t=new _fc.a(n.children[0]);return new _j.a(n,[t])},"",Object,_j.c,function(n){return new _j.c(n)},!1,!1,!1,0,_mcp.a.a);var a="MessageOptionsView";new _j.d(a,function(){_mcp.a.a[a]===undefined&&(_mcp.a.a[a]=[[[-1,4,null,null,null,"Text",null,_mcp.a.h,0,null,null,null,_nbs.a.Wb]],[[-1,0,["SensitivityOptions"],[_mcp.a.er],null,"Options",null,_mcp.a.dc,1,null,null,null],[-1,0,["Sensitivity"],[_mcp.a.eq],_mcp.a.ew,"SelectedValue",_mcp.a.db,_mcp.a.dd,2,null,null,null]],[[-1,4,null,null,null,"Text",null,_mcp.a.k,0,null,null,null,_nbs.a.Zi],[-1,0,["IsDeliveryReceiptRequested"],[_mcp.a.eo],_mcp.a.eu,"IsChecked",_mcp.a.F,_mcp.a.y,2,null,null,!1],[-1,0,["ShowDeliveryReceiptRequest"],[_mcp.a.es],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]],[[-1,4,null,null,null,"Text",null,_mcp.a.k,0,null,null,null,_nbs.a.dU],[-1,0,["IsReadReceiptRequested"],[_mcp.a.ep],_mcp.a.ev,"IsChecked",_mcp.a.F,_mcp.a.y,2,null,null,!1],[-1,0,["ShowReadReceiptRequest"],[_mcp.a.et],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]],[[-1,0,["ShowSmimeOptions"],[_mcp.a.gJ],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]]]);var n=_mcp.a.f.childNodes[41].cloneNode(!0);var i=new _j.c(n.children[4]);i.y("MessageOptionsView._tidd1");var u=new _fc.h(n.children[3],_j.b.Instance.a(_ff.a));var f=new _fc.h(n.children[2],_j.b.Instance.a(_ff.a));var t=new _fce.k(n.children[1]);t.a("MessageOptionsView.SensitivityTemplate");var r=new _fc.a(n.children[0]);return new _j.a(n,[r,t,f,u,i])},"",_mcp.P,_j.c,function(n){return new _j.c(n)},!1,!1,!1,0,_mcp.a.a);var o="OmeExpirationView._tide1";new _j.d(o,function(){_mcp.a.a[o]===undefined&&(_mcp.a.a[o]=[[[-1,4,null,null,null,"Title",null,_mcp.a.p,0,null,null,null,_nbs.a.aU],[-1,4,null,null,null,"Text",null,_mcp.a.k,0,null,null,null,_nbs.a.aU],[-1,4,null,null,null,"Data",null,_mcp.a.de,0,null,null,null,0]],[[-1,4,null,null,null,"Title",null,_mcp.a.p,0,null,null,null,_nbs.a.Kv],[-1,4,null,null,null,"Text",null,_mcp.a.k,0,null,null,null,_nbs.a.Kv],[-1,4,null,null,null,"Data",null,_mcp.a.de,0,null,null,null,1],[-1,0,["IsOmeTimeExpirationEnabled"],[_mcp.a.ex],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]],[[-1,5,["IsOmeTimeExpirationEnabled"],[_mcp.a.ex],null,"_mcp_a3",null,null,0,_mcp.a.c(),null,null]],[[-1,4,null,null,null,"TextSelectionType",null,_mcp.a.bQ,0,null,null,0,2],[-1,0,["FirstTextBox","MaxLength"],[_mcp.a.cc,_mcp.a.cL],null,"MaxLength",null,_mcp.a.bp,0,null,null,0],[-1,0,["FirstTextBox","TextInput"],[_mcp.a.cc,_mcp.a.cN],_mcp.a.cO,"Text",_mcp.a.bo,_mcp.a.br,2,null,null,null],[-1,0,["FirstTextBox","PlaceholderText"],[_mcp.a.cc,_mcp.a.cM],null,"Placeholder",null,_mcp.a.bq,0,null,null,null],[-1,0,["IsTimeExpirationSelected"],[_mcp.a.cP],_mcp.a.cQ,"IsEnabled",_mcp.a.ck,_mcp.a.cl,2,null,null,!1],[-1,5,["FirstTextBox","IsYear"],[_mcp.a.cc,_mcp.a.cK],null,"_mcp_83",null,null,0,null,null,null]],[[-1,4,null,null,null,"TextSelectionType",null,_mcp.a.bQ,0,null,null,0,2],[-1,0,["SecondTextBox","MaxLength"],[_mcp.a.cd,_mcp.a.cL],null,"MaxLength",null,_mcp.a.bp,0,null,null,0],[-1,0,["SecondTextBox","PlaceholderText"],[_mcp.a.cd,_mcp.a.cM],null,"Placeholder",null,_mcp.a.bq,0,null,null,null],[-1,0,["SecondTextBox","TextInput"],[_mcp.a.cd,_mcp.a.cN],_mcp.a.cO,"Text",_mcp.a.bo,_mcp.a.br,2,null,null,null],[-1,0,["IsTimeExpirationSelected"],[_mcp.a.cP],_mcp.a.cQ,"IsEnabled",_mcp.a.ck,_mcp.a.cl,2,null,null,!1],[-1,5,["SecondTextBox","IsYear"],[_mcp.a.cd,_mcp.a.cK],null,"_mcp_83",null,null,0,null,null,null]],[[-1,4,null,null,null,"TextSelectionType",null,_mcp.a.bQ,0,null,null,0,2],[-1,0,["ThirdTextBox","MaxLength"],[_mcp.a.ce,_mcp.a.cL],null,"MaxLength",null,_mcp.a.bp,0,null,null,0],[-1,0,["ThirdTextBox","PlaceholderText"],[_mcp.a.ce,_mcp.a.cM],null,"Placeholder",null,_mcp.a.bq,0,null,null,null],[-1,0,["ThirdTextBox","TextInput"],[_mcp.a.ce,_mcp.a.cN],_mcp.a.cO,"Text",_mcp.a.bo,_mcp.a.br,2,null,null,null],[-1,0,["IsTimeExpirationSelected"],[_mcp.a.cP],_mcp.a.cQ,"IsEnabled",_mcp.a.ck,_mcp.a.cl,2,null,null,!1],[-1,5,["ThirdTextBox","IsYear"],[_mcp.a.ce,_mcp.a.cK],null,"_mcp_83",null,null,0,null,null,null]]]);var n=_mcp.a.f.childNodes[43].cloneNode(!0);var u=new _fc.i(_j.a.a(n,[1,1,2]));var f=new _fc.i(_j.a.a(n,[1,1,1]));var e=new _fc.i(_j.a.a(n,[1,1,0]));var t=new _j.i(_j.a.a(n,[1,1]));var i=new _fce.j(_j.a.a(n,[1,0]));var r=new _fce.j(_j.a.a(n,[0,0]));return new _j.a(n,[r,i,t,e,f,u])},"",_mcp.ba,_fce.i,function(n){return new _fce.i(n)},!1,!0,!1,0,_mcp.a.a);var s="OmeExpirationView";new _j.d(s,function(){_mcp.a.a[s]===undefined&&(_mcp.a.a[s]=[[[-1,4,null,null,null,"Text",null,_mcp.a.h,0,null,null,null,_nbs.a.ra]],[[-1,0,["SelectedOption"],[_mcp.a.gR],_mcp.a.gS,"SelectedOptionData",_mcp.a.eK,_mcp.a.eL,2,null,null,null]],[[-1,0,["ErrorText"],[_mcp.a.gQ],null,"Text",null,_mcp.a.h,1,null,null,null]]]);var n=_mcp.a.f.childNodes[44].cloneNode(!0);var i=new _fc.a(n.children[2]);i.K(!1);var t=new _fce.i(n.children[1]);t.y("OmeExpirationView._tide1");var r=new _fc.a(n.children[0]);return new _j.a(n,[r,t,i])},"",_mcp.ba,_j.c,function(n){return new _j.c(n)},!1,!1,!1,0,_mcp.a.a);var h="SendAvailabilityPopupView";new _j.d(h,function(){_mcp.a.a[h]===undefined&&(_mcp.a.a[h]=[[[-1,4,null,null,null,"ImageId",null,_mcp.a.m,0,null,null,null,_mcp.e.A()],[-1,0,["CancelCommand"],[_mcp.a.ey],null,"ClickCommand",null,_mcp.a.i,1,null,null,null]],[[-1,4,null,null,null,"Text",null,_mcp.a.h,0,null,null,null,_nbs.a.Bz]],[[-1,0,["ConsensusSchedulingViewModel"],[_mcp.a.gT],null,"DataContext",null,_mcp.a.g,1,null,null,null]],[[-1,4,null,null,null,"Text",null,_mcp.a.k,0,null,null,null,_nbs.a.nC],[-1,0,["SubmitCommand"],[_mcp.a.gU],null,"ClickCommand",null,_mcp.a.i,1,null,null,null]],[[-1,4,null,null,null,"Text",null,_mcp.a.k,0,null,null,null,_nbs.a.SP],[-1,0,["CancelCommand"],[_mcp.a.ey],null,"ClickCommand",null,_mcp.a.i,1,null,null,null]]]);var n=_mcp.a.f.childNodes[45].cloneNode(!0);var r=new _fc.b(_j.a.a(n,[2,1]));r.d(1);var i=new _fc.b(_j.a.a(n,[2,0]));i.d(4);var t=new _j.c(_j.a.a(n,[1,0]));t.y("ConsensusSchedulingView.Wrapper");t.L(!0);var f=new _fc.a(_j.a.a(n,[0,1]));var u=new _fc.b(_j.a.a(n,[0,0]));return new _j.a(n,[u,f,t,i,r])},"",_mcp.bp,_j.c,function(n){return new _j.c(n)},!0,!1,!1,0,_mcp.a.a)};_mcp.M.registerClass("_mcp.M",_db.e);_mcp.bs.registerClass("_mcp.bs",_h.fa);_mcp.S.registerClass("_mcp.S",_a.da);_mcp.bd.registerClass("_mcp.bd",_h.cQ.$$(_gg.oM,_gg.oO));MailComposeComponent.registerClass("MailComposeComponent",null,_a.ii,_j.cd);_mcp.T.registerClass("_mcp.T");_mcp.U.registerClass("_mcp.U");_mcp.x.registerClass("_mcp.x",_a.fM);_mcp.bw.registerClass("_mcp.bw");_mcp.bv.registerClass("_mcp.bv",_h.fa);_mcp.bx.registerClass("_mcp.bx",null,_h.bV,_h.em);_mcp.w.registerClass("_mcp.w",_h.cQ.$$(_gg.pq,_g.dx));_mcp.bt.registerClass("_mcp.bt",_h.fa);_mcp.bu.registerClass("_mcp.bu",_h.fa,_a.ft);_mcp.N.registerClass("_mcp.N",_y.ih);_mcp.G.registerClass("_mcp.G",null,IMailComposeActionFactory);_mcp.bi.registerClass("_mcp.bi",null,IMailComposeContextFactory);_mcp.bl.registerClass("_mcp.bl",null,IMailComposeViewModelFactory,_bc.Y);_mcp.bm.registerClass("_mcp.bm",_mcp.bl,IMailInlineComposeViewModelFactory,IMailComposeViewModelFactory,_bc.Y);_mcp.bh.registerClass("_mcp.bh",_a.bs);_mcp.Y.registerClass("_mcp.Y",_j.Q,_y.ia);_mcp.b.registerClass("_mcp.b",_a.fM,_g.kC,_y.cV,_bc.bF,IContext,_j.bq,Sys.IDisposable,_dg.ICalendarTimePeriod);_mcp.H.registerClass("_mcp.H",null,IMailComposeControllerExecutor,_y.gW);_mcp.C.registerClass("_mcp.C",null,IMailComposeDiscardManager);_mcp.c.registerClass("_mcp.c",_a.dQ);_mcp.bW.registerClass("_mcp.bW");_mcp.d.registerClass("_mcp.d",_y.iD,_y.i,_y.A,_bc.s,_a.iU,_j.bq,Sys.IDisposable,_y.dQ,_y.cR,_bc.i,_bc.o,_y.J,IMailComposeOverridable);_mcp.bk.registerClass("_mcp.bk",_mcp.d);_mcp.D.registerClass("_mcp.D",_mcp.d);_mcp.j.registerClass("_mcp.j");_mcp.bn.registerClass("_mcp.bn",_a.bs,_y.ib);_mcp.bo.registerClass("_mcp.bo",null,IMailResponseViewModelFactory);_mcp.P.registerClass("_mcp.P",_a.bs);_mcp.ba.registerClass("_mcp.ba",_a.bs);_mcp.Z.registerClass("_mcp.Z");_mcp.bb.registerClass("_mcp.bb");_mcp.bY.registerClass("_mcp.bY");_mcp.bp.registerClass("_mcp.bp",_a.bs,_bc.i,_bc.o,_bc.s,_a.iU,_j.bq,Sys.IDisposable);_mcp.I.registerClass("_mcp.I",_j.Q,IMailComposeComponent,_j.bq,Sys.IDisposable);_mcp.q.registerClass("_mcp.q",_mcp.I,IMailComposeContextMenuProvider);_mcp.by.registerClass("_mcp.by",_mcp.q,IMailComposeAccCheckerComponent,_y.iE);_mcp.bz.registerClass("_mcp.bz",_mcp.I,_mcp.ce,IMailComposeComponent,_j.bq,Sys.IDisposable,_y.gV);_mcp.m.registerClass("_mcp.m",_mcp.I,IMailComposeAttachmentComponent,IMailComposeComponent,_j.bq,Sys.IDisposable,_y.hf,IMailComposeOverridable);_mcp.z.registerClass("_mcp.z",_mcp.q,IMailComposeSaveComponent,IMailComposeComponent,_j.bq,Sys.IDisposable,IMailComposeContextMenuProvider,IMailComposeOverridable);_mcp.V.registerClass("_mcp.V",_mcp.z,IMailComposeAutoSaveComponent,IMailComposeComponent,_j.bq,Sys.IDisposable);_mcp.y.registerClass("_mcp.y",_mcp.I,IMailComposeCommandingBarComponent,IMailComposeComponent,_j.bq,Sys.IDisposable);_mcp.E.registerClass("_mcp.E",_mcp.q,IMailComposeComplianceComponent,IMailComposeComponent,_j.bq,Sys.IDisposable,IMailComposeContextMenuProvider);_mcp.bB.registerClass("_mcp.bB",null,Sys.IDisposable);_mcp.bC.registerClass("_mcp.bC",_mcp.q,IMailComposeContentConversionComponent,IMailComposeComponent,_j.bq,Sys.IDisposable,IMailComposeContextMenuProvider);_mcp.J.registerClass("_mcp.J",_mcp.I,IMailComposeContextMenuComponent,IMailComposeComponent,_j.bq,Sys.IDisposable);_mcp.bD.registerClass("_mcp.bD",_mcp.J,IMailComposeContextMenuComponent,IMailComposeComponent,_j.bq,Sys.IDisposable);_mcp.u.registerClass("_mcp.u",_mcp.I,IMailComposeDecisionCollabComponent,IMailComposeComponent,_j.bq,Sys.IDisposable,_cmc.bU);_mcp.s.registerClass("_mcp.s",_mcp.I,IMailComposeSendComponent,IMailComposeOverridable);_mcp.K.registerClass("_mcp.K",_mcp.s);_mcp.p.registerClass("_mcp.p",_mcp.I,IMailComposeDiscardComponent,IMailComposeComponent,_j.bq,Sys.IDisposable);_mcp.bE.registerClass("_mcp.bE",_mcp.I,IMailComposeEditorComponent,IMailComposeComponent,_j.bq,Sys.IDisposable);_mcp.bF.registerClass("_mcp.bF",_mcp.bE);_mcp.bG.registerClass("_mcp.bG",_mcp.I,_mcp.cf,IMailComposeComponent,_j.bq,Sys.IDisposable);_mcp.bI.registerClass("_mcp.bI",_mcp.q,IMailComposeImportanceComponent,IMailComposeComponent,_j.bq,Sys.IDisposable,IMailComposeContextMenuProvider);_mcp.v.registerClass("_mcp.v",_mcp.I,IMailComposeLinkPreviewComponent,IMailComposeComponent,_j.bq,Sys.IDisposable);_mcp.W.registerClass("_mcp.W",_mcp.I,IMailComposeCalendaringInfobarComponent,IMailComposeComponent,_j.bq,Sys.IDisposable);_mcp.L.registerClass("_mcp.L",_mcp.I,IMailComposeInitializerComponent,IMailComposeComponent,_j.bq,Sys.IDisposable);_mcp.g.registerClass("_mcp.g",_mcp.I,IMailComposeMeetingComponent,IMailComposeComponent,_j.bq,Sys.IDisposable);_mcp.bK.registerClass("_mcp.bK",_mcp.q,IMailComposeMessageOptionsComponent,IMailComposeComponent,_j.bq,Sys.IDisposable,IMailComposeContextMenuProvider);_mcp.t.registerClass("_mcp.t",_mcp.q,IMailComposeNavigationComponent);_mcp.bL.registerClass("_mcp.bL",_mcp.q,IMailComposeOmeComponent,IMailComposeComponent,_j.bq,Sys.IDisposable,IMailComposeContextMenuProvider);_mcp.bM.registerClass("_mcp.bM",_mcp.I,IMailComposePALGenericAttachmentComponent,IMailComposeComponent,_j.bq,Sys.IDisposable);_mcp.bO.registerClass("_mcp.bO",_mcp.I,IMailComposePhotoComponent,IMailComposeComponent,_j.bq,Sys.IDisposable);_mcp.f.registerClass("_mcp.f",_mcp.q,_y.iI,IMailComposeRecipientComponent,IMailComposeComponent,_j.bq,Sys.IDisposable,_rw.r);_mcp.F.registerClass("_mcp.F",_mcp.I,IMailComposeRecipientSummarizationComponent,IMailComposeComponent,_j.bq,Sys.IDisposable);_mcp.B.registerClass("_mcp.B",_j.Q);_mcp.r.registerClass("_mcp.r",_mcp.I,IMailComposeSendAsContextMenuComponent,IMailComposeComponent,_j.bq,Sys.IDisposable);_mcp.h.registerClass("_mcp.h",_mcp.I,_mcp.cg,IMailComposeComponent,_j.bq,Sys.IDisposable);_mcp.bQ.registerClass("_mcp.bQ",_mcp.I,IMailComposeShareAttachmentComponent,IMailComposeComponent,_j.bq,Sys.IDisposable);_mcp.o.registerClass("_mcp.o",_mcp.q,IMailComposeSignatureComponent,IMailComposeComponent,_j.bq,Sys.IDisposable,IMailComposeContextMenuProvider);_mcp.bR.registerClass("_mcp.bR",_mcp.I,IMailComposeTouchComponent,IMailComposeComponent,_j.bq,Sys.IDisposable);_mcp.O.registerClass("_mcp.O",_mcp.I,IMailComposeUpgradeComponent,IMailComposeComponent,_j.bq,Sys.IDisposable);_mcp.bJ.registerClass("_mcp.bJ",_mcp.I,IMailComposeMailTipsComponent,IMailComposeComponent,_j.bq,Sys.IDisposable);_mcp.bN.registerClass("_mcp.bN",_mcp.I,IMailComposePeopleRecommendationsComponent,IMailComposeComponent,_j.bq,Sys.IDisposable);_mcp.bP.registerClass("_mcp.bP",_mcp.I,IMailComposePolicyTipsComponent,IMailComposeComponent,_j.bq,Sys.IDisposable);_mcp.A.registerClass("_mcp.A",_mcp.I,_y.hL,_y.hK,_y.hI,IMailComposeExtensibilityComponent,IMailComposeComponent,_j.bq,Sys.IDisposable);_mcp.bH.registerClass("_mcp.bH",_mcp.I,IMailComposeHashtagComponent,IMailComposeComponent,_j.bq,Sys.IDisposable,_y.gS);_mcp.bS.registerClass("_mcp.bS",_mcp.I,IMailComposeExtensibilityComponent,IMailComposeComponent,_j.bq,Sys.IDisposable);_mcp.bA.registerClass("_mcp.bA");_mcp.bT.registerClass("_mcp.bT",null,_j.bO);_mcp.k.registerClass("_mcp.k",_j.i,_b.bD);_mcp.i.registerClass("_mcp.i",_j.c,_ff.k,_y.gP,_cmc.bT);_mcp.ch.registerClass("_mcp.ch",_mcp.i);_mcp.l.registerClass("_mcp.l",_j.c);_mcp.R.registerClass("_mcp.R",_j.c,_ff.k,_y.gP,_cmc.bT);_mcp.bc.registerClass("_mcp.bc",_j.c);_mcp.n.registerClass("_mcp.n",_mcp.ch);MailComposeComponent.$$cctor();_mcp.b.bV=new _a.e("ViewModelId",String,_mcp.b);_mcp.b.c=new _a.e("Operation",_y.m,_mcp.b);_mcp.b.l=new _a.e("Mode",_y.eb,_mcp.b);_mcp.b.br=new _a.e("OriginalId",_g.e,_mcp.b);_mcp.b.bq=new _a.e("OriginalDocumentId",Number,_mcp.b);_mcp.b.bs=new _a.e("OriginalItem",_g.g,_mcp.b);_mcp.b.H=new _a.e("DraftId",_g.e,_mcp.b);_mcp.b.bP=new _a.e("StoreId",String,_mcp.b);_mcp.b.bQ=new _a.e("Subject",String,_mcp.b,"");_mcp.b.bD=new _a.e("SelectedDataCallContext",_h.cV,_mcp.b);_mcp.b.J=new _a.e("EditorCallContext",_h.cV,_mcp.b);_mcp.b.K=new _a.e("EditorContent",String,_mcp.b,"");_mcp.b.t=new _a.e("BodyType",String,_mcp.b);_mcp.b.o=new _a.e("ToRecipients",_j.O,_mcp.b);_mcp.b.n=new _a.e("SpeechResultRecipients",_j.O,_mcp.b);_mcp.b.bR=new _a.e("ToQueryString",String,_mcp.b);_mcp.b.i=new _a.e("CcRecipients",_j.O,_mcp.b);_mcp.b.v=new _a.e("CcQueryString",String,_mcp.b);_mcp.b.h=new _a.e("BccRecipients",_j.O,_mcp.b);_mcp.b.s=new _a.e("BccQueryString",String,_mcp.b);_mcp.b.m=new _a.e("AutoAddSignature",Boolean,_mcp.b,!0);_mcp.b.U=new _a.e("Importance",String,_mcp.b,"Normal");_mcp.b.bz=new _a.e("QuotedBody",String,_mcp.b);_mcp.b.bI=new _a.e("SmimeContent",String,_mcp.b);_mcp.b.bK=new _a.e("SmimeErrorCode",Number,_mcp.b);_mcp.b.bL=new _a.e("SmimeRecipientCerts",Array,_mcp.b);_mcp.b.bM=new _a.e("SmimeSigningCert",String,_mcp.b);_mcp.b.p=new _a.e("AttachmentsToAdd",Array,_mcp.b);_mcp.b.ba=new _a.e("IsComplete",Boolean,_mcp.b);_mcp.b.k=new _a.e("IsMeeting",Boolean,_mcp.b);_mcp.b.be=new _a.e("IsMeetingForward",Boolean,_mcp.b);_mcp.b.bl=new _a.e("IsReplyAllOnBcc",Boolean,_mcp.b);_mcp.b.bp=new _a.e("Location",_dg.c,_mcp.b);_mcp.b.R=new _a.e("HasLocation",Boolean,_mcp.b);_mcp.b.W=new _a.e("InternetMessageId",String,_mcp.b);_mcp.b.bA=new _a.e("Recurrence",_dg.v,_mcp.b);_mcp.b.bk=new _a.e("IsRecurringMaster",Boolean,_mcp.b);_mcp.b.bO=new _a.e("Start",_a.d,_mcp.b);_mcp.b.L=new _a.e("End",_a.d,_mcp.b);_mcp.b.cf=new _a.e("IsAllDayEventProperty",Boolean,_mcp.b);_mcp.b.N=new _a.e("From",_g.N,_mcp.b);_mcp.b.bE=new _a.e("Sender",_g.N,_mcp.b);_mcp.b.bo=new _a.e("IsUpgraded",Boolean,_mcp.b);_mcp.b.bc=new _a.e("IsFromShown",Boolean,_mcp.b);_mcp.b.Y=new _a.e("IsCcShown",Boolean,_mcp.b);_mcp.b.X=new _a.e("IsBccShown",Boolean,_mcp.b);_mcp.b.bv=new _a.e("ParentFolderNameToPost",String,_mcp.b);_mcp.b.bu=new _a.e("ParentFolderIdToPost",_g.l,_mcp.b);_mcp.b.f=new _a.e("AttachmentCollection",_j.l,_mcp.b);_mcp.b.g=new _a.e("AttachmentProviderFiles",_j.l,_mcp.b);_mcp.b.q=new _a.e("AttachmentsToHide",Array,_mcp.b);_mcp.b.G=new _a.e("DocLinks",_a.k,_mcp.b);_mcp.b.bU=new _a.e("UpgradeFailed",Boolean,_mcp.b);_mcp.b.r=new _a.e("Baseline",_mcp.c,_mcp.b);_mcp.b.Q=new _a.e("HasBeenSavedByUser",Boolean,_mcp.b);_mcp.b.P=new _a.e("HasBeenAutoSaved",Boolean,_mcp.b);_mcp.b.bS=new _a.e("UnpromotedEmojiCountProperty",Number,_mcp.b);_mcp.b.bT=new _a.e("UnpromotedInlineImageCountProperty",Number,_mcp.b);_mcp.b.bm=new _a.e("IsReplyForward",Boolean,_mcp.b);_mcp.b.I=new _a.e("Draft",_g.g,_mcp.b);_mcp.b.O=new _a.e("GroupEmailAddress",_g.f,_mcp.b);_mcp.b.bC=new _a.e("RightsManagementLicenseData",_g.cJ,_mcp.b);_mcp.b.A=new _a.e("ComplianceId",String,_mcp.b);_mcp.b.Z=new _a.e("IsClassified",Boolean,_mcp.b);_mcp.b.x=new _a.e("ClassificationGuid",String,_mcp.b);_mcp.b.z=new _a.e("Classification",String,_mcp.b);_mcp.b.w=new _a.e("ClassificationDescription",String,_mcp.b);_mcp.b.y=new _a.e("ClassificationKeep",Boolean,_mcp.b);_mcp.b.bG=new _a.e("Sensitivity",String,_mcp.b,"Normal");_mcp.b.bb=new _a.e("IsDeliveryReceiptRequested",Boolean,_mcp.b);_mcp.b.bj=new _a.e("IsReadReceiptRequested",Boolean,_mcp.b);_mcp.b.bJ=new _a.e("SmimeEncryptMessage",Boolean,_mcp.b);_mcp.b.bN=new _a.e("SmimeSignMessage",Boolean,_mcp.b);_mcp.b.B=new _a.e("ConversationId",_g.e,_mcp.b);_mcp.b.bt=new _a.e("ParentConversationNodeId",String,_mcp.b);_mcp.b.u=new _a.e("CalendarItemModelType",_h.dv,_mcp.b);_mcp.b.bg=new _a.e("IsOccurrenceReferencingMaster",Boolean,_mcp.b);_mcp.b.bi=new _a.e("IsPoppedOutFromReadingPane",Boolean,_mcp.b);_mcp.b.bd=new _a.e("IsLoadedDraft",Boolean,_mcp.b);_mcp.b.bW=new _a.e("WasCleanNewMessageBeforePopout",Boolean,_mcp.b);_mcp.b.T=new _a.e("HideIncludeEntrypoint",Boolean,_mcp.b,!1);_mcp.b.bX=new _a.e("WasSavingBeforePopout",Boolean,_mcp.b,!1);_mcp.b.bf=new _a.e("IsMovedToDraftFromOutbox",Boolean,_mcp.b,!1);_mcp.b.bx=new _a.e("PerfContext",_a.bI,_mcp.b,null);_mcp.b.bw=new _a.e("PerfContextE2E",_a.bI,_mcp.b,null);_mcp.b.bY=new _a.e("WaterfallTraceStarted",Boolean,_mcp.b,null);_mcp.b.bB=new _a.e("RichTextEditorSupported",Boolean,_mcp.b,null);_mcp.b.F=new _a.e("DlpSenderOverride",String,_mcp.b,null);_mcp.b.E=new _a.e("DlpFalsePositive",String,_mcp.b,null);_mcp.b.D=new _a.e("DlpDetectedClassification",String,_mcp.b,null);_mcp.b.M=new _a.e("ExplicitLogonUser",String,_mcp.b,null);_mcp.b.V=new _a.e("IncludeOriginalFromInToRecipients",Boolean,_mcp.b,!1);_mcp.b.j=new _a.e("ExtendedPropertyCollection",_j.l,_mcp.b,null);_mcp.b.bh=new _a.e("IsOnDemandUpgradeRequested",Boolean,_mcp.b,!1);_mcp.b.bn=new _a.e("IsResumingSendFailure",Boolean,_mcp.b,!1);_mcp.b.S=new _a.e("HasSentViaNotification",Boolean,_mcp.b,!1);_mcp.b.bF=new _a.e("SendFailureInfobarMessageId",_bc.C,_mcp.b,45);_mcp.b.bH=new _a.e("SentFromMailComposeInlineReply",Boolean,_mcp.b);_mcp.b.by=new _a.e("PopoutPerfContext",_a.bI,_mcp.b);_mcp.b.C=new _a.e("DiagnosticContent",String,_mcp.b);_mcp.b.e="UseOverride";_mcp.b.cc=new RegExp("(\r)?\n","gi");_mcp.b.b=null;_mcp.b.d=null;_mcp.b.$$cctor();_mcp.c.u=new _a.e("Subject",String,_mcp.c,"");_mcp.c.m=new _a.e("EditorContent",String,_mcp.c,"");_mcp.c.h=new _a.e("ToRecipients",_j.l,_mcp.c);_mcp.c.v=new _a.e("ToQueryString",String,_mcp.c);_mcp.c.e=new _a.e("CcRecipients",_j.l,_mcp.c);_mcp.c.k=new _a.e("CcQueryString",String,_mcp.c);_mcp.c.d=new _a.e("BccRecipients",_j.l,_mcp.c);_mcp.c.j=new _a.e("BccQueryString",String,_mcp.c);_mcp.c.o=new _a.e("Importance",String,_mcp.c,"Normal");_mcp.c.n=new _a.e("From",_g.f,_mcp.c);_mcp.c.l=new _a.e("ComplianceId",String,_mcp.c);_mcp.c.r=new _a.e("Sensitivity",String,_mcp.c,"Normal");_mcp.c.p=new _a.e("IsDeliveryReceiptRequested",Boolean,_mcp.c);_mcp.c.q=new _a.e("IsReadReceiptRequested",Boolean,_mcp.c);_mcp.c.s=new _a.e("SmimeEncryptMessage",Boolean,_mcp.c);_mcp.c.t=new _a.e("SmimeSignMessage",Boolean,_mcp.c);_mcp.c.c=new _a.e("AttachmentCollection",_j.l,_mcp.c);_mcp.c.g=new _a.e("ExtendedPropertyCollection",_j.l,_mcp.c,null);_mcp.c.f=new _a.bx(_g.f);_mcp.c.$$cctor();_mcp.d.b=null;_mcp.j.a=_a.a.a;_mcp.bn.a=_a.a.a;_mcp.m.a=new _a.e("AttachmentWellViewModel",_y.bk,_mcp.m);_mcp.V.a=new _a.D("Auto");_mcp.y.a=_a.a.eQ;_mcp.E.a=new _y.h(_u.P.g,null,null);_mcp.J.a=new _a.e("Menu",_fm.f,_mcp.J);_mcp.u.b=[980];_mcp.W.a=[6800,3200,3205,3210,3215,3220,3100,3105,3110,3115,3120,3250,3255,3260];_mcp.g.c=new _a.e("FromDetailsViewModel",_bc.n,_mcp.g);_mcp.g.d=new _a.e("SenderDetailsViewModel",_bc.n,_mcp.g);_mcp.g.b=null;_mcp.g.a=null;_mcp.t.b=[84,85,86,87];_mcp.B.b=7;_mcp.B.a=1;_mcp.z.a=new _a.D("Group");_mcp.z.b=[60,40,43,1001,700,50,800,88,89];_mcp.r.b=10;_mcp.r.c=new _a.e("Menu",_fm.f,_mcp.r);_mcp.h.c="";_mcp.h.e=new RegExp("^[a-zA-Z]+");_mcp.h.b=null;_mcp.s.a=[62,45,46,47,700,55,70,65,97,66,75,800,88,80,48,89,90,91,92,101,93,94,98,99,100];_mcp.o.f="<P><BR></P>";_mcp.o.e=new RegExp("[\n\r]+","g");_mcp.o.c=new RegExp("(<img )([^>]*src=[\"']?data:image/[^<]+;base64,[a-zA-Z0-9+/=&#;]+[\"']?)([^>]*>)","gi");_mcp.o.b=new RegExp("(<[aA] [^>]*>)","gi");_mcp.o.d="EmojiInsert";_mcp.X.a=new _mcp.X(!0,!1);_mcp.a.f=_mcp.a.eI();_mcp.a.bI=null;_mcp.a.bE=null;_mcp.a.bL=null;_mcp.a.bJ=null;_mcp.a.bK=null;_mcp.a.bH=null;_mcp.a.bF=null;_mcp.a.bG=null;_mcp.a.bM=null;_mcp.a.a={};_mcp.a.$$cctor();
window.scriptsLoaded['microsoft.owa.mail.compose.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.mail.compose.js'] = (new Date()).getTime(); } catch(e) { window.owaLastErrorReported = e; throw e; }
